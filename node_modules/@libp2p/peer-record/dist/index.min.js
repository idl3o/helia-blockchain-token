(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var jr=Object.defineProperty;var ta=Object.getOwnPropertyDescriptor;var ea=Object.getOwnPropertyNames;var ra=Object.prototype.hasOwnProperty;var bt=(r,t)=>{for(var e in t)jr(r,e,{get:t[e],enumerable:!0})},na=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ea(t))!ra.call(r,o)&&o!==e&&jr(r,o,{get:()=>t[o],enumerable:!(n=ta(t,o))||n.enumerable});return r};var oa=r=>na(jr({},"__esModule",{value:!0}),r);var Xu={};bt(Xu,{PeerRecord:()=>Gr,RecordEnvelope:()=>Kr});var Zr=Symbol.for("@libp2p/peer-id");var nt=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},xe=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var cr=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var we=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Jr={};bt(Jr,{base58btc:()=>Y,base58flickr:()=>la});var ef=new Uint8Array(0);function Vo(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function Nt(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function zo(r){return new TextEncoder().encode(r)}function Fo(r){return new TextDecoder().decode(r)}function sa(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var o=0;o<r.length;o++){var s=r.charAt(o),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=o}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var y=0,D=0,K=0,z=S.length;K!==z&&S[K]===0;)K++,y++;for(var A=(z-K)*u+1>>>0,f=new Uint8Array(A);K!==z;){for(var m=S[K],I=0,B=A-1;(m!==0||I<D)&&B!==-1;B--,I++)m+=256*f[B]>>>0,f[B]=m%a>>>0,m=m/a>>>0;if(m!==0)throw new Error("Non-zero carry");D=I,K++}for(var T=A-D;T!==A&&f[T]===0;)T++;for(var U=c.repeat(y);T<A;++T)U+=r.charAt(f[T]);return U}function b(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var y=0;if(S[y]!==" "){for(var D=0,K=0;S[y]===c;)D++,y++;for(var z=(S.length-y)*l+1>>>0,A=new Uint8Array(z);S[y];){var f=e[S.charCodeAt(y)];if(f===255)return;for(var m=0,I=z-1;(f!==0||m<K)&&I!==-1;I--,m++)f+=a*A[I]>>>0,A[I]=f%256>>>0,f=f/256>>>0;if(f!==0)throw new Error("Non-zero carry");K=m,y++}if(S[y]!==" "){for(var B=z-K;B!==z&&A[B]===0;)B++;for(var T=new Uint8Array(D+(z-B)),U=D;B!==z;)T[U++]=A[B++];return T}}}function v(S){var y=b(S);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:b,decode:v}}var ia=sa,aa=ia,jo=aa;var Yr=class{name;prefix;baseEncode;constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},$r=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,n){this.name=t,this.prefix=e;let o=e.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Zo(this,t)}},Wr=class{decoders;constructor(t){this.decoders=t}or(t){return Zo(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Zo(r,t){return new Wr({...r.decoders??{[r.prefix]:r},...t.decoders??{[t.prefix]:t}})}var Xr=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,n,o){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=o,this.encoder=new Yr(t,e,n),this.decoder=new $r(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function Ee({name:r,prefix:t,encode:e,decode:n}){return new Xr(r,t,e,n)}function Wt({name:r,prefix:t,alphabet:e}){let{encode:n,decode:o}=jo(e,r);return Ee({prefix:t,name:r,encode:n,decode:s=>Nt(o(s))})}function ca(r,t,e,n){let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*e/8|0),i=0,a=0,c=0;for(let l=0;l<o;++l){let u=t[r[l]];if(u===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<e|u,i+=e,i>=8&&(i-=8,s[c++]=255&a>>i)}if(i>=e||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function ua(r,t,e){let n=t[t.length-1]==="=",o=(1<<e)-1,s="",i=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],i+=8;i>e;)i-=e,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<e-i]),n)for(;(s.length*e&7)!==0;)s+="=";return s}function fa(r){let t={};for(let e=0;e<r.length;++e)t[r[e]]=e;return t}function X({name:r,prefix:t,bitsPerChar:e,alphabet:n}){let o=fa(n);return Ee({prefix:t,name:r,encode(s){return ua(s,n,e)},decode(s){return ca(s,o,e,r)}})}var Y=Wt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),la=Wt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Qr={};bt(Qr,{base32:()=>kt,base32hex:()=>ma,base32hexpad:()=>ga,base32hexpadupper:()=>ba,base32hexupper:()=>ya,base32pad:()=>da,base32padupper:()=>pa,base32upper:()=>ha,base32z:()=>xa});var kt=X({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ha=X({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),da=X({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),pa=X({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ma=X({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ya=X({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ga=X({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ba=X({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xa=X({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var tn={};bt(tn,{base36:()=>Oe,base36upper:()=>wa});var Oe=Wt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),wa=Wt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ea=Wo,Yo=128,Aa=127,Sa=~Aa,va=Math.pow(2,31);function Wo(r,t,e){t=t||[],e=e||0;for(var n=e;r>=va;)t[e++]=r&255|Yo,r/=128;for(;r&Sa;)t[e++]=r&255|Yo,r>>>=7;return t[e]=r|0,Wo.bytes=e-n+1,t}var Ia=en,Ba=128,$o=127;function en(r,n){var e=0,n=n||0,o=0,s=n,i,a=r.length;do{if(s>=a)throw en.bytes=0,new RangeError("Could not decode varint");i=r[s++],e+=o<28?(i&$o)<<o:(i&$o)*Math.pow(2,o),o+=7}while(i>=Ba);return en.bytes=s-n,e}var Ta=Math.pow(2,7),Pa=Math.pow(2,14),La=Math.pow(2,21),Ca=Math.pow(2,28),_a=Math.pow(2,35),Ua=Math.pow(2,42),Da=Math.pow(2,49),Ka=Math.pow(2,56),Ra=Math.pow(2,63),Na=function(r){return r<Ta?1:r<Pa?2:r<La?3:r<Ca?4:r<_a?5:r<Ua?6:r<Da?7:r<Ka?8:r<Ra?9:10},ka={encode:Ea,decode:Ia,encodingLength:Na},Oa=ka,Me=Oa;function qe(r,t=0){return[Me.decode(r,t),Me.decode.bytes]}function Ae(r,t,e=0){return Me.encode(r,t,e),t}function Se(r){return Me.encodingLength(r)}function Tt(r,t){let e=t.byteLength,n=Se(r),o=n+Se(e),s=new Uint8Array(o+e);return Ae(r,s,0),Ae(e,s,n),s.set(t,o),new ve(r,e,t,s)}function ae(r){let t=Nt(r),[e,n]=qe(t),[o,s]=qe(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new ve(e,o,i,t)}function Xo(r,t){if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&Vo(r.bytes,e.bytes)}}var ve=class{code;size;digest;bytes;constructor(t,e,n,o){this.code=t,this.size=e,this.digest=n,this.bytes=o}};function Jo(r,t){let{bytes:e,version:n}=r;switch(n){case 0:return qa(e,rn(r),t??Y.encoder);default:return Ha(e,rn(r),t??kt.encoder)}}var Qo=new WeakMap;function rn(r){let t=Qo.get(r);if(t==null){let e=new Map;return Qo.set(r,e),e}return t}var rt=class r{code;version;multihash;bytes;"/";constructor(t,e,n,o){this.code=e,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==He)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Va)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=Tt(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n!=null&&t.code===n.code&&t.version===n.version&&Xo(t.multihash,n.multihash)}toString(t){return Jo(this,t)}toJSON(){return{"/":Jo(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:o,multihash:s,bytes:i}=e;return new r(n,o,s,i??ts(n,o,s.bytes))}else if(e[za]===!0){let{version:n,multihash:o,code:s}=e,i=ae(o);return r.create(n,s,i)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==He)throw new Error(`Version 0 CID must use dag-pb (code: ${He}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let o=ts(t,e,n.bytes);return new r(t,e,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,He,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,o=Nt(t.subarray(n,n+e.multihashSize));if(o.byteLength!==e.multihashSize)throw new Error("Incorrect length");let s=o.subarray(e.multihashSize-e.digestSize),i=new ve(e.multihashCode,e.digestSize,s,o);return[e.version===0?r.createV0(i):r.createV1(e.codec,i),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[d,b]=qe(t.subarray(e));return e+=b,d},o=n(),s=He;if(o===18?(o=0,e=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=e,a=n(),c=n(),l=e+c,u=l-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:l}}static parse(t,e){let[n,o]=Ma(t,e),s=r.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return rn(s).set(n,t),s}};function Ma(r,t){switch(r[0]){case"Q":{let e=t??Y;return[Y.prefix,e.decode(`${Y.prefix}${r}`)]}case Y.prefix:{let e=t??Y;return[Y.prefix,e.decode(r)]}case kt.prefix:{let e=t??kt;return[kt.prefix,e.decode(r)]}case Oe.prefix:{let e=t??Oe;return[Oe.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}}function qa(r,t,e){let{prefix:n}=e;if(n!==Y.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let o=t.get(n);if(o==null){let s=e.encode(r).slice(1);return t.set(n,s),s}else return o}function Ha(r,t,e){let{prefix:n}=e,o=t.get(n);if(o==null){let s=e.encode(r);return t.set(n,s),s}else return o}var He=112,Va=18;function ts(r,t,e){let n=Se(r),o=n+Se(t),s=new Uint8Array(o+e.byteLength);return Ae(r,s,0),Ae(t,s,n),s.set(e,o),s}var za=Symbol.for("@ipld/js-cid/CID");var nn={};bt(nn,{identity:()=>Pt});var es=0,Fa="identity",rs=Nt;function Ga(r){return Tt(es,rs(r))}var Pt={code:es,name:Fa,encode:rs,digest:Ga};function st(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function ut(r=0){return new Uint8Array(r)}function xt(r=0){return new Uint8Array(r)}function St(r,t){t==null&&(t=r.reduce((o,s)=>o+s.length,0));let e=xt(t),n=0;for(let o of r)e.set(o,n),n+=o.length;return e}var os=Symbol.for("@achingbrain/uint8arraylist");function ns(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let o=e+n.byteLength;if(t<o)return{buf:n,index:t-e};e=o}throw new RangeError("index is out of bounds")}function fr(r){return!!r?.[os]}var pt=class r{bufs;length;[os]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(fr(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(fr(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=ns(this.bufs,t);return e.buf[e.index]}set(t,e){let n=ns(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(fr(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:o}=this._subList(t,e);return St(n,o)}subarray(t,e){let{bufs:n,length:o}=this._subList(t,e);return n.length===1?n[0]:St(n,o)}sublist(t,e){let{bufs:n,length:o}=this._subList(t,e),s=new r;return s.length=o,s.bufs=[...n],s}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,c=a+i.byteLength;if(o=c,t>=c)continue;let l=t>=a&&t<c,u=e>a&&e<=c;if(l&&u){if(t===a&&e===c){n.push(i);break}let d=t-a;n.push(i.subarray(d,d+(e-t)));break}if(l){if(t===0){n.push(i);continue}n.push(i.subarray(t-a));continue}if(u){if(e===c){n.push(i);break}n.push(i.subarray(0,e-a));break}n.push(i)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!fr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let d=0;d<s;d++)i[d]=-1;for(let d=0;d<o;d++)i[n[d]]=d;let a=i,c=this.byteLength-n.byteLength,l=n.byteLength-1,u;for(let d=e;d<=c;d+=u){u=0;for(let b=l;b>=0;b--){let v=this.get(d+b);if(n[b]!==v){u=Math.max(1,b-a[v]);break}}if(u===0)return d}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=xt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let o=ut(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,e,n),this.write(o,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let o=ut(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,e,n),this.write(o,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let o=ut(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,e,n),this.write(o,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=xt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let o=ut(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,e,n),this.write(o,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let o=ut(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,e,n),this.write(o,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let o=ut(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,e,n),this.write(o,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let o=ut(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,e,n),this.write(o,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let o=ut(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,e,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof r)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!st(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new r;return n.bufs=t,e==null&&(e=t.reduce((o,s)=>o+s.byteLength,0)),n.length=e,n}};var on={};bt(on,{base10:()=>ja});var ja=Wt({prefix:"9",name:"base10",alphabet:"0123456789"});var sn={};bt(sn,{base16:()=>Za,base16upper:()=>Ya});var Za=X({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ya=X({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var an={};bt(an,{base2:()=>$a});var $a=X({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var cn={};bt(cn,{base256emoji:()=>tc});var ss=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Wa=ss.reduce((r,t,e)=>(r[e]=t,r),[]),Xa=ss.reduce((r,t,e)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return r[n]=e,r},[]);function Ja(r){return r.reduce((t,e)=>(t+=Wa[e],t),"")}function Qa(r){let t=[];for(let e of r){let n=e.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${e}`);let o=Xa[n];if(o==null)throw new Error(`Non-base256emoji character: ${e}`);t.push(o)}return new Uint8Array(t)}var tc=Ee({prefix:"\u{1F680}",name:"base256emoji",encode:Ja,decode:Qa});var un={};bt(un,{base64:()=>ec,base64pad:()=>rc,base64url:()=>nc,base64urlpad:()=>oc});var ec=X({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),rc=X({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),nc=X({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),oc=X({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var fn={};bt(fn,{base8:()=>sc});var sc=X({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ln={};bt(ln,{identity:()=>ic});var ic=Ee({prefix:"\0",name:"identity",encode:r=>Fo(r),decode:r=>zo(r)});var Mf=new TextEncoder,qf=new TextDecoder;var pn={};bt(pn,{sha256:()=>Ve,sha512:()=>uc});function dn({name:r,code:t,encode:e}){return new hn(r,t,e)}var hn=class{name;code;encode;constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?Tt(this.code,e):e.then(n=>Tt(this.code,n))}else throw Error("Unknown type, must be binary type")}};function as(r){return async t=>new Uint8Array(await crypto.subtle.digest(r,t))}var Ve=dn({name:"sha2-256",code:18,encode:as("SHA-256")}),uc=dn({name:"sha2-512",code:19,encode:as("SHA-512")});var ze={...ln,...an,...fn,...on,...sn,...Qr,...tn,...Jr,...un,...cn},Jf={...pn,...nn};function us(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var cs=us("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),mn=us("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=xt(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),fc={utf8:cs,"utf-8":cs,hex:ze.base16,latin1:mn,ascii:mn,binary:mn,...ze},lr=fc;function j(r,t="utf8"){let e=lr[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.decoder.decode(`${e.prefix}${r}`)}function O(r,t="utf8"){let e=lr[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.encoder.encode(r).substring(1)}var lc=parseInt("11111",2),yn=parseInt("10000000",2),hc=parseInt("01111111",2),fs={0:Fe,1:Fe,2:dc,3:yc,4:gc,5:mc,6:pc,16:Fe,22:Fe,48:Fe};function Ot(r,t={offset:0}){let e=r[t.offset]&lc;if(t.offset++,fs[e]!=null)return fs[e](r,t);throw new Error("No decoder for tag "+e)}function Ge(r,t){let e=0;if((r[t.offset]&yn)===yn){let n=r[t.offset]&hc,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=r[t.offset].toString(16).padStart(2,"0");e=parseInt(o,16)}else e=r[t.offset],t.offset++;return e}function Fe(r,t){Ge(r,t);let e=[];for(;!(t.offset>=r.byteLength);){let n=Ot(r,t);if(n===null)break;e.push(n)}return e}function dc(r,t){let e=Ge(r,t),n=t.offset,o=t.offset+e,s=[];for(let i=n;i<o;i++)i===n&&r[i]===0||s.push(r[i]);return t.offset+=e,Uint8Array.from(s)}function pc(r,t){let e=Ge(r,t),n=t.offset+e,o=r[t.offset];t.offset++;let s=0,i=0;o<40?(s=0,i=o):o<80?(s=1,i=o-40):(s=2,i=o-80);let a=`${s}.${i}`,c=[];for(;t.offset<n;){let l=r[t.offset];if(t.offset++,c.push(l&127),l<128){c.reverse();let u=0;for(let d=0;d<c.length;d++)u+=c[d]<<d*7;a+=`.${u}`,c=[]}}return a}function mc(r,t){return t.offset++,null}function yc(r,t){let e=Ge(r,t),n=r[t.offset];t.offset++;let o=r.subarray(t.offset,t.offset+e-1);if(t.offset+=e,n!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function gc(r,t){let e=Ge(r,t),n=r.subarray(t.offset,t.offset+e);return t.offset+=e,n}function bc(r){let t=r.toString(16);t.length%2===1&&(t="0"+t);let e=new pt;for(let n=0;n<t.length;n+=2)e.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return e}function gn(r){if(r.byteLength<128)return Uint8Array.from([r.byteLength]);let t=bc(r.byteLength);return new pt(Uint8Array.from([t.byteLength|yn]),t)}function wt(r){let t=new pt,e=128;return(r.subarray()[0]&e)===e&&t.append(Uint8Array.from([0])),t.append(r),new pt(Uint8Array.from([2]),gn(t),t)}function hr(r){let t=Uint8Array.from([0]),e=new pt(t,r);return new pt(Uint8Array.from([3]),gn(e),e)}function Jt(r,t=48){let e=new pt;for(let n of r)e.append(n);return new pt(Uint8Array.from([t]),gn(e),e)}async function ls(r,t,e){let n=await crypto.subtle.importKey("jwk",r,{name:"ECDSA",namedCurve:r.crv??"P-256"},!1,["verify"]);return crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},n,t,e.subarray())}var xc=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),wc=Uint8Array.from([6,5,43,129,4,0,34]),Ec=Uint8Array.from([6,5,43,129,4,0,35]),Ac={ext:!0,kty:"EC",crv:"P-256"},Sc={ext:!0,kty:"EC",crv:"P-384"},vc={ext:!0,kty:"EC",crv:"P-521"},bn=32,xn=48,wn=66;function En(r){let t=Ot(r);return hs(t)}function hs(r){let t=r[1][1][0],e=1,n,o;if(t.byteLength===bn*2+1)return n=O(t.subarray(e,e+bn),"base64url"),o=O(t.subarray(e+bn),"base64url"),new Ie({...Ac,key_ops:["verify"],x:n,y:o});if(t.byteLength===xn*2+1)return n=O(t.subarray(e,e+xn),"base64url"),o=O(t.subarray(e+xn),"base64url"),new Ie({...Sc,key_ops:["verify"],x:n,y:o});if(t.byteLength===wn*2+1)return n=O(t.subarray(e,e+wn),"base64url"),o=O(t.subarray(e+wn),"base64url"),new Ie({...vc,key_ops:["verify"],x:n,y:o});throw new nt(`coordinates were wrong length, got ${t.byteLength}, expected 65, 97 or 133`)}function ds(r){return Jt([wt(Uint8Array.from([1])),Jt([Ic(r.crv)],160),Jt([hr(new pt(Uint8Array.from([4]),j(r.x??"","base64url"),j(r.y??"","base64url")))],161)]).subarray()}function Ic(r){if(r==="P-256")return xc;if(r==="P-384")return wc;if(r==="P-521")return Ec;throw new nt(`Invalid curve ${r}`)}var Ie=class{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){return this._raw==null&&(this._raw=ds(this.jwk)),this._raw}toMultihash(){return Pt.digest(Qt(this))}toCID(){return rt.createV1(114,this.toMultihash())}toString(){return Y.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:st(this.raw,t.raw)}async verify(t,e){return ls(this.jwk,e,t)}};var ce=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Bc(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function dr(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function ue(r,...t){if(!Bc(r))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(r.length))throw new Error("Uint8Array expected of length "+t+", got length="+r.length)}function ps(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");dr(r.outputLen),dr(r.blockLen)}function Te(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function ms(r,t){ue(r);let e=t.outputLen;if(r.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}function Mt(...r){for(let t=0;t<r.length;t++)r[t].fill(0)}function pr(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Lt(r,t){return r<<32-t|r>>>t}function ys(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function je(r){return typeof r=="string"&&(r=ys(r)),ue(r),r}function An(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];ue(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var Be=class{};function Sn(r){let t=n=>r().update(je(n)).digest(),e=r();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>r(),t}function mr(r=32){if(ce&&typeof ce.getRandomValues=="function")return ce.getRandomValues(new Uint8Array(r));if(ce&&typeof ce.randomBytes=="function")return Uint8Array.from(ce.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}function Tc(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(e>>o&s),a=Number(e&s),c=n?4:0,l=n?0:4;r.setUint32(t+c,i,n),r.setUint32(t+l,a,n)}function gs(r,t,e){return r&t^~r&e}function bs(r,t,e){return r&t^r&e^t&e}var Ze=class extends Be{constructor(t,e,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=pr(this.buffer)}update(t){Te(this),t=je(t),ue(t);let{view:e,buffer:n,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let c=pr(t);for(;o<=s-i;i+=o)this.process(c,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Te(this),ms(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;e[i++]=128,Mt(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(n,0),i=0);for(let d=i;d<o;d++)e[d]=0;Tc(n,o-8,BigInt(this.length*8),s),this.process(n,0);let a=pr(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],s)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=a,o%e&&t.buffer.set(n),t}clone(){return this._cloneInto()}},qt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var ft=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var yr=BigInt(4294967295),xs=BigInt(32);function Pc(r,t=!1){return t?{h:Number(r&yr),l:Number(r>>xs&yr)}:{h:Number(r>>xs&yr)|0,l:Number(r&yr)|0}}function ws(r,t=!1){let e=r.length,n=new Uint32Array(e),o=new Uint32Array(e);for(let s=0;s<e;s++){let{h:i,l:a}=Pc(r[s],t);[n[s],o[s]]=[i,a]}return[n,o]}var vn=(r,t,e)=>r>>>e,In=(r,t,e)=>r<<32-e|t>>>e,fe=(r,t,e)=>r>>>e|t<<32-e,le=(r,t,e)=>r<<32-e|t>>>e,Ye=(r,t,e)=>r<<64-e|t>>>e-32,$e=(r,t,e)=>r>>>e-32|t<<64-e;function _t(r,t,e,n){let o=(t>>>0)+(n>>>0);return{h:r+e+(o/2**32|0)|0,l:o|0}}var Es=(r,t,e)=>(r>>>0)+(t>>>0)+(e>>>0),As=(r,t,e,n)=>t+e+n+(r/2**32|0)|0,Ss=(r,t,e,n)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0),vs=(r,t,e,n,o)=>t+e+n+o+(r/2**32|0)|0,Is=(r,t,e,n,o)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0)+(o>>>0),Bs=(r,t,e,n,o,s)=>t+e+n+o+s+(r/2**32|0)|0;var Cc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),te=new Uint32Array(64),gr=class extends Ze{constructor(t=32){super(64,t,8,!1),this.A=qt[0]|0,this.B=qt[1]|0,this.C=qt[2]|0,this.D=qt[3]|0,this.E=qt[4]|0,this.F=qt[5]|0,this.G=qt[6]|0,this.H=qt[7]|0}get(){let{A:t,B:e,C:n,D:o,E:s,F:i,G:a,H:c}=this;return[t,e,n,o,s,i,a,c]}set(t,e,n,o,s,i,a,c){this.A=t|0,this.B=e|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=c|0}process(t,e){for(let d=0;d<16;d++,e+=4)te[d]=t.getUint32(e,!1);for(let d=16;d<64;d++){let b=te[d-15],v=te[d-2],S=Lt(b,7)^Lt(b,18)^b>>>3,y=Lt(v,17)^Lt(v,19)^v>>>10;te[d]=y+te[d-7]+S+te[d-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){let b=Lt(a,6)^Lt(a,11)^Lt(a,25),v=u+b+gs(a,c,l)+Cc[d]+te[d]|0,y=(Lt(n,2)^Lt(n,13)^Lt(n,22))+bs(n,o,s)|0;u=l,l=c,c=a,a=i+v|0,i=s,s=o,o=n,n=v+y|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,o,s,i,a,c,l,u)}roundClean(){Mt(te)}destroy(){this.set(0,0,0,0,0,0,0,0),Mt(this.buffer)}};var Ts=ws(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),_c=Ts[0],Uc=Ts[1],ee=new Uint32Array(80),re=new Uint32Array(80),Bn=class extends Ze{constructor(t=64){super(128,t,16,!1),this.Ah=ft[0]|0,this.Al=ft[1]|0,this.Bh=ft[2]|0,this.Bl=ft[3]|0,this.Ch=ft[4]|0,this.Cl=ft[5]|0,this.Dh=ft[6]|0,this.Dl=ft[7]|0,this.Eh=ft[8]|0,this.El=ft[9]|0,this.Fh=ft[10]|0,this.Fl=ft[11]|0,this.Gh=ft[12]|0,this.Gl=ft[13]|0,this.Hh=ft[14]|0,this.Hl=ft[15]|0}get(){let{Ah:t,Al:e,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:b,Gh:v,Gl:S,Hh:y,Hl:D}=this;return[t,e,n,o,s,i,a,c,l,u,d,b,v,S,y,D]}set(t,e,n,o,s,i,a,c,l,u,d,b,v,S,y,D){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=b|0,this.Gh=v|0,this.Gl=S|0,this.Hh=y|0,this.Hl=D|0}process(t,e){for(let A=0;A<16;A++,e+=4)ee[A]=t.getUint32(e),re[A]=t.getUint32(e+=4);for(let A=16;A<80;A++){let f=ee[A-15]|0,m=re[A-15]|0,I=fe(f,m,1)^fe(f,m,8)^vn(f,m,7),B=le(f,m,1)^le(f,m,8)^In(f,m,7),T=ee[A-2]|0,U=re[A-2]|0,k=fe(T,U,19)^Ye(T,U,61)^vn(T,U,6),L=le(T,U,19)^$e(T,U,61)^In(T,U,6),R=Ss(B,L,re[A-7],re[A-16]),_=vs(R,I,k,ee[A-7],ee[A-16]);ee[A]=_|0,re[A]=R|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:b,Fh:v,Fl:S,Gh:y,Gl:D,Hh:K,Hl:z}=this;for(let A=0;A<80;A++){let f=fe(d,b,14)^fe(d,b,18)^Ye(d,b,41),m=le(d,b,14)^le(d,b,18)^$e(d,b,41),I=d&v^~d&y,B=b&S^~b&D,T=Is(z,m,B,Uc[A],re[A]),U=Bs(T,K,f,I,_c[A],ee[A]),k=T|0,L=fe(n,o,28)^Ye(n,o,34)^Ye(n,o,39),R=le(n,o,28)^$e(n,o,34)^$e(n,o,39),_=n&s^n&a^s&a,tt=o&i^o&c^i&c;K=y|0,z=D|0,y=v|0,D=S|0,v=d|0,S=b|0,{h:d,l:b}=_t(l|0,u|0,U|0,k|0),l=a|0,u=c|0,a=s|0,c=i|0,s=n|0,i=o|0;let w=Es(k,R,tt);n=As(w,U,L,_),o=w|0}({h:n,l:o}=_t(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=_t(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:c}=_t(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=_t(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:b}=_t(this.Eh|0,this.El|0,d|0,b|0),{h:v,l:S}=_t(this.Fh|0,this.Fl|0,v|0,S|0),{h:y,l:D}=_t(this.Gh|0,this.Gl|0,y|0,D|0),{h:K,l:z}=_t(this.Hh|0,this.Hl|0,K|0,z|0),this.set(n,o,s,i,a,c,l,u,d,b,v,S,y,D,K,z)}roundClean(){Mt(ee,re)}destroy(){Mt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var br=Sn(()=>new gr);var Ps=Sn(()=>new Bn);var Cn=BigInt(0),Ln=BigInt(1);function Pe(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function _n(r){if(!Pe(r))throw new Error("Uint8Array expected")}function Ut(r,t){if(typeof t!="boolean")throw new Error(r+" boolean expected, got "+t)}function We(r){let t=r.toString(16);return t.length&1?"0"+t:t}function _s(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Cn:BigInt("0x"+r)}var Us=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Dc=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function ne(r){if(_n(r),Us)return r.toHex();let t="";for(let e=0;e<r.length;e++)t+=Dc[r[e]];return t}var Ht={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ls(r){if(r>=Ht._0&&r<=Ht._9)return r-Ht._0;if(r>=Ht.A&&r<=Ht.F)return r-(Ht.A-10);if(r>=Ht.a&&r<=Ht.f)return r-(Ht.a-10)}function Xe(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(Us)return Uint8Array.fromHex(r);let t=r.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(e);for(let o=0,s=0;o<e;o++,s+=2){let i=Ls(r.charCodeAt(s)),a=Ls(r.charCodeAt(s+1));if(i===void 0||a===void 0){let c=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[o]=i*16+a}return n}function Vt(r){return _s(ne(r))}function he(r){return _n(r),_s(ne(Uint8Array.from(r).reverse()))}function de(r,t){return Xe(r.toString(16).padStart(t*2,"0"))}function Le(r,t){return de(r,t).reverse()}function $(r,t,e){let n;if(typeof t=="string")try{n=Xe(t)}catch(s){throw new Error(r+" must be hex string or Uint8Array, cause: "+s)}else if(Pe(t))n=Uint8Array.from(t);else throw new Error(r+" must be hex string or Uint8Array");let o=n.length;if(typeof e=="number"&&o!==e)throw new Error(r+" of length "+e+" expected, got "+o);return n}function oe(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];_n(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var Tn=r=>typeof r=="bigint"&&Cn<=r;function xr(r,t,e){return Tn(r)&&Tn(t)&&Tn(e)&&t<=r&&r<e}function vt(r,t,e,n){if(!xr(t,e,n))throw new Error("expected valid "+r+": "+e+" <= n < "+n+", got "+t)}function Ds(r){let t;for(t=0;r>Cn;r>>=Ln,t+=1);return t}var pe=r=>(Ln<<BigInt(r))-Ln,Pn=r=>new Uint8Array(r),Cs=r=>Uint8Array.from(r);function Ks(r,t,e){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let n=Pn(r),o=Pn(r),s=0,i=()=>{n.fill(1),o.fill(0),s=0},a=(...d)=>e(o,n,...d),c=(d=Pn(0))=>{o=a(Cs([0]),d),n=a(),d.length!==0&&(o=a(Cs([1]),d),n=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let d=0,b=[];for(;d<t;){n=a();let v=n.slice();b.push(v),d+=n.length}return oe(...b)};return(d,b)=>{i(),c(d);let v;for(;!(v=b(l()));)c();return i(),v}}var Kc={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Pe(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,t)=>t.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function zt(r,t,e={}){let n=(o,s,i)=>{let a=Kc[s];if(typeof a!="function")throw new Error("invalid validator function");let c=r[o];if(!(i&&c===void 0)&&!a(c,r))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+c)};for(let[o,s]of Object.entries(t))n(o,s,!1);for(let[o,s]of Object.entries(e))n(o,s,!0);return r}function Ce(r){let t=new WeakMap;return(e,...n)=>{let o=t.get(e);if(o!==void 0)return o;let s=r(e,...n);return t.set(e,s),s}}var mt=BigInt(0),it=BigInt(1),me=BigInt(2),Rc=BigInt(3),Ns=BigInt(4),ks=BigInt(5),Os=BigInt(8);function G(r,t){let e=r%t;return e>=mt?e:t+e}function W(r,t,e){let n=r;for(;t-- >mt;)n*=n,n%=e;return n}function wr(r,t){if(r===mt)throw new Error("invert: expected non-zero number");if(t<=mt)throw new Error("invert: expected positive modulus, got "+t);let e=G(r,t),n=t,o=mt,s=it,i=it,a=mt;for(;e!==mt;){let l=n/e,u=n%e,d=o-i*l,b=s-a*l;n=e,e=u,o=i,s=a,i=d,a=b}if(n!==it)throw new Error("invert: does not exist");return G(o,t)}function Ms(r,t){let e=(r.ORDER+it)/Ns,n=r.pow(t,e);if(!r.eql(r.sqr(n),t))throw new Error("Cannot find square root");return n}function Nc(r,t){let e=(r.ORDER-ks)/Os,n=r.mul(t,me),o=r.pow(n,e),s=r.mul(t,o),i=r.mul(r.mul(s,me),o),a=r.mul(s,r.sub(i,r.ONE));if(!r.eql(r.sqr(a),t))throw new Error("Cannot find square root");return a}function kc(r){if(r<BigInt(3))throw new Error("sqrt is not defined for small field");let t=r-it,e=0;for(;t%me===mt;)t/=me,e++;let n=me,o=Ft(r);for(;Rs(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(e===1)return Ms;let s=o.pow(n,t),i=(t+it)/me;return function(c,l){if(c.is0(l))return l;if(Rs(c,l)!==1)throw new Error("Cannot find square root");let u=e,d=c.mul(c.ONE,s),b=c.pow(l,t),v=c.pow(l,i);for(;!c.eql(b,c.ONE);){if(c.is0(b))return c.ZERO;let S=1,y=c.sqr(b);for(;!c.eql(y,c.ONE);)if(S++,y=c.sqr(y),S===u)throw new Error("Cannot find square root");let D=it<<BigInt(u-S-1),K=c.pow(d,D);u=S,d=c.sqr(K),b=c.mul(b,d),v=c.mul(v,K)}return v}}function Oc(r){return r%Ns===Rc?Ms:r%Os===ks?Nc:kc(r)}var qs=(r,t)=>(G(r,t)&it)===it,Mc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Un(r){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=Mc.reduce((n,o)=>(n[o]="function",n),t);return zt(r,e)}function qc(r,t,e){if(e<mt)throw new Error("invalid exponent, negatives unsupported");if(e===mt)return r.ONE;if(e===it)return t;let n=r.ONE,o=t;for(;e>mt;)e&it&&(n=r.mul(n,o)),o=r.sqr(o),e>>=it;return n}function _e(r,t,e=!1){let n=new Array(t.length).fill(e?r.ZERO:void 0),o=t.reduce((i,a,c)=>r.is0(a)?i:(n[c]=i,r.mul(i,a)),r.ONE),s=r.inv(o);return t.reduceRight((i,a,c)=>r.is0(a)?i:(n[c]=r.mul(i,n[c]),r.mul(i,a)),s),n}function Rs(r,t){let e=(r.ORDER-it)/me,n=r.pow(t,e),o=r.eql(n,r.ONE),s=r.eql(n,r.ZERO),i=r.eql(n,r.neg(r.ONE));if(!o&&!s&&!i)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function Dn(r,t){t!==void 0&&dr(t);let e=t!==void 0?t:r.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function Ft(r,t,e=!1,n={}){if(r<=mt)throw new Error("invalid field: expected ORDER > 0, got "+r);let{nBitLength:o,nByteLength:s}=Dn(r,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i,a=Object.freeze({ORDER:r,isLE:e,BITS:o,BYTES:s,MASK:pe(o),ZERO:mt,ONE:it,create:c=>G(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return mt<=c&&c<r},is0:c=>c===mt,isOdd:c=>(c&it)===it,neg:c=>G(-c,r),eql:(c,l)=>c===l,sqr:c=>G(c*c,r),add:(c,l)=>G(c+l,r),sub:(c,l)=>G(c-l,r),mul:(c,l)=>G(c*l,r),pow:(c,l)=>qc(a,c,l),div:(c,l)=>G(c*wr(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>wr(c,r),sqrt:n.sqrt||(c=>(i||(i=Oc(r)),i(a,c))),toBytes:c=>e?Le(c,s):de(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return e?he(c):Vt(c)},invertBatch:c=>_e(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function Hs(r){if(typeof r!="bigint")throw new Error("field order must be bigint");let t=r.toString(2).length;return Math.ceil(t/8)}function Kn(r){let t=Hs(r);return t+Math.ceil(t/2)}function Vs(r,t,e=!1){let n=r.length,o=Hs(t),s=Kn(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=e?he(r):Vt(r),a=G(i,t-it)+it;return e?Le(a,o):de(a,o)}var zs=BigInt(0),Mn=BigInt(1);function Rn(r,t){let e=t.negate();return r?e:t}function Gs(r,t){if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+r)}function Nn(r,t){Gs(r,t);let e=Math.ceil(t/r)+1,n=2**(r-1),o=2**r,s=pe(r),i=BigInt(r);return{windows:e,windowSize:n,mask:s,maxNumber:o,shiftBy:i}}function Fs(r,t,e){let{windowSize:n,mask:o,maxNumber:s,shiftBy:i}=e,a=Number(r&o),c=r>>i;a>n&&(a-=s,c+=Mn);let l=t*n,u=l+Math.abs(a)-1,d=a===0,b=a<0,v=t%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:b,isNegF:v,offsetF:l}}function Hc(r,t){if(!Array.isArray(r))throw new Error("array expected");r.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function Vc(r,t){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}var kn=new WeakMap,js=new WeakMap;function On(r){return js.get(r)||1}function Er(r,t){return{constTimeNegate:Rn,hasPrecomputes(e){return On(e)!==1},unsafeLadder(e,n,o=r.ZERO){let s=e;for(;n>zs;)n&Mn&&(o=o.add(s)),s=s.double(),n>>=Mn;return o},precomputeWindow(e,n){let{windows:o,windowSize:s}=Nn(n,t),i=[],a=e,c=a;for(let l=0;l<o;l++){c=a,i.push(c);for(let u=1;u<s;u++)c=c.add(a),i.push(c);a=c.double()}return i},wNAF(e,n,o){let s=r.ZERO,i=r.BASE,a=Nn(e,t);for(let c=0;c<a.windows;c++){let{nextN:l,offset:u,isZero:d,isNeg:b,isNegF:v,offsetF:S}=Fs(o,c,a);o=l,d?i=i.add(Rn(v,n[S])):s=s.add(Rn(b,n[u]))}return{p:s,f:i}},wNAFUnsafe(e,n,o,s=r.ZERO){let i=Nn(e,t);for(let a=0;a<i.windows&&o!==zs;a++){let{nextN:c,offset:l,isZero:u,isNeg:d}=Fs(o,a,i);if(o=c,!u){let b=n[l];s=s.add(d?b.negate():b)}}return s},getPrecomputes(e,n,o){let s=kn.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&kn.set(n,o(s))),s},wNAFCached(e,n,o){let s=On(e);return this.wNAF(s,this.getPrecomputes(s,e,o),n)},wNAFCachedUnsafe(e,n,o,s){let i=On(e);return i===1?this.unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,o),n,s)},setWindowSize(e,n){Gs(n,t),js.set(e,n),kn.delete(e)}}}function Ar(r,t,e,n){Hc(e,r),Vc(n,t);let o=e.length,s=n.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");let i=r.ZERO,a=Ds(BigInt(o)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=pe(c),u=new Array(Number(l)+1).fill(i),d=Math.floor((t.BITS-1)/c)*c,b=i;for(let v=d;v>=0;v-=c){u.fill(i);for(let y=0;y<s;y++){let D=n[y],K=Number(D>>BigInt(v)&l);u[K]=u[K].add(e[y])}let S=i;for(let y=u.length-1,D=i;y>0;y--)D=D.add(u[y]),S=S.add(D);if(b=b.add(S),v!==0)for(let y=0;y<c;y++)b=b.double()}return b}function Je(r){return Un(r.Fp),zt(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Dn(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}var Dt=BigInt(0),yt=BigInt(1),Zs=BigInt(2),zc=BigInt(8),Fc={zip215:!0};function Gc(r){let t=Je(r);return zt(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Ys(r){let t=Gc(r),{Fp:e,n,prehash:o,hash:s,randomBytes:i,nByteLength:a,h:c}=t,l=Zs<<BigInt(a*8)-yt,u=e.create,d=Ft(t.n,t.nBitLength);function b(g,h){let p=e.sqr(g),E=e.sqr(h),C=e.add(e.mul(t.a,p),E),N=e.add(e.ONE,e.mul(t.d,e.mul(p,E)));return e.eql(C,N)}if(!b(t.Gx,t.Gy))throw new Error("bad curve params: generator point");let v=t.uvRatio||((g,h)=>{try{return{isValid:!0,value:e.sqrt(g*e.inv(h))}}catch{return{isValid:!1,value:Dt}}}),S=t.adjustScalarBytes||(g=>g),y=t.domain||((g,h,p)=>{if(Ut("phflag",p),h.length||p)throw new Error("Contexts/pre-hash are not supported");return g});function D(g,h,p=!1){let E=p?yt:Dt;vt("coordinate "+g,h,E,l)}function K(g){if(!(g instanceof f))throw new Error("ExtendedPoint expected")}let z=Ce((g,h)=>{let{ex:p,ey:E,ez:C}=g,N=g.is0();h==null&&(h=N?zc:e.inv(C));let M=u(p*h),q=u(E*h),H=u(C*h);if(N)return{x:Dt,y:yt};if(H!==yt)throw new Error("invZ was invalid");return{x:M,y:q}}),A=Ce(g=>{let{a:h,d:p}=t;if(g.is0())throw new Error("bad point: ZERO");let{ex:E,ey:C,ez:N,et:M}=g,q=u(E*E),H=u(C*C),F=u(N*N),et=u(F*F),J=u(q*h),ct=u(F*u(J+H)),gt=u(et+u(p*u(q*H)));if(ct!==gt)throw new Error("bad point: equation left != right (1)");let ot=u(E*C),lt=u(N*M);if(ot!==lt)throw new Error("bad point: equation left != right (2)");return!0});class f{constructor(h,p,E,C){D("x",h),D("y",p),D("z",E,!0),D("t",C),this.ex=h,this.ey=p,this.ez=E,this.et=C,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(h){if(h instanceof f)throw new Error("extended point not allowed");let{x:p,y:E}=h||{};return D("x",p),D("y",E),new f(p,E,yt,u(p*E))}static normalizeZ(h){let p=_e(e,h.map(E=>E.ez));return h.map((E,C)=>E.toAffine(p[C])).map(f.fromAffine)}static msm(h,p){return Ar(f,d,h,p)}_setWindowSize(h){B.setWindowSize(this,h)}assertValidity(){A(this)}equals(h){K(h);let{ex:p,ey:E,ez:C}=this,{ex:N,ey:M,ez:q}=h,H=u(p*q),F=u(N*C),et=u(E*q),J=u(M*C);return H===F&&et===J}is0(){return this.equals(f.ZERO)}negate(){return new f(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:h}=t,{ex:p,ey:E,ez:C}=this,N=u(p*p),M=u(E*E),q=u(Zs*u(C*C)),H=u(h*N),F=p+E,et=u(u(F*F)-N-M),J=H+M,ct=J-q,gt=H-M,ot=u(et*ct),lt=u(J*gt),At=u(et*gt),Bt=u(ct*J);return new f(ot,lt,Bt,At)}add(h){K(h);let{a:p,d:E}=t,{ex:C,ey:N,ez:M,et:q}=this,{ex:H,ey:F,ez:et,et:J}=h,ct=u(C*H),gt=u(N*F),ot=u(q*E*J),lt=u(M*et),At=u((C+N)*(H+F)-ct-gt),Bt=lt-ot,ke=lt+ot,Ho=u(gt-p*ct),Wi=u(At*Bt),Xi=u(ke*Ho),Ji=u(At*Ho),Qi=u(Bt*ke);return new f(Wi,Xi,Qi,Ji)}subtract(h){return this.add(h.negate())}wNAF(h){return B.wNAFCached(this,h,f.normalizeZ)}multiply(h){let p=h;vt("scalar",p,yt,n);let{p:E,f:C}=this.wNAF(p);return f.normalizeZ([E,C])[0]}multiplyUnsafe(h,p=f.ZERO){let E=h;return vt("scalar",E,Dt,n),E===Dt?I:this.is0()||E===yt?this:B.wNAFCachedUnsafe(this,E,f.normalizeZ,p)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return B.unsafeLadder(this,n).is0()}toAffine(h){return z(this,h)}clearCofactor(){let{h}=t;return h===yt?this:this.multiplyUnsafe(h)}static fromHex(h,p=!1){let{d:E,a:C}=t,N=e.BYTES;h=$("pointHex",h,N),Ut("zip215",p);let M=h.slice(),q=h[N-1];M[N-1]=q&-129;let H=he(M),F=p?l:e.ORDER;vt("pointHex.y",H,Dt,F);let et=u(H*H),J=u(et-yt),ct=u(E*et-C),{isValid:gt,value:ot}=v(J,ct);if(!gt)throw new Error("Point.fromHex: invalid y coordinate");let lt=(ot&yt)===yt,At=(q&128)!==0;if(!p&&ot===Dt&&At)throw new Error("Point.fromHex: x=0 and x_0=1");return At!==lt&&(ot=u(-ot)),f.fromAffine({x:ot,y:H})}static fromPrivateKey(h){let{scalar:p}=k(h);return m.multiply(p)}toRawBytes(){let{x:h,y:p}=this.toAffine(),E=Le(p,e.BYTES);return E[E.length-1]|=h&yt?128:0,E}toHex(){return ne(this.toRawBytes())}}f.BASE=new f(t.Gx,t.Gy,yt,u(t.Gx*t.Gy)),f.ZERO=new f(Dt,yt,yt,Dt);let{BASE:m,ZERO:I}=f,B=Er(f,a*8);function T(g){return G(g,n)}function U(g){return T(he(g))}function k(g){let h=e.BYTES;g=$("private key",g,h);let p=$("hashed private key",s(g),2*h),E=S(p.slice(0,h)),C=p.slice(h,2*h),N=U(E);return{head:E,prefix:C,scalar:N}}function L(g){let{head:h,prefix:p,scalar:E}=k(g),C=m.multiply(E),N=C.toRawBytes();return{head:h,prefix:p,scalar:E,point:C,pointBytes:N}}function R(g){return L(g).pointBytes}function _(g=Uint8Array.of(),...h){let p=oe(...h);return U(s(y(p,$("context",g),!!o)))}function tt(g,h,p={}){g=$("message",g),o&&(g=o(g));let{prefix:E,scalar:C,pointBytes:N}=L(h),M=_(p.context,E,g),q=m.multiply(M).toRawBytes(),H=_(p.context,q,N,g),F=T(M+H*C);vt("signature.s",F,Dt,n);let et=oe(q,Le(F,e.BYTES));return $("result",et,e.BYTES*2)}let w=Fc;function x(g,h,p,E=w){let{context:C,zip215:N}=E,M=e.BYTES;g=$("signature",g,2*M),h=$("message",h),p=$("publicKey",p,M),N!==void 0&&Ut("zip215",N),o&&(h=o(h));let q=he(g.slice(M,2*M)),H,F,et;try{H=f.fromHex(p,N),F=f.fromHex(g.slice(0,M),N),et=m.multiplyUnsafe(q)}catch{return!1}if(!N&&H.isSmallOrder())return!1;let J=_(C,F.toRawBytes(),H.toRawBytes(),h);return F.add(H.multiplyUnsafe(J)).subtract(et).clearCofactor().equals(f.ZERO)}return m._setWindowSize(8),{CURVE:t,getPublicKey:R,sign:tt,verify:x,ExtendedPoint:f,utils:{getExtendedPublicKey:L,randomPrivateKey:()=>i(e.BYTES),precompute(g=8,h=f.BASE){return h._setWindowSize(g),h.multiply(BigInt(3)),h}}}}var qn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),$s=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),eh=BigInt(0),jc=BigInt(1),Ws=BigInt(2),rh=BigInt(3),Zc=BigInt(5),Yc=BigInt(8);function $c(r){let t=BigInt(10),e=BigInt(20),n=BigInt(40),o=BigInt(80),s=qn,a=r*r%s*r%s,c=W(a,Ws,s)*a%s,l=W(c,jc,s)*r%s,u=W(l,Zc,s)*l%s,d=W(u,t,s)*u%s,b=W(d,e,s)*d%s,v=W(b,n,s)*b%s,S=W(v,o,s)*v%s,y=W(S,o,s)*v%s,D=W(y,t,s)*u%s;return{pow_p_5_8:W(D,Ws,s)*r%s,b2:a}}function Wc(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function Xc(r,t){let e=qn,n=G(t*t*t,e),o=G(n*n*t,e),s=$c(r*o).pow_p_5_8,i=G(r*n*s,e),a=G(t*i*i,e),c=i,l=G(i*$s,e),u=a===r,d=a===G(-r,e),b=a===G(-r*$s,e);return u&&(i=c),(d||b)&&(i=l),qs(i,e)&&(i=G(-i,e)),{isValid:u||d,value:i}}var Xs=Ft(qn,void 0,!0),Jc={a:Xs.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Xs,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Yc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Ps,randomBytes:mr,adjustScalarBytes:Wc,uvRatio:Xc},Js=Ys(Jc);var Sr=32;function Qs(r,t,e){return Js.verify(t,e instanceof Uint8Array?e:e.subarray(),r)}var vr=class{type="Ed25519";raw;constructor(t){this.raw=Hn(t,Sr)}toMultihash(){return Pt.digest(Qt(this))}toCID(){return rt.createV1(114,this.toMultihash())}toString(){return Y.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:st(this.raw,t.raw)}verify(t,e){return Qs(this.raw,e,t)}};function Vn(r){return r=Hn(r,Sr),new vr(r)}function Hn(r,t){if(r=Uint8Array.from(r??[]),r.length!==t)throw new nt(`Key must be a Uint8Array of length ${t}, got ${r.length}`);return r}var tu=Math.pow(2,7),eu=Math.pow(2,14),ru=Math.pow(2,21),zn=Math.pow(2,28),Fn=Math.pow(2,35),Gn=Math.pow(2,42),jn=Math.pow(2,49),V=128,ht=127;function Et(r){if(r<tu)return 1;if(r<eu)return 2;if(r<ru)return 3;if(r<zn)return 4;if(r<Fn)return 5;if(r<Gn)return 6;if(r<jn)return 7;if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Zn(r,t,e=0){switch(Et(r)){case 8:t[e++]=r&255|V,r/=128;case 7:t[e++]=r&255|V,r/=128;case 6:t[e++]=r&255|V,r/=128;case 5:t[e++]=r&255|V,r/=128;case 4:t[e++]=r&255|V,r>>>=7;case 3:t[e++]=r&255|V,r>>>=7;case 2:t[e++]=r&255|V,r>>>=7;case 1:{t[e++]=r&255,r>>>=7;break}default:throw new Error("unreachable")}return t}function nu(r,t,e=0){switch(Et(r)){case 8:t.set(e++,r&255|V),r/=128;case 7:t.set(e++,r&255|V),r/=128;case 6:t.set(e++,r&255|V),r/=128;case 5:t.set(e++,r&255|V),r/=128;case 4:t.set(e++,r&255|V),r>>>=7;case 3:t.set(e++,r&255|V),r>>>=7;case 2:t.set(e++,r&255|V),r>>>=7;case 1:{t.set(e++,r&255),r>>>=7;break}default:throw new Error("unreachable")}return t}function Yn(r,t){let e=r[t],n=0;if(n+=e&ht,e<V||(e=r[t+1],n+=(e&ht)<<7,e<V)||(e=r[t+2],n+=(e&ht)<<14,e<V)||(e=r[t+3],n+=(e&ht)<<21,e<V)||(e=r[t+4],n+=(e&ht)*zn,e<V)||(e=r[t+5],n+=(e&ht)*Fn,e<V)||(e=r[t+6],n+=(e&ht)*Gn,e<V)||(e=r[t+7],n+=(e&ht)*jn,e<V))return n;throw new RangeError("Could not decode varint")}function ou(r,t){let e=r.get(t),n=0;if(n+=e&ht,e<V||(e=r.get(t+1),n+=(e&ht)<<7,e<V)||(e=r.get(t+2),n+=(e&ht)<<14,e<V)||(e=r.get(t+3),n+=(e&ht)<<21,e<V)||(e=r.get(t+4),n+=(e&ht)*zn,e<V)||(e=r.get(t+5),n+=(e&ht)*Fn,e<V)||(e=r.get(t+6),n+=(e&ht)*Gn,e<V)||(e=r.get(t+7),n+=(e&ht)*jn,e<V))return n;throw new RangeError("Could not decode varint")}function Kt(r,t,e=0){return t==null&&(t=xt(Et(r))),t instanceof Uint8Array?Zn(r,t,e):nu(r,t,e)}function ye(r,t=0){return r instanceof Uint8Array?Yn(r,t):ou(r,t)}var Wn=new Float32Array([-0]),se=new Uint8Array(Wn.buffer);function ei(r,t,e){Wn[0]=r,t[e]=se[0],t[e+1]=se[1],t[e+2]=se[2],t[e+3]=se[3]}function ri(r,t){return se[0]=r[t],se[1]=r[t+1],se[2]=r[t+2],se[3]=r[t+3],Wn[0]}var Xn=new Float64Array([-0]),dt=new Uint8Array(Xn.buffer);function ni(r,t,e){Xn[0]=r,t[e]=dt[0],t[e+1]=dt[1],t[e+2]=dt[2],t[e+3]=dt[3],t[e+4]=dt[4],t[e+5]=dt[5],t[e+6]=dt[6],t[e+7]=dt[7]}function oi(r,t){return dt[0]=r[t],dt[1]=r[t+1],dt[2]=r[t+2],dt[3]=r[t+3],dt[4]=r[t+4],dt[5]=r[t+5],dt[6]=r[t+6],dt[7]=r[t+7],Xn[0]}var su=BigInt(Number.MAX_SAFE_INTEGER),iu=BigInt(Number.MIN_SAFE_INTEGER),It=class r{lo;hi;constructor(t,e){this.lo=t|0,this.hi=e|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(BigInt(e)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return ge;if(t<su&&t>iu)return this.fromNumber(Number(t));let e=t<0n;e&&(t=-t);let n=t>>32n,o=t-(n<<32n);return e&&(n=~n|0n,o=~o|0n,++o>si&&(o=0n,++n>si&&(n=0n))),new r(Number(o),Number(n))}static fromNumber(t){if(t===0)return ge;let e=t<0;e&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return e&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new r(n,o)}static from(t){return typeof t=="number"?r.fromNumber(t):typeof t=="bigint"?r.fromBigInt(t):typeof t=="string"?r.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new r(t.low>>>0,t.high>>>0):ge}},ge=new It(0,0);ge.toBigInt=function(){return 0n};ge.zzEncode=ge.zzDecode=function(){return this};ge.length=function(){return 1};var si=4294967296n;function ii(r){let t=0,e=0;for(let n=0;n<r.length;++n)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:(e&64512)===55296&&(r.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function ai(r,t,e){if(e-t<1)return"";let o,s=[],i=0,a;for(;t<e;)a=r[t++],a<128?s[i++]=a:a>191&&a<224?s[i++]=(a&31)<<6|r[t++]&63:a>239&&a<365?(a=((a&7)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,s[i++]=55296+(a>>10),s[i++]=56320+(a&1023)):s[i++]=(a&15)<<12|(r[t++]&63)<<6|r[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function Jn(r,t,e){let n=e,o,s;for(let i=0;i<r.length;++i)o=r.charCodeAt(i),o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&((s=r.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128);return e-n}function Ct(r,t){return RangeError(`index out of range: ${r.pos} + ${t??1} > ${r.len}`)}function Ir(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}var Qn=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Ct(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Ct(this,4);return Ir(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Ct(this,4);return Ir(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Ct(this,4);let t=ri(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw Ct(this,4);let t=oi(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw Ct(this,t);return this.pos+=t,e===n?new Uint8Array(0):this.buf.subarray(e,n)}string(){let t=this.bytes();return ai(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Ct(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Ct(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new It(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Ct(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Ct(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Ct(this,8);let t=Ir(this.buf,this.pos+=4),e=Ir(this.buf,this.pos+=4);return new It(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=Yn(this.buf,this.pos);return this.pos+=Et(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function to(r){return new Qn(r instanceof Uint8Array?r:r.subarray())}function Gt(r,t,e){let n=to(r);return t.decode(n,void 0,e)}function eo(r){let t=r??8192,e=t>>>1,n,o=t;return function(i){if(i<1||i>e)return xt(i);o+i>t&&(n=xt(t),o=0);let a=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),a}}var be=class{fn;len;next;val;constructor(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}};function ro(){}var oo=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},au=eo();function cu(r){return globalThis.Buffer!=null?xt(r):au(r)}var tr=class{len;head;tail;states;constructor(){this.len=0,this.head=new be(ro,0,0),this.tail=this.head,this.states=null}_push(t,e,n){return this.tail=this.tail.next=new be(t,e,n),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new so((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(Br,10,It.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let e=It.fromBigInt(t);return this._push(Br,e.length(),e)}uint64Number(t){return this._push(Zn,Et(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let e=It.fromBigInt(t).zzEncode();return this._push(Br,e.length(),e)}sint64Number(t){let e=It.fromNumber(t).zzEncode();return this._push(Br,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(no,1,t?1:0)}fixed32(t){return this._push(Qe,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let e=It.fromBigInt(t);return this._push(Qe,4,e.lo)._push(Qe,4,e.hi)}fixed64Number(t){let e=It.fromNumber(t);return this._push(Qe,4,e.lo)._push(Qe,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(ei,4,t)}double(t){return this._push(ni,8,t)}bytes(t){let e=t.length>>>0;return e===0?this._push(no,1,0):this.uint32(e)._push(fu,e,t)}string(t){let e=ii(t);return e!==0?this.uint32(e)._push(Jn,e,t):this._push(no,1,0)}fork(){return this.states=new oo(this),this.head=this.tail=new be(ro,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new be(ro,0,0),this.len=0),this}ldelim(){let t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=e,this.len+=n),this}finish(){let t=this.head.next,e=cu(this.len),n=0;for(;t!=null;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}};function no(r,t,e){t[e]=r&255}function uu(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}var so=class extends be{next;constructor(t,e){super(uu,t,e),this.next=void 0}};function Br(r,t,e){for(;r.hi!==0;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}function Qe(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function fu(r,t,e){t.set(r,e)}globalThis.Buffer!=null&&(tr.prototype.bytes=function(r){let t=r.length>>>0;return this.uint32(t),t>0&&this._push(lu,t,r),this},tr.prototype.string=function(r){let t=globalThis.Buffer.byteLength(r);return this.uint32(t),t>0&&this._push(hu,t,r),this});function lu(r,t,e){t.set(r,e)}function hu(r,t,e){r.length<40?Jn(r,t,e):t.utf8Write!=null?t.utf8Write(r,e):t.set(j(r),e)}function io(){return new tr}function jt(r,t){let e=io();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var Ue;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(Ue||(Ue={}));function Tr(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function ao(r){function t(o){if(r[o.toString()]==null)throw new Error("Invalid enum value");return r[o]}let e=function(s,i){let a=t(s);i.int32(a)},n=function(s){let i=s.int32();return t(i)};return Tr("enum",Ue.VARINT,e,n)}function Zt(r,t){return Tr("message",Ue.LENGTH_DELIMITED,r,t)}var Pr=class extends Error{code="ERR_MAX_LENGTH";name="MaxLengthError"};var Q;(function(r){r.RSA="RSA",r.Ed25519="Ed25519",r.secp256k1="secp256k1",r.ECDSA="ECDSA"})(Q||(Q={}));var co;(function(r){r[r.RSA=0]="RSA",r[r.Ed25519=1]="Ed25519",r[r.secp256k1=2]="secp256k1",r[r.ECDSA=3]="ECDSA"})(co||(co={}));(function(r){r.codec=()=>ao(co)})(Q||(Q={}));var Rt;(function(r){let t;r.codec=()=>(t==null&&(t=Zt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),Q.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=Q.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>jt(e,r.codec()),r.decode=(e,n)=>Gt(e,r.codec(),n)})(Rt||(Rt={}));var uo;(function(r){let t;r.codec=()=>(t==null&&(t=Zt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),Q.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=Q.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>jt(e,r.codec()),r.decode=(e,n)=>Gt(e,r.codec(),n)})(uo||(uo={}));var er=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},Lr=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var fi={get(r=globalThis){let t=r.crypto;if(t?.subtle==null)throw new Lr("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var ie=fi;var nr={};bt(nr,{MAX_RSA_KEY_SIZE:()=>fo,generateRSAKeyPair:()=>pi,jwkToJWKKeyPair:()=>mi,jwkToPkcs1:()=>yu,jwkToPkix:()=>mo,jwkToRSAPrivateKey:()=>xo,pkcs1MessageToJwk:()=>ho,pkcs1MessageToRSAPrivateKey:()=>yo,pkcs1ToJwk:()=>mu,pkcs1ToRSAPrivateKey:()=>di,pkixMessageToJwk:()=>po,pkixMessageToRSAPublicKey:()=>bo,pkixToJwk:()=>gu,pkixToRSAPublicKey:()=>go});var Cr=br;var De=class{type="RSA";jwk;_raw;_multihash;constructor(t,e){this.jwk=t,this._multihash=e}get raw(){return this._raw==null&&(this._raw=nr.jwkToPkix(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return rt.createV1(114,this._multihash)}toString(){return Y.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:st(this.raw,t.raw)}verify(t,e){return hi(this.jwk,e,t)}},rr=class{type="RSA";jwk;_raw;publicKey;constructor(t,e){this.jwk=t,this.publicKey=e}get raw(){return this._raw==null&&(this._raw=nr.jwkToPkcs1(this.jwk)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:st(this.raw,t.raw)}sign(t){return li(this.jwk,t)}};var fo=8192,lo=18,du=1062,pu=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function mu(r){let t=Ot(r);return ho(t)}function ho(r){return{n:O(r[1],"base64url"),e:O(r[2],"base64url"),d:O(r[3],"base64url"),p:O(r[4],"base64url"),q:O(r[5],"base64url"),dp:O(r[6],"base64url"),dq:O(r[7],"base64url"),qi:O(r[8],"base64url"),kty:"RSA"}}function yu(r){if(r.n==null||r.e==null||r.d==null||r.p==null||r.q==null||r.dp==null||r.dq==null||r.qi==null)throw new nt("JWK was missing components");return Jt([wt(Uint8Array.from([0])),wt(j(r.n,"base64url")),wt(j(r.e,"base64url")),wt(j(r.d,"base64url")),wt(j(r.p,"base64url")),wt(j(r.q,"base64url")),wt(j(r.dp,"base64url")),wt(j(r.dq,"base64url")),wt(j(r.qi,"base64url"))]).subarray()}function gu(r){let t=Ot(r,{offset:0});return po(t)}function po(r){let t=Ot(r[1],{offset:0});return{kty:"RSA",n:O(t[0],"base64url"),e:O(t[1],"base64url")}}function mo(r){if(r.n==null||r.e==null)throw new nt("JWK was missing components");return Jt([pu,hr(Jt([wt(j(r.n,"base64url")),wt(j(r.e,"base64url"))]))]).subarray()}function di(r){let t=Ot(r);return yo(t)}function yo(r){let t=ho(r);return xo(t)}function go(r,t){if(r.byteLength>=du)throw new xe("Key size is too large");let e=Ot(r,{offset:0});return bo(e,r,t)}function bo(r,t,e){let n=po(r);if(e==null){let o=Cr(Rt.encode({Type:Q.RSA,Data:t}));e=Tt(lo,o)}return new De(n,e)}function xo(r){if(gi(r)>fo)throw new nt("Key size is too large");let t=mi(r),e=Cr(Rt.encode({Type:Q.RSA,Data:mo(t.publicKey)})),n=Tt(lo,e);return new rr(t.privateKey,new De(t.publicKey,n))}async function pi(r){if(r>fo)throw new nt("Key size is too large");let t=await yi(r),e=Cr(Rt.encode({Type:Q.RSA,Data:mo(t.publicKey)})),n=Tt(lo,e);return new rr(t.privateKey,new De(t.publicKey,n))}function mi(r){if(r==null)throw new nt("Missing key parameter");return{privateKey:r,publicKey:{kty:r.kty,n:r.n,e:r.e}}}async function yi(r){let t=await ie.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),e=await bu(t);return{privateKey:e[0],publicKey:e[1]}}async function li(r,t){let e=await ie.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ie.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},e,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function hi(r,t,e){let n=await ie.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ie.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,e instanceof Uint8Array?e:e.subarray())}async function bu(r){if(r.privateKey==null||r.publicKey==null)throw new nt("Private and public key are required");return Promise.all([ie.get().subtle.exportKey("jwk",r.privateKey),ie.get().subtle.exportKey("jwk",r.publicKey)])}function gi(r){if(r.kty!=="RSA")throw new nt("invalid key type");if(r.n==null)throw new nt("invalid key modulus");return j(r.n,"base64url").length*8}var _r=class extends Be{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,ps(t);let n=je(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),Mt(s)}update(t){return Te(this),this.iHash.update(t),this}digestInto(t){Te(this),ue(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},wo=(r,t,e)=>new _r(r,t).update(e).digest();wo.create=(r,t)=>new _r(r,t);function bi(r){r.lowS!==void 0&&Ut("lowS",r.lowS),r.prehash!==void 0&&Ut("prehash",r.prehash)}function xu(r){let t=Je(r);zt(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});let{endo:e,Fp:n,a:o}=t;if(e){if(!n.eql(o,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}var So=class extends Error{constructor(t=""){super(t)}},Yt={Err:So,_tlv:{encode:(r,t)=>{let{Err:e}=Yt;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");let n=t.length/2,o=We(n);if(o.length/2&128)throw new e("tlv.encode: long form length too big");let s=n>127?We(o.length/2|128):"";return We(r)+s+o+t},decode(r,t){let{Err:e}=Yt,n=0;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==r)throw new e("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let c=o&127;if(!c)throw new e("tlv.decode(long): indefinite length not supported");if(c>4)throw new e("tlv.decode(long): byte length is too big");let l=t.subarray(n,n+c);if(l.length!==c)throw new e("tlv.decode: length bytes not complete");if(l[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let u of l)i=i<<8|u;if(n+=c,i<128)throw new e("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+i);if(a.length!==i)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+i)}}},_int:{encode(r){let{Err:t}=Yt;if(r<$t)throw new t("integer: negative integers are not allowed");let e=We(r);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(r){let{Err:t}=Yt;if(r[0]&128)throw new t("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Vt(r)}},toSig(r){let{Err:t,_int:e,_tlv:n}=Yt,o=$("signature",r),{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=n.decode(2,s),{v:l,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(a),s:e.decode(l)}},hexFromSig(r){let{_tlv:t,_int:e}=Yt,n=t.encode(2,e.encode(r.r)),o=t.encode(2,e.encode(r.s)),s=n+o;return t.encode(48,s)}};function Eo(r,t){return ne(de(r,t))}var $t=BigInt(0),at=BigInt(1),Ld=BigInt(2),Ao=BigInt(3),wu=BigInt(4);function Eu(r){let t=xu(r),{Fp:e}=t,n=Ft(t.n,t.nBitLength),o=t.toBytes||((A,f,m)=>{let I=f.toAffine();return oe(Uint8Array.from([4]),e.toBytes(I.x),e.toBytes(I.y))}),s=t.fromBytes||(A=>{let f=A.subarray(1),m=e.fromBytes(f.subarray(0,e.BYTES)),I=e.fromBytes(f.subarray(e.BYTES,2*e.BYTES));return{x:m,y:I}});function i(A){let{a:f,b:m}=t,I=e.sqr(A),B=e.mul(I,A);return e.add(e.add(B,e.mul(A,f)),m)}function a(A,f){let m=e.sqr(f),I=i(A);return e.eql(m,I)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");let c=e.mul(e.pow(t.a,Ao),wu),l=e.mul(e.sqr(t.b),BigInt(27));if(e.is0(e.add(c,l)))throw new Error("bad curve params: a or b");function u(A){return xr(A,at,t.n)}function d(A){let{allowedPrivateKeyLengths:f,nByteLength:m,wrapPrivateKey:I,n:B}=t;if(f&&typeof A!="bigint"){if(Pe(A)&&(A=ne(A)),typeof A!="string"||!f.includes(A.length))throw new Error("invalid private key");A=A.padStart(m*2,"0")}let T;try{T=typeof A=="bigint"?A:Vt($("private key",A,m))}catch{throw new Error("invalid private key, expected hex or "+m+" bytes, got "+typeof A)}return I&&(T=G(T,B)),vt("private key",T,at,B),T}function b(A){if(!(A instanceof y))throw new Error("ProjectivePoint expected")}let v=Ce((A,f)=>{let{px:m,py:I,pz:B}=A;if(e.eql(B,e.ONE))return{x:m,y:I};let T=A.is0();f==null&&(f=T?e.ONE:e.inv(B));let U=e.mul(m,f),k=e.mul(I,f),L=e.mul(B,f);if(T)return{x:e.ZERO,y:e.ZERO};if(!e.eql(L,e.ONE))throw new Error("invZ was invalid");return{x:U,y:k}}),S=Ce(A=>{if(A.is0()){if(t.allowInfinityPoint&&!e.is0(A.py))return;throw new Error("bad point: ZERO")}let{x:f,y:m}=A.toAffine();if(!e.isValid(f)||!e.isValid(m))throw new Error("bad point: x or y not FE");if(!a(f,m))throw new Error("bad point: equation left != right");if(!A.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class y{constructor(f,m,I){if(f==null||!e.isValid(f))throw new Error("x required");if(m==null||!e.isValid(m)||e.is0(m))throw new Error("y required");if(I==null||!e.isValid(I))throw new Error("z required");this.px=f,this.py=m,this.pz=I,Object.freeze(this)}static fromAffine(f){let{x:m,y:I}=f||{};if(!f||!e.isValid(m)||!e.isValid(I))throw new Error("invalid affine point");if(f instanceof y)throw new Error("projective point not allowed");let B=T=>e.eql(T,e.ZERO);return B(m)&&B(I)?y.ZERO:new y(m,I,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(f){let m=_e(e,f.map(I=>I.pz));return f.map((I,B)=>I.toAffine(m[B])).map(y.fromAffine)}static fromHex(f){let m=y.fromAffine(s($("pointHex",f)));return m.assertValidity(),m}static fromPrivateKey(f){return y.BASE.multiply(d(f))}static msm(f,m){return Ar(y,n,f,m)}_setWindowSize(f){z.setWindowSize(this,f)}assertValidity(){S(this)}hasEvenY(){let{y:f}=this.toAffine();if(e.isOdd)return!e.isOdd(f);throw new Error("Field doesn't support isOdd")}equals(f){b(f);let{px:m,py:I,pz:B}=this,{px:T,py:U,pz:k}=f,L=e.eql(e.mul(m,k),e.mul(T,B)),R=e.eql(e.mul(I,k),e.mul(U,B));return L&&R}negate(){return new y(this.px,e.neg(this.py),this.pz)}double(){let{a:f,b:m}=t,I=e.mul(m,Ao),{px:B,py:T,pz:U}=this,k=e.ZERO,L=e.ZERO,R=e.ZERO,_=e.mul(B,B),tt=e.mul(T,T),w=e.mul(U,U),x=e.mul(B,T);return x=e.add(x,x),R=e.mul(B,U),R=e.add(R,R),k=e.mul(f,R),L=e.mul(I,w),L=e.add(k,L),k=e.sub(tt,L),L=e.add(tt,L),L=e.mul(k,L),k=e.mul(x,k),R=e.mul(I,R),w=e.mul(f,w),x=e.sub(_,w),x=e.mul(f,x),x=e.add(x,R),R=e.add(_,_),_=e.add(R,_),_=e.add(_,w),_=e.mul(_,x),L=e.add(L,_),w=e.mul(T,U),w=e.add(w,w),_=e.mul(w,x),k=e.sub(k,_),R=e.mul(w,tt),R=e.add(R,R),R=e.add(R,R),new y(k,L,R)}add(f){b(f);let{px:m,py:I,pz:B}=this,{px:T,py:U,pz:k}=f,L=e.ZERO,R=e.ZERO,_=e.ZERO,tt=t.a,w=e.mul(t.b,Ao),x=e.mul(m,T),P=e.mul(I,U),g=e.mul(B,k),h=e.add(m,I),p=e.add(T,U);h=e.mul(h,p),p=e.add(x,P),h=e.sub(h,p),p=e.add(m,B);let E=e.add(T,k);return p=e.mul(p,E),E=e.add(x,g),p=e.sub(p,E),E=e.add(I,B),L=e.add(U,k),E=e.mul(E,L),L=e.add(P,g),E=e.sub(E,L),_=e.mul(tt,p),L=e.mul(w,g),_=e.add(L,_),L=e.sub(P,_),_=e.add(P,_),R=e.mul(L,_),P=e.add(x,x),P=e.add(P,x),g=e.mul(tt,g),p=e.mul(w,p),P=e.add(P,g),g=e.sub(x,g),g=e.mul(tt,g),p=e.add(p,g),x=e.mul(P,p),R=e.add(R,x),x=e.mul(E,p),L=e.mul(h,L),L=e.sub(L,x),x=e.mul(h,P),_=e.mul(E,_),_=e.add(_,x),new y(L,R,_)}subtract(f){return this.add(f.negate())}is0(){return this.equals(y.ZERO)}wNAF(f){return z.wNAFCached(this,f,y.normalizeZ)}multiplyUnsafe(f){let{endo:m,n:I}=t;vt("scalar",f,$t,I);let B=y.ZERO;if(f===$t)return B;if(this.is0()||f===at)return this;if(!m||z.hasPrecomputes(this))return z.wNAFCachedUnsafe(this,f,y.normalizeZ);let{k1neg:T,k1:U,k2neg:k,k2:L}=m.splitScalar(f),R=B,_=B,tt=this;for(;U>$t||L>$t;)U&at&&(R=R.add(tt)),L&at&&(_=_.add(tt)),tt=tt.double(),U>>=at,L>>=at;return T&&(R=R.negate()),k&&(_=_.negate()),_=new y(e.mul(_.px,m.beta),_.py,_.pz),R.add(_)}multiply(f){let{endo:m,n:I}=t;vt("scalar",f,at,I);let B,T;if(m){let{k1neg:U,k1:k,k2neg:L,k2:R}=m.splitScalar(f),{p:_,f:tt}=this.wNAF(k),{p:w,f:x}=this.wNAF(R);_=z.constTimeNegate(U,_),w=z.constTimeNegate(L,w),w=new y(e.mul(w.px,m.beta),w.py,w.pz),B=_.add(w),T=tt.add(x)}else{let{p:U,f:k}=this.wNAF(f);B=U,T=k}return y.normalizeZ([B,T])[0]}multiplyAndAddUnsafe(f,m,I){let B=y.BASE,T=(k,L)=>L===$t||L===at||!k.equals(B)?k.multiplyUnsafe(L):k.multiply(L),U=T(this,m).add(T(f,I));return U.is0()?void 0:U}toAffine(f){return v(this,f)}isTorsionFree(){let{h:f,isTorsionFree:m}=t;if(f===at)return!0;if(m)return m(y,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:f,clearCofactor:m}=t;return f===at?this:m?m(y,this):this.multiplyUnsafe(t.h)}toRawBytes(f=!0){return Ut("isCompressed",f),this.assertValidity(),o(y,this,f)}toHex(f=!0){return Ut("isCompressed",f),ne(this.toRawBytes(f))}}y.BASE=new y(t.Gx,t.Gy,e.ONE),y.ZERO=new y(e.ZERO,e.ONE,e.ZERO);let{endo:D,nBitLength:K}=t,z=Er(y,D?Math.ceil(K/2):K);return{CURVE:t,ProjectivePoint:y,normPrivateKeyToScalar:d,weierstrassEquation:i,isWithinCurveOrder:u}}function Au(r){let t=Je(r);return zt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function xi(r){let t=Au(r),{Fp:e,n,nByteLength:o,nBitLength:s}=t,i=e.BYTES+1,a=2*e.BYTES+1;function c(w){return G(w,n)}function l(w){return wr(w,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:b,isWithinCurveOrder:v}=Eu({...t,toBytes(w,x,P){let g=x.toAffine(),h=e.toBytes(g.x),p=oe;return Ut("isCompressed",P),P?p(Uint8Array.from([x.hasEvenY()?2:3]),h):p(Uint8Array.from([4]),h,e.toBytes(g.y))},fromBytes(w){let x=w.length,P=w[0],g=w.subarray(1);if(x===i&&(P===2||P===3)){let h=Vt(g);if(!xr(h,at,e.ORDER))throw new Error("Point is not on curve");let p=b(h),E;try{E=e.sqrt(p)}catch(M){let q=M instanceof Error?": "+M.message:"";throw new Error("Point is not on curve"+q)}let C=(E&at)===at;return(P&1)===1!==C&&(E=e.neg(E)),{x:h,y:E}}else if(x===a&&P===4){let h=e.fromBytes(g.subarray(0,e.BYTES)),p=e.fromBytes(g.subarray(e.BYTES,2*e.BYTES));return{x:h,y:p}}else{let h=i,p=a;throw new Error("invalid Point, expected length of "+h+", or uncompressed "+p+", got "+x)}}});function S(w){let x=n>>at;return w>x}function y(w){return S(w)?c(-w):w}let D=(w,x,P)=>Vt(w.slice(x,P));class K{constructor(x,P,g){vt("r",x,at,n),vt("s",P,at,n),this.r=x,this.s=P,g!=null&&(this.recovery=g),Object.freeze(this)}static fromCompact(x){let P=o;return x=$("compactSignature",x,P*2),new K(D(x,0,P),D(x,P,2*P))}static fromDER(x){let{r:P,s:g}=Yt.toSig($("DER",x));return new K(P,g)}assertValidity(){}addRecoveryBit(x){return new K(this.r,this.s,x)}recoverPublicKey(x){let{r:P,s:g,recovery:h}=this,p=B($("msgHash",x));if(h==null||![0,1,2,3].includes(h))throw new Error("recovery id invalid");let E=h===2||h===3?P+t.n:P;if(E>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let C=(h&1)===0?"02":"03",N=u.fromHex(C+Eo(E,e.BYTES)),M=l(E),q=c(-p*M),H=c(g*M),F=u.BASE.multiplyAndAddUnsafe(N,q,H);if(!F)throw new Error("point at infinify");return F.assertValidity(),F}hasHighS(){return S(this.s)}normalizeS(){return this.hasHighS()?new K(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Xe(this.toDERHex())}toDERHex(){return Yt.hexFromSig(this)}toCompactRawBytes(){return Xe(this.toCompactHex())}toCompactHex(){let x=o;return Eo(this.r,x)+Eo(this.s,x)}}let z={isValidPrivateKey(w){try{return d(w),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{let w=Kn(t.n);return Vs(t.randomBytes(w),t.n)},precompute(w=8,x=u.BASE){return x._setWindowSize(w),x.multiply(BigInt(3)),x}};function A(w,x=!0){return u.fromPrivateKey(w).toRawBytes(x)}function f(w){if(typeof w=="bigint")return!1;if(w instanceof u)return!0;let P=$("key",w).length,g=e.BYTES,h=g+1,p=2*g+1;if(!(t.allowedPrivateKeyLengths||o===h))return P===h||P===p}function m(w,x,P=!0){if(f(w)===!0)throw new Error("first arg must be private key");if(f(x)===!1)throw new Error("second arg must be public key");return u.fromHex(x).multiply(d(w)).toRawBytes(P)}let I=t.bits2int||function(w){if(w.length>8192)throw new Error("input is too large");let x=Vt(w),P=w.length*8-s;return P>0?x>>BigInt(P):x},B=t.bits2int_modN||function(w){return c(I(w))},T=pe(s);function U(w){return vt("num < 2^"+s,w,$t,T),de(w,o)}function k(w,x,P=L){if(["recovered","canonical"].some(J=>J in P))throw new Error("sign() legacy options not supported");let{hash:g,randomBytes:h}=t,{lowS:p,prehash:E,extraEntropy:C}=P;p==null&&(p=!0),w=$("msgHash",w),bi(P),E&&(w=$("prehashed msgHash",g(w)));let N=B(w),M=d(x),q=[U(M),U(N)];if(C!=null&&C!==!1){let J=C===!0?h(e.BYTES):C;q.push($("extraEntropy",J))}let H=oe(...q),F=N;function et(J){let ct=I(J);if(!v(ct))return;let gt=l(ct),ot=u.BASE.multiply(ct).toAffine(),lt=c(ot.x);if(lt===$t)return;let At=c(gt*c(F+lt*M));if(At===$t)return;let Bt=(ot.x===lt?0:2)|Number(ot.y&at),ke=At;return p&&S(At)&&(ke=y(At),Bt^=1),new K(lt,ke,Bt)}return{seed:H,k2sig:et}}let L={lowS:t.lowS,prehash:!1},R={lowS:t.lowS,prehash:!1};function _(w,x,P=L){let{seed:g,k2sig:h}=k(w,x,P),p=t;return Ks(p.hash.outputLen,p.nByteLength,p.hmac)(g,h)}u.BASE._setWindowSize(8);function tt(w,x,P,g=R){let h=w;x=$("msgHash",x),P=$("publicKey",P);let{lowS:p,prehash:E,format:C}=g;if(bi(g),"strict"in g)throw new Error("options.strict was renamed to lowS");if(C!==void 0&&C!=="compact"&&C!=="der")throw new Error("format must be compact or der");let N=typeof h=="string"||Pe(h),M=!N&&!C&&typeof h=="object"&&h!==null&&typeof h.r=="bigint"&&typeof h.s=="bigint";if(!N&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let q,H;try{if(M&&(q=new K(h.r,h.s)),N){try{C!=="compact"&&(q=K.fromDER(h))}catch(Bt){if(!(Bt instanceof Yt.Err))throw Bt}!q&&C!=="der"&&(q=K.fromCompact(h))}H=u.fromHex(P)}catch{return!1}if(!q||p&&q.hasHighS())return!1;E&&(x=t.hash(x));let{r:F,s:et}=q,J=B(x),ct=l(et),gt=c(J*ct),ot=c(F*ct),lt=u.BASE.multiplyAndAddUnsafe(H,gt,ot)?.toAffine();return lt?c(lt.x)===F:!1}return{CURVE:t,getPublicKey:A,getSharedSecret:m,sign:_,verify:tt,ProjectivePoint:u,Signature:K,utils:z}}function Su(r){return{hash:r,hmac:(t,...e)=>wo(r,t,An(...e)),randomBytes:mr}}function wi(r,t){let e=n=>xi({...r,...Su(n)});return{...e(t),create:e}}var Si=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ei=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),vu=BigInt(0),Iu=BigInt(1),vo=BigInt(2),Ai=(r,t)=>(r+t/vo)/t;function Bu(r){let t=Si,e=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),c=BigInt(88),l=r*r*r%t,u=l*l*r%t,d=W(u,e,t)*u%t,b=W(d,e,t)*u%t,v=W(b,vo,t)*l%t,S=W(v,o,t)*v%t,y=W(S,s,t)*S%t,D=W(y,a,t)*y%t,K=W(D,c,t)*D%t,z=W(K,a,t)*y%t,A=W(z,e,t)*u%t,f=W(A,i,t)*S%t,m=W(f,n,t)*l%t,I=W(m,vo,t);if(!Io.eql(Io.sqr(I),r))throw new Error("Cannot find square root");return I}var Io=Ft(Si,void 0,void 0,{sqrt:Bu}),Ke=wi({a:vu,b:BigInt(7),Fp:Io,n:Ei,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{let t=Ei,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Iu*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,i=BigInt("0x100000000000000000000000000000000"),a=Ai(s*r,t),c=Ai(-n*r,t),l=G(r-a*e-c*o,t),u=G(-a*n-c*s,t),d=l>i,b=u>i;if(d&&(l=t-l),b&&(u=t-u),l>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:d,k1:l,k2neg:b,k2:u}}}},br);function vi(r){return r==null?!1:typeof r.then=="function"&&typeof r.catch=="function"&&typeof r.finally=="function"}function Ii(r,t,e){let n=Ve.digest(e instanceof Uint8Array?e:e.subarray());if(vi(n))return n.then(({digest:o})=>Ke.verify(t,o,r)).catch(o=>{throw new er(String(o))});try{return Ke.verify(t,n.digest,r)}catch(o){throw new er(String(o))}}var Ur=class{type="secp256k1";raw;_key;constructor(t){this._key=Ti(t),this.raw=Bi(this._key)}toMultihash(){return Pt.digest(Qt(this))}toCID(){return rt.createV1(114,this.toMultihash())}toString(){return Y.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:st(this.raw,t.raw)}verify(t,e){return Ii(this._key,e,t)}};function Bo(r){return new Ur(r)}function Bi(r){return Ke.ProjectivePoint.fromHex(r).toRawBytes(!0)}function Ti(r){try{return Ke.ProjectivePoint.fromHex(r),r}catch(t){throw new xe(String(t))}}function Pi(r,t){let{Type:e,Data:n}=Rt.decode(r),o=n??new Uint8Array;switch(e){case Q.RSA:return go(o,t);case Q.Ed25519:return Vn(o);case Q.secp256k1:return Bo(o);case Q.ECDSA:return En(o);default:throw new we}}function Li(r){let{Type:t,Data:e}=Rt.decode(r.digest),n=e??new Uint8Array;switch(t){case Q.Ed25519:return Vn(n);case Q.secp256k1:return Bo(n);case Q.ECDSA:return En(n);default:throw new we}}function Qt(r){return Rt.encode({Type:Q[r.type],Data:r.raw})}var or;(function(r){let t;r.codec=()=>(t==null&&(t=Zt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.publicKey!=null&&e.publicKey.byteLength>0&&(n.uint32(10),n.bytes(e.publicKey)),e.payloadType!=null&&e.payloadType.byteLength>0&&(n.uint32(18),n.bytes(e.payloadType)),e.payload!=null&&e.payload.byteLength>0&&(n.uint32(26),n.bytes(e.payload)),e.signature!=null&&e.signature.byteLength>0&&(n.uint32(42),n.bytes(e.signature)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={publicKey:ut(0),payloadType:ut(0),payload:ut(0),signature:ut(0)},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.publicKey=e.bytes();break}case 2:{s.payloadType=e.bytes();break}case 3:{s.payload=e.bytes();break}case 5:{s.signature=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>jt(e,r.codec()),r.decode=(e,n)=>Gt(e,r.codec(),n)})(or||(or={}));var Dr=class extends Error{constructor(t="Invalid signature"){super(t),this.name="InvalidSignatureError"}};var Kr=class r{static createFromProtobuf=async t=>{let e=or.decode(t),n=Pi(e.publicKey);return new r({publicKey:n,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};static seal=async(t,e)=>{if(e==null)throw new Error("Missing private key");let n=t.domain,o=t.codec,s=t.marshal(),i=Ci(n,o,s),a=await e.sign(i.subarray());return new r({publicKey:e.publicKey,payloadType:o,payload:s,signature:a})};static openAndCertify=async(t,e)=>{let n=await r.createFromProtobuf(t);if(!await n.validate(e))throw new Dr("Envelope signature is not valid for the given domain");return n};publicKey;payloadType;payload;signature;marshaled;constructor(t){let{publicKey:e,payloadType:n,payload:o,signature:s}=t;this.publicKey=e,this.payloadType=n,this.payload=o,this.signature=s}marshal(){return this.marshaled==null&&(this.marshaled=or.encode({publicKey:Qt(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return t==null?!1:st(this.marshal(),t.marshal())}async validate(t){let e=Ci(t,this.payloadType,this.payload);return this.publicKey.verify(e.subarray(),this.signature)}},Ci=(r,t,e)=>{let n=j(r),o=Kt(n.byteLength),s=Kt(t.length),i=Kt(e.length);return new pt(o,n,s,t,i,e)};var _i=Symbol.for("nodejs.util.inspect.custom"),Tu=114,sr=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Zr]=!0;toString(){return this.string==null&&(this.string=Y.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return rt.createV1(Tu,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return st(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return st(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[_i](){return`PeerId(${this.toString()})`}},Rr=class extends sr{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Nr=class extends sr{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},kr=class extends sr{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},Pu=2336,Or=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=Pt.digest(j(this.url))}[_i](){return`PeerId(${this.url})`}[Zr]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return rt.createV1(Pu,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=O(t)),t.toString()===this.toString())}};function Ui(r){if(Cu(r))return new Rr({multihash:r});if(Lu(r))try{let t=Li(r);if(t.type==="Ed25519")return new Nr({multihash:r,publicKey:t});if(t.type==="secp256k1")return new kr({multihash:r,publicKey:t})}catch{let e=O(r.digest);return new Or(new URL(e))}throw new cr("Supplied PeerID Multihash is invalid")}function Lu(r){return r.code===Pt.code}function Cu(r){return r.code===Ve.code}function Di(r,t){let e=(n,o)=>n.toString().localeCompare(o.toString());return r.length!==t.length?!1:(t.sort(e),r.sort(e).every((n,o)=>t[o].equals(n)))}var Mr=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let e=this.index,n=t();return n===void 0&&(this.index=e),n}parseWith(t){let e=t();if(this.index===this.input.length)return e}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let e=this.readChar();if(e===t)return e})}readSeparator(t,e,n){return this.readAtomically(()=>{if(!(e>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,e,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",l=2**(8*o)-1;for(;;){let u=this.readAtomically(()=>{let d=this.readChar();if(d===void 0)return;let b=Number.parseInt(d,t);if(!Number.isNaN(b))return b});if(u===void 0)break;if(s*=t,s+=u,s>l||(i+=1,e!==void 0&&i>e))return}if(i!==0)return!n&&c&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let e=0;e<t.length;e++){let n=this.readSeparator(".",e,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[e]=n}return t})}readIPv6Addr(){let t=e=>{for(let n=0;n<e.length/2;n++){let o=n*2;if(n<e.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2],e[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];e[o]=s>>8,e[o+1]=s&255}return[e.length,!1]};return this.readAtomically(()=>{let e=new Uint8Array(16),[n,o]=t(e);if(n===16)return e;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=t(s.subarray(0,i));return e.set(s.subarray(0,a),16-a),e})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var Ki=45,_u=15,Re=new Mr;function To(r){if(!(r.length>_u))return Re.new(r).parseWith(()=>Re.readIPv4Addr())}function Po(r){if(r.includes("%")&&(r=r.split("%")[0]),!(r.length>Ki))return Re.new(r).parseWith(()=>Re.readIPv6Addr())}function qr(r,t=!1){if(r.includes("%")&&(r=r.split("%")[0]),r.length>Ki)return;let e=Re.new(r).parseWith(()=>Re.readIPAddr());if(e)return t&&e.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,e[0],e[1],e[2],e[3]]):e}var f0=parseInt("0xFFFF",16),l0=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function ki(r){return!!To(r)}function Oi(r){return!!Po(r)}function Hr(r){return!!qr(r)}var Mi=ki,Nu=Oi,Lo=function(r){let t=0;if(r=r.toString().trim(),Mi(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if(Nu(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let s=Mi(e[n]),i;s&&(i=Lo(e[n]),e[n]=O(i.slice(0,2),"base16")),i!=null&&++n<8&&e.splice(n,0,O(i.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let s=[n,1];for(n=9-e.length;n>0;n--)s.push("0");e.splice.apply(e,s)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let s=parseInt(e[n],16);o[t++]=s>>8&255,o[t++]=s&255}return o}throw new Error("invalid ip address")},qi=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let s=0;s<e;s++)o.push(r[t+s]);return o.join(".")}if(e===16){let o=[];for(let s=0;s<e;s+=2)o.push(n.getUint16(t+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ne={},Co={},Ou=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,-1,"http-path"],[777,-1,"memory"]];Ou.forEach(r=>{let t=Mu(...r);Co[t.code]=t,Ne[t.name]=t});function Mu(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function Z(r){if(typeof r=="number"){if(Co[r]!=null)return Co[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Ne[r]!=null)return Ne[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var Y0=Z("ip4"),$0=Z("ip6"),W0=Z("ipcidr");function Ko(r,t){switch(Z(r).code){case 4:case 41:return Hu(t);case 42:return Do(t);case 43:return O(t,"base10");case 6:case 273:case 33:case 132:return zi(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Do(t);case 421:return Gu(t);case 444:return Vi(t);case 445:return Vi(t);case 466:return Fu(t);case 481:return globalThis.encodeURIComponent(Do(t));default:return O(t,"base16")}}function Ro(r,t){switch(Z(r).code){case 4:return Hi(t);case 41:return Hi(t);case 42:return Uo(t);case 43:return j(t,"base10");case 6:case 273:case 33:case 132:return No(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Uo(t);case 421:return Vu(t);case 444:return ju(t);case 445:return Zu(t);case 466:return zu(t);case 481:return Uo(globalThis.decodeURIComponent(t));default:return j(t,"base16")}}var _o=Object.values(ze).map(r=>r.decoder),qu=function(){let r=_o[0].or(_o[1]);return _o.slice(2).forEach(t=>r=r.or(t)),r}();function Hi(r){if(!Hr(r))throw new Error("invalid ip address");return Lo(r)}function Hu(r){let t=qi(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!Hr(t))throw new Error("invalid ip address");return t}function No(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function zi(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function Uo(r){let t=j(r),e=Uint8Array.from(Kt(t.length));return St([e,t],e.length+t.length)}function Do(r){let t=ye(r);if(r=r.slice(Et(t)),r.length!==t)throw new Error("inconsistent lengths");return O(r)}function Vu(r){let t;r[0]==="Q"||r[0]==="1"?t=ae(Y.decode(`z${r}`)).bytes:t=rt.parse(r).multihash.bytes;let e=Uint8Array.from(Kt(t.length));return St([e,t],e.length+t.length)}function zu(r){let t=qu.decode(r),e=Uint8Array.from(Kt(t.length));return St([e,t],e.length+t.length)}function Fu(r){let t=ye(r),e=r.slice(Et(t));if(e.length!==t)throw new Error("inconsistent lengths");return"u"+O(e,"base64url")}function Gu(r){let t=ye(r),e=r.slice(Et(t));if(e.length!==t)throw new Error("inconsistent lengths");return O(e,"base58btc")}function ju(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=kt.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=No(n);return St([e,o],e.length+o.length)}function Zu(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=kt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=No(n);return St([e,o],e.length+o.length)}function Vi(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=O(t,"base32"),o=zi(e);return`${n}:${o}`}function Fi(r){r=ko(r);let t=[],e=[],n=null,o=r.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=Z(i);if(a.size===0){t.push([a.code]),e.push([a.code]);continue}if(s++,s>=o.length)throw new Vr("invalid address: "+r);if(a.path===!0){n=ko(o.slice(s).join("/")),t.push([a.code,Ro(a.code,n)]),e.push([a.code,n]);break}let c=Ro(a.code,o[s]);t.push([a.code,c]),e.push([a.code,Ko(a.code,c)])}return{string:Gi(e),bytes:zr(t),tuples:t,stringTuples:e,path:n}}function Oo(r){let t=[],e=[],n=null,o=0;for(;o<r.length;){let s=ye(r,o),i=Et(s),a=Z(s),c=Yu(a,r.slice(o+i));if(c===0){t.push([s]),e.push([s]),o+=i;continue}let l=r.slice(o+i,o+i+c);if(o+=c+i,o>r.length)throw new Vr("Invalid address Uint8Array: "+O(r,"base16"));t.push([s,l]);let u=Ko(s,l);if(e.push([s,u]),a.path===!0){n=u;break}}return{bytes:Uint8Array.from(r),string:Gi(e),tuples:t,stringTuples:e,path:n}}function Gi(r){let t=[];return r.map(e=>{let n=Z(e[0]);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),ko(t.join("/"))}function zr(r){return St(r.map(t=>{let e=Z(t[0]),n=Uint8Array.from(Kt(e.code));return t.length>1&&t[1]!=null&&(n=St([n,t[1]])),n}))}function Yu(r,t){if(r.size>0)return r.size/8;if(r.size===0)return 0;{let e=ye(t instanceof Uint8Array?t:Uint8Array.from(t));return e+Et(e)}}function ko(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}var Vr=class extends Error{static name="ParseError";name="ParseError";constructor(t){super(`Error parsing address: ${t}`)}};var $u=Symbol.for("nodejs.util.inspect.custom"),qo=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Wu=[Z("dns").code,Z("dns4").code,Z("dns6").code,Z("dnsaddr").code],Mo=class extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}},Fr=class r{bytes;#e;#t;#r;#n;[qo]=!0;constructor(t){t==null&&(t="");let e;if(t instanceof Uint8Array)e=Oo(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);e=Fi(t)}else if(Zi(t))e=Oo(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=e.bytes,this.#e=e.string,this.#t=e.tuples,this.#r=e.stringTuples,this.#n=e.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let t,e,n,o,s="",i=Z("tcp"),a=Z("udp"),c=Z("ip4"),l=Z("ip6"),u=Z("dns6"),d=Z("ip6zone");for(let[v,S]of this.stringTuples())v===d.code&&(s=`%${S??""}`),Wu.includes(v)&&(e=i.name==="tcp"?"tcp":"udp",o=443,n=`${S??""}${s}`,t=v===u.code?6:4),(v===i.code||v===a.code)&&(e=Z(v).name==="tcp"?"tcp":"udp",o=parseInt(S??"")),(v===c.code||v===l.code)&&(e=Z(v).name==="tcp"?"tcp":"udp",n=`${S??""}${s}`,t=v===l.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.#t.map(([t])=>Object.assign({},Z(t)))}protoCodes(){return this.#t.map(([t])=>t)}protoNames(){return this.#t.map(([t])=>Z(t).name)}tuples(){return this.#t.map(([t,e])=>e==null?[t]:[t,e])}stringTuples(){return this.#r.map(([t,e])=>e==null?[t]:[t,e])}encapsulate(t){return t=new r(t),new r(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new r(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new r(zr(e.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,o])=>{n===Ne.p2p.code&&t.push([n,o]),n===Ne["p2p-circuit"].code&&(t=[])});let e=t.pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?O(Y.decode(`z${n}`),"base58btc"):O(rt.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(t){return st(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(s=>s.resolvable);if(e==null)return[this];let n=ji.get(e.name);if(n==null)throw new Mo(`no available resolver for ${e.name}`);return(await n(this,t)).map(s=>ir(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[$u](){return`Multiaddr(${this.#e})`}};var ji=new Map;function Zi(r){return!!r?.[qo]}function ir(r){return new Fr(r)}var Yi="libp2p-peer-record",$i=Uint8Array.from([3,1]);var ar;(function(r){let t;(function(n){let o;n.codec=()=>(o==null&&(o=Zt((s,i,a={})=>{a.lengthDelimited!==!1&&i.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(i.uint32(10),i.bytes(s.multiaddr)),a.lengthDelimited!==!1&&i.ldelim()},(s,i,a={})=>{let c={multiaddr:ut(0)},l=i==null?s.len:s.pos+i;for(;s.pos<l;){let u=s.uint32();switch(u>>>3){case 1:{c.multiaddr=s.bytes();break}default:{s.skipType(u&7);break}}}return c})),o),n.encode=s=>jt(s,n.codec()),n.decode=(s,i)=>Gt(s,n.codec(),i)})(t=r.AddressInfo||(r.AddressInfo={}));let e;r.codec=()=>(e==null&&(e=Zt((n,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(o.uint32(10),o.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(o.uint32(16),o.uint64(n.seq)),n.addresses!=null)for(let i of n.addresses)o.uint32(26),r.AddressInfo.codec().encode(i,o);s.lengthDelimited!==!1&&o.ldelim()},(n,o,s={})=>{let i={peerId:ut(0),seq:0n,addresses:[]},a=o==null?n.len:n.pos+o;for(;n.pos<a;){let c=n.uint32();switch(c>>>3){case 1:{i.peerId=n.bytes();break}case 2:{i.seq=n.uint64();break}case 3:{if(s.limits?.addresses!=null&&i.addresses.length===s.limits.addresses)throw new Pr('Decode error - map field "addresses" had too many elements');i.addresses.push(r.AddressInfo.codec().decode(n,n.uint32(),{limits:s.limits?.addresses$}));break}default:{n.skipType(c&7);break}}}return i})),e),r.encode=n=>jt(n,r.codec()),r.decode=(n,o)=>Gt(n,r.codec(),o)})(ar||(ar={}));var Gr=class r{static createFromProtobuf=t=>{let e=ar.decode(t),n=Ui(ae(e.peerId)),o=(e.addresses??[]).map(i=>ir(i.multiaddr)),s=e.seq;return new r({peerId:n,multiaddrs:o,seqNumber:s})};static DOMAIN=Yi;static CODEC=$i;peerId;multiaddrs;seqNumber;domain=r.DOMAIN;codec=r.CODEC;marshaled;constructor(t){let{peerId:e,multiaddrs:n,seqNumber:o}=t;this.peerId=e,this.multiaddrs=n??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=ar.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof r)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!Di(this.multiaddrs,t.multiaddrs))}};return oa(Xu);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
@noble/curves/esm/abstract/modular.js:
@noble/curves/esm/abstract/curve.js:
@noble/curves/esm/abstract/edwards.js:
@noble/curves/esm/ed25519.js:
@noble/curves/esm/abstract/weierstrass.js:
@noble/curves/esm/_shortw_utils.js:
@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
//# sourceMappingURL=index.min.js.map
