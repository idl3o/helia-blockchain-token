(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Ipns = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Ipns=(()=>{var fc=Object.create;var Br=Object.defineProperty;var lc=Object.getOwnPropertyDescriptor;var dc=Object.getOwnPropertyNames;var hc=Object.getPrototypeOf,pc=Object.prototype.hasOwnProperty;var mc=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ht=(e,t)=>{for(var r in t)Br(e,r,{get:t[r],enumerable:!0})},Qo=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of dc(t))!pc.call(e,o)&&o!==r&&Br(e,o,{get:()=>t[o],enumerable:!(n=lc(t,o))||n.enumerable});return e};var yc=(e,t,r)=>(r=e!=null?fc(hc(e)):{},Qo(t||!e||!e.__esModule?Br(r,"default",{value:e,enumerable:!0}):r,e)),gc=e=>Qo(Br({},"__esModule",{value:!0}),e);var Fs=mc((Om,Ro)=>{var Fm=function(){typeof Ro<"u"&&(Ro.exports=g);var e=86400,t=3200,r=146097*t/400,n=e*r,o=1e3*n,i=864e13,s=4294967296,a=1e6,u="000000000",d=Math.trunc||function(b){var w=b-b%1;return w==0&&(b<0||b===0&&1/b!=1/0)?-0:w},c=g.prototype,f=(g.fromDate=function(b){return new g(+b)},g.fromInt64BE=L(0,1,2,3,0,4),g.fromInt64LE=L(3,2,1,0,4,0),g.fromString=function(R){var w,O=new g,R=(R+="").replace(/^\s*[+\-]?\d+/,function(P){var P=+P,B=1970+(P-1970)%400;return O.year=P-B,B}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(U,P,B){return P<0&&(B*=-1),w=6e4*(60*+P+ +B),""}).replace(/\.\d+$/,function(U){return O.nano=+(U+u).substr(1,9),""}).split(/\D+/);if(1<R.length?R[1]--:R[1]=0,O.time=w=Date.UTC.apply(Date,R)-(w||0),isNaN(w))throw new TypeError("Invalid Date");return l(O)},g.fromTimeT=function(b){return I(b,0)},c.year=0,c.time=0,c.nano=0,c.addNano=function(b){return this.nano+=+b||0,this},c.getNano=function(){var b=l(this);return(b.time%1e3*a+ +b.nano+1e9)%1e9},c.getTimeT=function(){var w=l(this),b=Math.floor(w.time/1e3),w=w.year;return w&&(b+=w*r*e/t),b},c.getYear=function(){return this.toDate().getUTCFullYear()+this.year},c.toDate=function(){return S(l(this).time)},c.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},c.toString=function(b){var w=this,O=w.toDate(),R={H:function(){return D(O.getUTCHours())},L:function(){return N(O.getUTCMilliseconds(),3)},M:function(){return D(O.getUTCMinutes())},N:function(){return N(w.getNano(),9)},S:function(){return D(O.getUTCSeconds())},Y:function(){var U=w.getYear();return 999999<U?"+"+U:9999<U?"+"+N(U,6):0<=U?N(U,4):-999999<=U?"-"+N(-U,6):U},a:function(){return T[O.getUTCDay()]},b:function(){return h[O.getUTCMonth()]},d:function(){return D(O.getUTCDate())},e:function(){return function(U){return(9<U?"":" ")+(0|U)}(O.getUTCDate())},m:function(){return D(O.getUTCMonth()+1)}};return function U(P){return P.replace(/%./g,function(B){var y=B[1],A=v[y],y=R[y];return A?U(A):y?y():B})}(b||f)},c.writeInt64BE=x(0,1,2,3,0,4),c.writeInt64LE=x(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],v={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return g;function g(b,w,O){var R=this;if(!(R instanceof g))return new g(b,w,O);R.time=+b||0,R.nano=+w||0,R.year=+O||0,l(R)}function l(b){var w,O,R,U=b.year,P=b.time,B=b.nano,A=((B<0||a<=B)&&(B-=(O=Math.floor(B/a))*a,P+=O,O=1),U%t);return(P<-i||i<P||A)&&((w=d(P/o))&&(U+=w*t,P-=w*o),(R=S(P)).setUTCFullYear(A+R.getUTCFullYear()),R=(P=+R)+(w=d((U-=A)/t))*o,w&&-i<=R&&R<=i&&(U-=w*t,P=R),O=1),O&&(b.year=U,b.time=P,b.nano=B),b}function S(b){var w=new Date(0);return w.setTime(b),w}function I(U,R){U=+U||0;var O=d((R=(R|0)*s)/n)+d(U/n),R=R%n+U%n,U=d(R/n);return U&&(O+=U,R-=U*n),new g(1e3*R,0,O*t)}function x(b,w,O,R,U,P){return function(A,y){var E=l(this);A=A||new Array(8),F(A,y|=0);var _=Math.floor(E.time/1e3),E=E.year*(r*e/t),p=d(E/s)+d(_/s),E=E%s+_%s,_=Math.floor(E/s);return _&&(p+=_,E-=_*s),B(A,y+U,p),B(A,y+P,E),A};function B(A,y,p){A[y+b]=p>>24&255,A[y+w]=p>>16&255,A[y+O]=p>>8&255,A[y+R]=255&p}}function L(b,w,O,R,U,P){return function(A,y){F(A,y|=0);var p=B(A,y+U);return I(B(A,y+P),p)};function B(A,y){return 16777216*A[y+b]+(A[y+w]<<16|A[y+O]<<8|A[y+R])}}function F(b,w){if(b=b&&b.length,b==null)throw new TypeError("Invalid Buffer");if(b<w+8)throw new RangeError("Out of range")}function D(b){return(9<b?"":"0")+(0|b)}function N(b,w){return(u+(0|b)).substr(-w)}}()});var fd={};ht(fd,{createIPNSRecord:()=>ad,createIPNSRecordWithExpiration:()=>cd,extractPublicKeyFromIPNSRecord:()=>za,marshalIPNSRecord:()=>Za,multihashFromIPNSRoutingKey:()=>ja,multihashToIPNSRoutingKey:()=>Ya,namespace:()=>tc,namespaceLength:()=>sd,unmarshalIPNSRecord:()=>Wa});var xt=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},Ue=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var Ar=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var vr=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Sn={};ht(Sn,{base58btc:()=>ot,base58flickr:()=>Bc});var hd=new Uint8Array(0);function ti(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function $t(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function ei(e){return new TextEncoder().encode(e)}function ri(e){return new TextDecoder().decode(e)}function xc(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),s=i.charCodeAt(0);if(r[s]!==255)throw new TypeError(i+" is ambiguous");r[s]=o}var a=e.length,u=e.charAt(0),d=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function f(v){if(v instanceof Uint8Array||(ArrayBuffer.isView(v)?v=new Uint8Array(v.buffer,v.byteOffset,v.byteLength):Array.isArray(v)&&(v=Uint8Array.from(v))),!(v instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(v.length===0)return"";for(var g=0,l=0,S=0,I=v.length;S!==I&&v[S]===0;)S++,g++;for(var x=(I-S)*c+1>>>0,L=new Uint8Array(x);S!==I;){for(var F=v[S],D=0,N=x-1;(F!==0||D<l)&&N!==-1;N--,D++)F+=256*L[N]>>>0,L[N]=F%a>>>0,F=F/a>>>0;if(F!==0)throw new Error("Non-zero carry");l=D,S++}for(var b=x-l;b!==x&&L[b]===0;)b++;for(var w=u.repeat(g);b<x;++b)w+=e.charAt(L[b]);return w}function h(v){if(typeof v!="string")throw new TypeError("Expected String");if(v.length===0)return new Uint8Array;var g=0;if(v[g]!==" "){for(var l=0,S=0;v[g]===u;)l++,g++;for(var I=(v.length-g)*d+1>>>0,x=new Uint8Array(I);v[g];){var L=r[v.charCodeAt(g)];if(L===255)return;for(var F=0,D=I-1;(L!==0||F<S)&&D!==-1;D--,F++)L+=a*x[D]>>>0,x[D]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");S=F,g++}if(v[g]!==" "){for(var N=I-S;N!==I&&x[N]===0;)N++;for(var b=new Uint8Array(l+(I-N)),w=l;N!==I;)b[w++]=x[N++];return b}}}function T(v){var g=h(v);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:f,decodeUnsafe:h,decode:T}}var bc=xc,wc=bc,oi=wc;var xn=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},bn=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;let o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ii(this,t)}},wn=class{decoders;constructor(t){this.decoders=t}or(t){return ii(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function ii(e,t){return new wn({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}var En=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new xn(t,r,n),this.decoder=new bn(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function _e({name:e,prefix:t,encode:r,decode:n}){return new En(e,t,r,n)}function re({name:e,prefix:t,alphabet:r}){let{encode:n,decode:o}=oi(r,e);return _e({prefix:t,name:e,encode:n,decode:i=>$t(o(i))})}function Ec(e,t,r,n){let o={};for(let c=0;c<t.length;++c)o[t[c]]=c;let i=e.length;for(;e[i-1]==="=";)--i;let s=new Uint8Array(i*r/8|0),a=0,u=0,d=0;for(let c=0;c<i;++c){let f=o[e[c]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|f,a+=r,a>=8&&(a-=8,s[d++]=255&u>>a)}if(a>=r||(255&u<<8-a)!==0)throw new SyntaxError("Unexpected end of data");return s}function Sc(e,t,r){let n=t[t.length-1]==="=",o=(1<<r)-1,i="",s=0,a=0;for(let u=0;u<e.length;++u)for(a=a<<8|e[u],s+=8;s>r;)s-=r,i+=t[o&a>>s];if(s!==0&&(i+=t[o&a<<r-s]),n)for(;(i.length*r&7)!==0;)i+="=";return i}function tt({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return _e({prefix:t,name:e,encode(o){return Sc(o,n,r)},decode(o){return Ec(o,n,r,e)}})}var ot=re({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Bc=re({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Bn={};ht(Bn,{base32:()=>ne,base32hex:()=>Cc,base32hexpad:()=>Uc,base32hexpadupper:()=>_c,base32hexupper:()=>Ic,base32pad:()=>vc,base32padupper:()=>Tc,base32upper:()=>Ac,base32z:()=>Lc});var ne=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ac=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vc=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Tc=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Cc=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ic=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Uc=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_c=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Lc=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var An={};ht(An,{base36:()=>oe,base36upper:()=>Nc});var oe=re({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Nc=re({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Rc=ci,si=128,kc=127,Dc=~kc,Fc=Math.pow(2,31);function ci(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Fc;)t[r++]=e&255|si,e/=128;for(;e&Dc;)t[r++]=e&255|si,e>>>=7;return t[r]=e|0,ci.bytes=r-n+1,t}var Oc=vn,Kc=128,ai=127;function vn(e,n){var r=0,n=n||0,o=0,i=n,s,a=e.length;do{if(i>=a)throw vn.bytes=0,new RangeError("Could not decode varint");s=e[i++],r+=o<28?(s&ai)<<o:(s&ai)*Math.pow(2,o),o+=7}while(s>=Kc);return vn.bytes=i-n,r}var Vc=Math.pow(2,7),Mc=Math.pow(2,14),Pc=Math.pow(2,21),qc=Math.pow(2,28),Hc=Math.pow(2,35),zc=Math.pow(2,42),$c=Math.pow(2,49),Gc=Math.pow(2,56),Zc=Math.pow(2,63),Wc=function(e){return e<Vc?1:e<Mc?2:e<Pc?3:e<qc?4:e<Hc?5:e<zc?6:e<$c?7:e<Gc?8:e<Zc?9:10},Yc={encode:Rc,decode:Oc,encodingLength:Wc},jc=Yc,tr=jc;function er(e,t=0){return[tr.decode(e,t),tr.decode.bytes]}function Le(e,t,r=0){return tr.encode(e,t,r),t}function Ne(e){return tr.encodingLength(e)}function Rt(e,t){let r=t.byteLength,n=Ne(e),o=n+Ne(r),i=new Uint8Array(o+r);return Le(e,i,0),Le(r,i,n),i.set(t,o),new Re(e,r,t,i)}function Cr(e){let t=$t(e),[r,n]=er(t),[o,i]=er(t.subarray(n)),s=t.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Re(r,o,s,t)}function ui(e,t){if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&ti(e.bytes,r.bytes)}}var Re=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function fi(e,t){let{bytes:r,version:n}=e;switch(n){case 0:return Jc(r,Tn(e),t??ot.encoder);default:return Qc(r,Tn(e),t??ne.encoder)}}var li=new WeakMap;function Tn(e){let t=li.get(e);if(t==null){let r=new Map;return li.set(e,r),r}return t}var pt=class e{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==rr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==tu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Rt(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n!=null&&t.code===n.code&&t.version===n.version&&ui(t.multihash,n.multihash)}toString(t){return fi(this,t)}toJSON(){return{"/":fi(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:i,bytes:s}=r;return new e(n,o,i,s??di(n,o,i.bytes))}else if(r[eu]===!0){let{version:n,multihash:o,code:i}=r,s=Cr(o);return e.create(n,i,s)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==rr)throw new Error(`Version 0 CID must use dag-pb (code: ${rr}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let o=di(t,r,n.bytes);return new e(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,rr,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,o=$t(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=o.subarray(r.multihashSize-r.digestSize),s=new Re(r.multihashCode,r.digestSize,i,o);return[r.version===0?e.createV0(s):e.createV1(r.codec,s),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[f,h]=er(t.subarray(r));return r+=h,f},o=n(),i=rr;if(o===18?(o=0,r=0):i=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let s=r,a=n(),u=n(),d=r+u,c=d-s;return{version:o,codec:i,multihashCode:a,digestSize:u,multihashSize:c,size:d}}static parse(t,r){let[n,o]=Xc(t,r),i=e.decode(o);if(i.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Tn(i).set(n,t),i}};function Xc(e,t){switch(e[0]){case"Q":{let r=t??ot;return[ot.prefix,r.decode(`${ot.prefix}${e}`)]}case ot.prefix:{let r=t??ot;return[ot.prefix,r.decode(e)]}case ne.prefix:{let r=t??ne;return[ne.prefix,r.decode(e)]}case oe.prefix:{let r=t??oe;return[oe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function Jc(e,t,r){let{prefix:n}=r;if(n!==ot.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let i=r.encode(e).slice(1);return t.set(n,i),i}else return o}function Qc(e,t,r){let{prefix:n}=r,o=t.get(n);if(o==null){let i=r.encode(e);return t.set(n,i),i}else return o}var rr=112,tu=18;function di(e,t,r){let n=Ne(e),o=n+Ne(t),i=new Uint8Array(o+r.byteLength);return Le(e,i,0),Le(t,i,n),i.set(r,o),i}var eu=Symbol.for("@ipld/js-cid/CID");var Cn={};ht(Cn,{identity:()=>nr});var hi=0,ru="identity",pi=$t;function nu(e){return Rt(hi,pi(e))}var nr={code:hi,name:ru,encode:pi,digest:nu};function Ut(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function mi(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ou(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function De(e,...t){if(!ou(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function yi(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");mi(e.outputLen),mi(e.blockLen)}function Fe(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function gi(e,t){De(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}var be=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Ir(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function kt(e,t){return e<<32-t|e>>>t}function xi(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function or(e){return typeof e=="string"&&(e=xi(e)),De(e),e}function In(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];De(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let i=e[n];r.set(i,o),o+=i.length}return r}var Oe=class{clone(){return this._cloneInto()}};function Ur(e){let t=n=>e().update(or(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function _r(e=32){if(be&&typeof be.getRandomValues=="function")return be.getRandomValues(new Uint8Array(e));if(be&&typeof be.randomBytes=="function")return be.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function iu(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),a=Number(r&i),u=n?4:0,d=n?0:4;e.setUint32(t+u,s,n),e.setUint32(t+d,a,n)}function bi(e,t,r){return e&t^~e&r}function wi(e,t,r){return e&t^e&r^t&r}var Ke=class extends Oe{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ir(this.buffer)}update(t){Fe(this);let{view:r,buffer:n,blockLen:o}=this;t=or(t);let i=t.length;for(let s=0;s<i;){let a=Math.min(o-this.pos,i-s);if(a===o){let u=Ir(t);for(;o<=i-s;s+=o)this.process(u,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Fe(this),gi(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(n,0),s=0);for(let f=s;f<o;f++)r[f]=0;iu(n,o-8,BigInt(this.length*8),i),this.process(n,0);let a=Ir(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let d=u/4,c=this.get();if(d>c.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<d;f++)a.setUint32(4*f,c[f],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:s,pos:a}=this;return t.length=o,t.pos=a,t.finished=i,t.destroyed=s,o%r&&t.buffer.set(n),t}};var Lr=BigInt(4294967295),Un=BigInt(32);function Ei(e,t=!1){return t?{h:Number(e&Lr),l:Number(e>>Un&Lr)}:{h:Number(e>>Un&Lr)|0,l:Number(e&Lr)|0}}function su(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:i,l:s}=Ei(e[o],t);[r[o],n[o]]=[i,s]}return[r,n]}var au=(e,t)=>BigInt(e>>>0)<<Un|BigInt(t>>>0),cu=(e,t,r)=>e>>>r,uu=(e,t,r)=>e<<32-r|t>>>r,fu=(e,t,r)=>e>>>r|t<<32-r,lu=(e,t,r)=>e<<32-r|t>>>r,du=(e,t,r)=>e<<64-r|t>>>r-32,hu=(e,t,r)=>e>>>r-32|t<<64-r,pu=(e,t)=>t,mu=(e,t)=>e,yu=(e,t,r)=>e<<r|t>>>32-r,gu=(e,t,r)=>t<<r|e>>>32-r,xu=(e,t,r)=>t<<r-32|e>>>64-r,bu=(e,t,r)=>e<<r-32|t>>>64-r;function wu(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}var Eu=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Su=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,Bu=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),Au=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,vu=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),Tu=(e,t,r,n,o,i)=>t+r+n+o+i+(e/2**32|0)|0;var Cu={fromBig:Ei,split:su,toBig:au,shrSH:cu,shrSL:uu,rotrSH:fu,rotrSL:lu,rotrBH:du,rotrBL:hu,rotr32H:pu,rotr32L:mu,rotlSH:yu,rotlSL:gu,rotlBH:xu,rotlBL:bu,add:wu,add3L:Eu,add3H:Su,add4L:Bu,add4H:Au,add5H:Tu,add5L:vu},H=Cu;var[Iu,Uu]=H.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ie=new Uint32Array(80),se=new Uint32Array(80),_n=class extends Ke{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:i,Cl:s,Dh:a,Dl:u,Eh:d,El:c,Fh:f,Fl:h,Gh:T,Gl:v,Hh:g,Hl:l}=this;return[t,r,n,o,i,s,a,u,d,c,f,h,T,v,g,l]}set(t,r,n,o,i,s,a,u,d,c,f,h,T,v,g,l){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=i|0,this.Cl=s|0,this.Dh=a|0,this.Dl=u|0,this.Eh=d|0,this.El=c|0,this.Fh=f|0,this.Fl=h|0,this.Gh=T|0,this.Gl=v|0,this.Hh=g|0,this.Hl=l|0}process(t,r){for(let x=0;x<16;x++,r+=4)ie[x]=t.getUint32(r),se[x]=t.getUint32(r+=4);for(let x=16;x<80;x++){let L=ie[x-15]|0,F=se[x-15]|0,D=H.rotrSH(L,F,1)^H.rotrSH(L,F,8)^H.shrSH(L,F,7),N=H.rotrSL(L,F,1)^H.rotrSL(L,F,8)^H.shrSL(L,F,7),b=ie[x-2]|0,w=se[x-2]|0,O=H.rotrSH(b,w,19)^H.rotrBH(b,w,61)^H.shrSH(b,w,6),R=H.rotrSL(b,w,19)^H.rotrBL(b,w,61)^H.shrSL(b,w,6),U=H.add4L(N,R,se[x-7],se[x-16]),P=H.add4H(U,D,O,ie[x-7],ie[x-16]);ie[x]=P|0,se[x]=U|0}let{Ah:n,Al:o,Bh:i,Bl:s,Ch:a,Cl:u,Dh:d,Dl:c,Eh:f,El:h,Fh:T,Fl:v,Gh:g,Gl:l,Hh:S,Hl:I}=this;for(let x=0;x<80;x++){let L=H.rotrSH(f,h,14)^H.rotrSH(f,h,18)^H.rotrBH(f,h,41),F=H.rotrSL(f,h,14)^H.rotrSL(f,h,18)^H.rotrBL(f,h,41),D=f&T^~f&g,N=h&v^~h&l,b=H.add5L(I,F,N,Uu[x],se[x]),w=H.add5H(b,S,L,D,Iu[x],ie[x]),O=b|0,R=H.rotrSH(n,o,28)^H.rotrBH(n,o,34)^H.rotrBH(n,o,39),U=H.rotrSL(n,o,28)^H.rotrBL(n,o,34)^H.rotrBL(n,o,39),P=n&i^n&a^i&a,B=o&s^o&u^s&u;S=g|0,I=l|0,g=T|0,l=v|0,T=f|0,v=h|0,{h:f,l:h}=H.add(d|0,c|0,w|0,O|0),d=a|0,c=u|0,a=i|0,u=s|0,i=n|0,s=o|0;let A=H.add3L(O,U,B);n=H.add3H(A,w,R,P),o=A|0}({h:n,l:o}=H.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:i,l:s}=H.add(this.Bh|0,this.Bl|0,i|0,s|0),{h:a,l:u}=H.add(this.Ch|0,this.Cl|0,a|0,u|0),{h:d,l:c}=H.add(this.Dh|0,this.Dl|0,d|0,c|0),{h:f,l:h}=H.add(this.Eh|0,this.El|0,f|0,h|0),{h:T,l:v}=H.add(this.Fh|0,this.Fl|0,T|0,v|0),{h:g,l}=H.add(this.Gh|0,this.Gl|0,g|0,l|0),{h:S,l:I}=H.add(this.Hh|0,this.Hl|0,S|0,I|0),this.set(n,o,i,s,a,u,d,c,f,h,T,v,g,l,S,I)}roundClean(){ie.fill(0),se.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Si=Ur(()=>new _n);var kr={};ht(kr,{aInRange:()=>bt,abool:()=>Dt,abytes:()=>Ve,bitGet:()=>Du,bitLen:()=>kn,bitMask:()=>sr,bitSet:()=>Fu,bytesToHex:()=>Zt,bytesToNumberBE:()=>Wt,bytesToNumberLE:()=>ce,concatBytes:()=>Yt,createHmacDrbg:()=>Dn,ensureBytes:()=>Q,equalBytes:()=>Ru,hexToBytes:()=>Ee,hexToNumber:()=>Rn,inRange:()=>ir,isBytes:()=>ae,memoized:()=>Be,notImplemented:()=>Ku,numberToBytesBE:()=>ue,numberToBytesLE:()=>Se,numberToHexUnpadded:()=>we,numberToVarBytesBE:()=>Nu,utf8ToBytes:()=>ku,validateObject:()=>qt});var Nr=BigInt(0),Rr=BigInt(1),_u=BigInt(2);function ae(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ve(e){if(!ae(e))throw new Error("Uint8Array expected")}function Dt(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}var Lu=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Zt(e){Ve(e);let t="";for(let r=0;r<e.length;r++)t+=Lu[e[r]];return t}function we(e){let t=e.toString(16);return t.length&1?"0"+t:t}function Rn(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Nr:BigInt("0x"+e)}var Gt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Bi(e){if(e>=Gt._0&&e<=Gt._9)return e-Gt._0;if(e>=Gt.A&&e<=Gt.F)return e-(Gt.A-10);if(e>=Gt.a&&e<=Gt.f)return e-(Gt.a-10)}function Ee(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,i=0;o<r;o++,i+=2){let s=Bi(e.charCodeAt(i)),a=Bi(e.charCodeAt(i+1));if(s===void 0||a===void 0){let u=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+i)}n[o]=s*16+a}return n}function Wt(e){return Rn(Zt(e))}function ce(e){return Ve(e),Rn(Zt(Uint8Array.from(e).reverse()))}function ue(e,t){return Ee(e.toString(16).padStart(t*2,"0"))}function Se(e,t){return ue(e,t).reverse()}function Nu(e){return Ee(we(e))}function Q(e,t,r){let n;if(typeof t=="string")try{n=Ee(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(ae(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(e+" of length "+r+" expected, got "+o);return n}function Yt(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];Ve(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let i=e[n];r.set(i,o),o+=i.length}return r}function Ru(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}function ku(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}var Ln=e=>typeof e=="bigint"&&Nr<=e;function ir(e,t,r){return Ln(e)&&Ln(t)&&Ln(r)&&t<=e&&e<r}function bt(e,t,r,n){if(!ir(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function kn(e){let t;for(t=0;e>Nr;e>>=Rr,t+=1);return t}function Du(e,t){return e>>BigInt(t)&Rr}function Fu(e,t,r){return e|(r?Rr:Nr)<<BigInt(t)}var sr=e=>(_u<<BigInt(e-1))-Rr,Nn=e=>new Uint8Array(e),Ai=e=>Uint8Array.from(e);function Dn(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Nn(e),o=Nn(e),i=0,s=()=>{n.fill(1),o.fill(0),i=0},a=(...f)=>r(o,n,...f),u=(f=Nn())=>{o=a(Ai([0]),f),n=a(),f.length!==0&&(o=a(Ai([1]),f),n=a())},d=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,h=[];for(;f<t;){n=a();let T=n.slice();h.push(T),f+=n.length}return Yt(...h)};return(f,h)=>{s(),u(f);let T;for(;!(T=h(d()));)u();return s(),T}}var Ou={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||ae(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function qt(e,t,r={}){let n=(o,i,s)=>{let a=Ou[i];if(typeof a!="function")throw new Error("invalid validator function");let u=e[o];if(!(s&&u===void 0)&&!a(u,e))throw new Error("param "+String(o)+" is invalid. Expected "+i+", got "+u)};for(let[o,i]of Object.entries(t))n(o,i,!1);for(let[o,i]of Object.entries(r))n(o,i,!0);return e}var Ku=()=>{throw new Error("not implemented")};function Be(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let i=e(r,...n);return t.set(r,i),i}}var et=BigInt(0),X=BigInt(1),Ae=BigInt(2),Vu=BigInt(3),Fn=BigInt(4),vi=BigInt(5),Ti=BigInt(8),Mu=BigInt(9),Pu=BigInt(16);function W(e,t){let r=e%t;return r>=et?r:t+r}function qu(e,t,r){if(t<et)throw new Error("invalid exponent, negatives unsupported");if(r<=et)throw new Error("invalid modulus");if(r===X)return et;let n=X;for(;t>et;)t&X&&(n=n*e%r),e=e*e%r,t>>=X;return n}function J(e,t,r){let n=e;for(;t-- >et;)n*=n,n%=r;return n}function Dr(e,t){if(e===et)throw new Error("invert: expected non-zero number");if(t<=et)throw new Error("invert: expected positive modulus, got "+t);let r=W(e,t),n=t,o=et,i=X,s=X,a=et;for(;r!==et;){let d=n/r,c=n%r,f=o-s*d,h=i-a*d;n=r,r=c,o=s,i=a,s=f,a=h}if(n!==X)throw new Error("invert: does not exist");return W(o,t)}function Hu(e){let t=(e-X)/Ae,r,n,o;for(r=e-X,n=0;r%Ae===et;r/=Ae,n++);for(o=Ae;o<e&&qu(o,t,e)!==e-X;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){let s=(e+X)/Fn;return function(u,d){let c=u.pow(d,s);if(!u.eql(u.sqr(c),d))throw new Error("Cannot find square root");return c}}let i=(r+X)/Ae;return function(a,u){if(a.pow(u,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let d=n,c=a.pow(a.mul(a.ONE,o),r),f=a.pow(u,i),h=a.pow(u,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let T=1;for(let g=a.sqr(h);T<d&&!a.eql(g,a.ONE);T++)g=a.sqr(g);let v=a.pow(c,X<<BigInt(d-T-1));c=a.sqr(v),f=a.mul(f,v),h=a.mul(h,c),d=T}return f}}function zu(e){if(e%Fn===Vu){let t=(e+X)/Fn;return function(n,o){let i=n.pow(o,t);if(!n.eql(n.sqr(i),o))throw new Error("Cannot find square root");return i}}if(e%Ti===vi){let t=(e-vi)/Ti;return function(n,o){let i=n.mul(o,Ae),s=n.pow(i,t),a=n.mul(o,s),u=n.mul(n.mul(a,Ae),s),d=n.mul(a,n.sub(u,n.ONE));if(!n.eql(n.sqr(d),o))throw new Error("Cannot find square root");return d}}return e%Pu,Hu(e)}var Ci=(e,t)=>(W(e,t)&X)===X,$u=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function On(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=$u.reduce((n,o)=>(n[o]="function",n),t);return qt(e,r)}function Gu(e,t,r){if(r<et)throw new Error("invalid exponent, negatives unsupported");if(r===et)return e.ONE;if(r===X)return t;let n=e.ONE,o=t;for(;r>et;)r&X&&(n=e.mul(n,o)),o=e.sqr(o),r>>=X;return n}function Zu(e,t){let r=new Array(t.length),n=t.reduce((i,s,a)=>e.is0(s)?i:(r[a]=i,e.mul(i,s)),e.ONE),o=e.inv(n);return t.reduceRight((i,s,a)=>e.is0(s)?i:(r[a]=e.mul(i,r[a]),e.mul(i,s)),o),r}function Kn(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function fe(e,t,r=!1,n={}){if(e<=et)throw new Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:o,nByteLength:i}=Kn(e,t);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s,a=Object.freeze({ORDER:e,isLE:r,BITS:o,BYTES:i,MASK:sr(o),ZERO:et,ONE:X,create:u=>W(u,e),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return et<=u&&u<e},is0:u=>u===et,isOdd:u=>(u&X)===X,neg:u=>W(-u,e),eql:(u,d)=>u===d,sqr:u=>W(u*u,e),add:(u,d)=>W(u+d,e),sub:(u,d)=>W(u-d,e),mul:(u,d)=>W(u*d,e),pow:(u,d)=>Gu(a,u,d),div:(u,d)=>W(u*Dr(d,e),e),sqrN:u=>u*u,addN:(u,d)=>u+d,subN:(u,d)=>u-d,mulN:(u,d)=>u*d,inv:u=>Dr(u,e),sqrt:n.sqrt||(u=>(s||(s=zu(e)),s(a,u))),invertBatch:u=>Zu(a,u),cmov:(u,d,c)=>c?d:u,toBytes:u=>r?Se(u,i):ue(u,i),fromBytes:u=>{if(u.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+u.length);return r?ce(u):Wt(u)}});return Object.freeze(a)}function Ii(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Vn(e){let t=Ii(e);return t+Math.ceil(t/2)}function Ui(e,t,r=!1){let n=e.length,o=Ii(t),i=Vn(t);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);let s=r?ce(e):Wt(e),a=W(s,t-X)+X;return r?Se(a,o):ue(a,o)}var _i=BigInt(0),Fr=BigInt(1);function Mn(e,t){let r=t.negate();return e?r:t}function Li(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Pn(e,t){Li(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1);return{windows:r,windowSize:n}}function Wu(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function Yu(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}var qn=new WeakMap,Ni=new WeakMap;function Hn(e){return Ni.get(e)||1}function Or(e,t){return{constTimeNegate:Mn,hasPrecomputes(r){return Hn(r)!==1},unsafeLadder(r,n,o=e.ZERO){let i=r;for(;n>_i;)n&Fr&&(o=o.add(i)),i=i.double(),n>>=Fr;return o},precomputeWindow(r,n){let{windows:o,windowSize:i}=Pn(n,t),s=[],a=r,u=a;for(let d=0;d<o;d++){u=a,s.push(u);for(let c=1;c<i;c++)u=u.add(a),s.push(u);a=u.double()}return s},wNAF(r,n,o){let{windows:i,windowSize:s}=Pn(r,t),a=e.ZERO,u=e.BASE,d=BigInt(2**r-1),c=2**r,f=BigInt(r);for(let h=0;h<i;h++){let T=h*s,v=Number(o&d);o>>=f,v>s&&(v-=c,o+=Fr);let g=T,l=T+Math.abs(v)-1,S=h%2!==0,I=v<0;v===0?u=u.add(Mn(S,n[g])):a=a.add(Mn(I,n[l]))}return{p:a,f:u}},wNAFUnsafe(r,n,o,i=e.ZERO){let{windows:s,windowSize:a}=Pn(r,t),u=BigInt(2**r-1),d=2**r,c=BigInt(r);for(let f=0;f<s;f++){let h=f*a;if(o===_i)break;let T=Number(o&u);if(o>>=c,T>a&&(T-=d,o+=Fr),T===0)continue;let v=n[h+Math.abs(T)-1];T<0&&(v=v.negate()),i=i.add(v)}return i},getPrecomputes(r,n,o){let i=qn.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&qn.set(n,o(i))),i},wNAFCached(r,n,o){let i=Hn(r);return this.wNAF(i,this.getPrecomputes(i,r,o),n)},wNAFCachedUnsafe(r,n,o,i){let s=Hn(r);return s===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(s,this.getPrecomputes(s,r,o),n,i)},setWindowSize(r,n){Li(n,t),Ni.set(r,n),qn.delete(r)}}}function Kr(e,t,r,n){if(Wu(r,e),Yu(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");let o=e.ZERO,i=kn(BigInt(r.length)),s=i>12?i-3:i>4?i-2:i?2:1,a=(1<<s)-1,u=new Array(a+1).fill(o),d=Math.floor((t.BITS-1)/s)*s,c=o;for(let f=d;f>=0;f-=s){u.fill(o);for(let T=0;T<n.length;T++){let v=n[T],g=Number(v>>BigInt(f)&BigInt(a));u[g]=u[g].add(r[T])}let h=o;for(let T=u.length-1,v=o;T>0;T--)v=v.add(u[T]),h=h.add(v);if(c=c.add(h),f!==0)for(let T=0;T<s;T++)c=c.double()}return c}function ar(e){return On(e.Fp),qt(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Kn(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var Ft=BigInt(0),wt=BigInt(1),Vr=BigInt(2),ju=BigInt(8),Xu={zip215:!0};function Ju(e){let t=ar(e);return qt(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Ri(e){let t=Ju(e),{Fp:r,n,prehash:o,hash:i,randomBytes:s,nByteLength:a,h:u}=t,d=Vr<<BigInt(a*8)-wt,c=r.create,f=fe(t.n,t.nBitLength),h=t.uvRatio||((y,p)=>{try{return{isValid:!0,value:r.sqrt(y*r.inv(p))}}catch{return{isValid:!1,value:Ft}}}),T=t.adjustScalarBytes||(y=>y),v=t.domain||((y,p,E)=>{if(Dt("phflag",E),p.length||E)throw new Error("Contexts/pre-hash are not supported");return y});function g(y,p){bt("coordinate "+y,p,Ft,d)}function l(y){if(!(y instanceof x))throw new Error("ExtendedPoint expected")}let S=Be((y,p)=>{let{ex:E,ey:_,ez:K}=y,V=y.is0();p==null&&(p=V?ju:r.inv(K));let z=c(E*p),$=c(_*p),q=c(K*p);if(V)return{x:Ft,y:wt};if(q!==wt)throw new Error("invZ was invalid");return{x:z,y:$}}),I=Be(y=>{let{a:p,d:E}=t;if(y.is0())throw new Error("bad point: ZERO");let{ex:_,ey:K,ez:V,et:z}=y,$=c(_*_),q=c(K*K),Z=c(V*V),Y=c(Z*Z),rt=c($*p),nt=c(Z*c(rt+q)),at=c(Y+c(E*c($*q)));if(nt!==at)throw new Error("bad point: equation left != right (1)");let ft=c(_*K),gt=c(V*z);if(ft!==gt)throw new Error("bad point: equation left != right (2)");return!0});class x{constructor(p,E,_,K){this.ex=p,this.ey=E,this.ez=_,this.et=K,g("x",p),g("y",E),g("z",_),g("t",K),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(p){if(p instanceof x)throw new Error("extended point not allowed");let{x:E,y:_}=p||{};return g("x",E),g("y",_),new x(E,_,wt,c(E*_))}static normalizeZ(p){let E=r.invertBatch(p.map(_=>_.ez));return p.map((_,K)=>_.toAffine(E[K])).map(x.fromAffine)}static msm(p,E){return Kr(x,f,p,E)}_setWindowSize(p){D.setWindowSize(this,p)}assertValidity(){I(this)}equals(p){l(p);let{ex:E,ey:_,ez:K}=this,{ex:V,ey:z,ez:$}=p,q=c(E*$),Z=c(V*K),Y=c(_*$),rt=c(z*K);return q===Z&&Y===rt}is0(){return this.equals(x.ZERO)}negate(){return new x(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){let{a:p}=t,{ex:E,ey:_,ez:K}=this,V=c(E*E),z=c(_*_),$=c(Vr*c(K*K)),q=c(p*V),Z=E+_,Y=c(c(Z*Z)-V-z),rt=q+z,nt=rt-$,at=q-z,ft=c(Y*nt),gt=c(rt*at),dt=c(Y*at),Pt=c(nt*rt);return new x(ft,gt,Pt,dt)}add(p){l(p);let{a:E,d:_}=t,{ex:K,ey:V,ez:z,et:$}=this,{ex:q,ey:Z,ez:Y,et:rt}=p;if(E===BigInt(-1)){let Go=c((V-K)*(Z+q)),Zo=c((V+K)*(Z-q)),gn=c(Zo-Go);if(gn===Ft)return this.double();let Wo=c(z*Vr*rt),Yo=c($*Vr*Y),jo=Yo+Wo,Xo=Zo+Go,Jo=Yo-Wo,sc=c(jo*gn),ac=c(Xo*Jo),cc=c(jo*Jo),uc=c(gn*Xo);return new x(sc,ac,uc,cc)}let nt=c(K*q),at=c(V*Z),ft=c($*_*rt),gt=c(z*Y),dt=c((K+V)*(q+Z)-nt-at),Pt=gt-ft,zt=gt+ft,Qe=c(at-E*nt),rc=c(dt*Pt),nc=c(zt*Qe),oc=c(dt*Qe),ic=c(Pt*zt);return new x(rc,nc,ic,oc)}subtract(p){return this.add(p.negate())}wNAF(p){return D.wNAFCached(this,p,x.normalizeZ)}multiply(p){let E=p;bt("scalar",E,wt,n);let{p:_,f:K}=this.wNAF(E);return x.normalizeZ([_,K])[0]}multiplyUnsafe(p,E=x.ZERO){let _=p;return bt("scalar",_,Ft,n),_===Ft?F:this.is0()||_===wt?this:D.wNAFCachedUnsafe(this,_,x.normalizeZ,E)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return D.unsafeLadder(this,n).is0()}toAffine(p){return S(this,p)}clearCofactor(){let{h:p}=t;return p===wt?this:this.multiplyUnsafe(p)}static fromHex(p,E=!1){let{d:_,a:K}=t,V=r.BYTES;p=Q("pointHex",p,V),Dt("zip215",E);let z=p.slice(),$=p[V-1];z[V-1]=$&-129;let q=ce(z),Z=E?d:r.ORDER;bt("pointHex.y",q,Ft,Z);let Y=c(q*q),rt=c(Y-wt),nt=c(_*Y-K),{isValid:at,value:ft}=h(rt,nt);if(!at)throw new Error("Point.fromHex: invalid y coordinate");let gt=(ft&wt)===wt,dt=($&128)!==0;if(!E&&ft===Ft&&dt)throw new Error("Point.fromHex: x=0 and x_0=1");return dt!==gt&&(ft=c(-ft)),x.fromAffine({x:ft,y:q})}static fromPrivateKey(p){return w(p).point}toRawBytes(){let{x:p,y:E}=this.toAffine(),_=Se(E,r.BYTES);return _[_.length-1]|=p&wt?128:0,_}toHex(){return Zt(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,wt,c(t.Gx*t.Gy)),x.ZERO=new x(Ft,wt,wt,Ft);let{BASE:L,ZERO:F}=x,D=Or(x,a*8);function N(y){return W(y,n)}function b(y){return N(ce(y))}function w(y){let p=r.BYTES;y=Q("private key",y,p);let E=Q("hashed private key",i(y),2*p),_=T(E.slice(0,p)),K=E.slice(p,2*p),V=b(_),z=L.multiply(V),$=z.toRawBytes();return{head:_,prefix:K,scalar:V,point:z,pointBytes:$}}function O(y){return w(y).pointBytes}function R(y=new Uint8Array,...p){let E=Yt(...p);return b(i(v(E,Q("context",y),!!o)))}function U(y,p,E={}){y=Q("message",y),o&&(y=o(y));let{prefix:_,scalar:K,pointBytes:V}=w(p),z=R(E.context,_,y),$=L.multiply(z).toRawBytes(),q=R(E.context,$,V,y),Z=N(z+q*K);bt("signature.s",Z,Ft,n);let Y=Yt($,Se(Z,r.BYTES));return Q("result",Y,r.BYTES*2)}let P=Xu;function B(y,p,E,_=P){let{context:K,zip215:V}=_,z=r.BYTES;y=Q("signature",y,2*z),p=Q("message",p),E=Q("publicKey",E,z),V!==void 0&&Dt("zip215",V),o&&(p=o(p));let $=ce(y.slice(z,2*z)),q,Z,Y;try{q=x.fromHex(E,V),Z=x.fromHex(y.slice(0,z),V),Y=L.multiplyUnsafe($)}catch{return!1}if(!V&&q.isSmallOrder())return!1;let rt=R(K,Z.toRawBytes(),q.toRawBytes(),p);return Z.add(q.multiplyUnsafe(rt)).subtract(Y).clearCofactor().equals(x.ZERO)}return L._setWindowSize(8),{CURVE:t,getPublicKey:O,sign:U,verify:B,ExtendedPoint:x,utils:{getExtendedPublicKey:w,randomPrivateKey:()=>s(r.BYTES),precompute(y=8,p=x.BASE){return p._setWindowSize(y),p.multiply(BigInt(3)),p}}}}var zn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ki=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),ih=BigInt(0),Qu=BigInt(1),Di=BigInt(2),sh=BigInt(3),tf=BigInt(5),ef=BigInt(8);function rf(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),i=zn,a=e*e%i*e%i,u=J(a,Di,i)*a%i,d=J(u,Qu,i)*e%i,c=J(d,tf,i)*d%i,f=J(c,t,i)*c%i,h=J(f,r,i)*f%i,T=J(h,n,i)*h%i,v=J(T,o,i)*T%i,g=J(v,o,i)*T%i,l=J(g,t,i)*c%i;return{pow_p_5_8:J(l,Di,i)*e%i,b2:a}}function nf(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function of(e,t){let r=zn,n=W(t*t*t,r),o=W(n*n*t,r),i=rf(e*o).pow_p_5_8,s=W(e*n*i,r),a=W(t*s*s,r),u=s,d=W(s*ki,r),c=a===e,f=a===W(-e,r),h=a===W(-e*ki,r);return c&&(s=u),(f||h)&&(s=d),Ci(s,r)&&(s=W(-s,r)),{isValid:c||f,value:s}}var sf=fe(zn,void 0,!0),af={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:sf,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:ef,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Si,randomBytes:_r,adjustScalarBytes:nf,uvRatio:of},Fi=Ri(af);var Mr=32;function Oi(e,t,r){return Fi.verify(t,r instanceof Uint8Array?r:r.subarray(),e)}var Pr=class{type="Ed25519";raw;constructor(t){this.raw=$n(t,Mr)}toMultihash(){return nr.digest(Me(this))}toCID(){return pt.createV1(114,this.toMultihash())}toString(){return ot.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:Ut(this.raw,t.raw)}verify(t,r){return Oi(this.raw,r,t)}};function Vi(e){return e=$n(e,Mr),new Pr(e)}function $n(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new xt(`Key must be a Uint8Array of length ${t}, got ${e.length}`);return e}function jt(e=0){return new Uint8Array(e)}function St(e=0){return new Uint8Array(e)}var uf=Math.pow(2,7),ff=Math.pow(2,14),lf=Math.pow(2,21),Mi=Math.pow(2,28),Pi=Math.pow(2,35),qi=Math.pow(2,42),Hi=Math.pow(2,49),mt=128,le=127;function cr(e){if(e<uf)return 1;if(e<ff)return 2;if(e<lf)return 3;if(e<Mi)return 4;if(e<Pi)return 5;if(e<qi)return 6;if(e<Hi)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function zi(e,t,r=0){switch(cr(e)){case 8:t[r++]=e&255|mt,e/=128;case 7:t[r++]=e&255|mt,e/=128;case 6:t[r++]=e&255|mt,e/=128;case 5:t[r++]=e&255|mt,e/=128;case 4:t[r++]=e&255|mt,e>>>=7;case 3:t[r++]=e&255|mt,e>>>=7;case 2:t[r++]=e&255|mt,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function $i(e,t){let r=e[t],n=0;if(n+=r&le,r<mt||(r=e[t+1],n+=(r&le)<<7,r<mt)||(r=e[t+2],n+=(r&le)<<14,r<mt)||(r=e[t+3],n+=(r&le)<<21,r<mt)||(r=e[t+4],n+=(r&le)*Mi,r<mt)||(r=e[t+5],n+=(r&le)*Pi,r<mt)||(r=e[t+6],n+=(r&le)*qi,r<mt)||(r=e[t+7],n+=(r&le)*Hi,r<mt))return n;throw new RangeError("Could not decode varint")}var Gn=new Float32Array([-0]),de=new Uint8Array(Gn.buffer);function Gi(e,t,r){Gn[0]=e,t[r]=de[0],t[r+1]=de[1],t[r+2]=de[2],t[r+3]=de[3]}function Zi(e,t){return de[0]=e[t],de[1]=e[t+1],de[2]=e[t+2],de[3]=e[t+3],Gn[0]}var Zn=new Float64Array([-0]),lt=new Uint8Array(Zn.buffer);function Wi(e,t,r){Zn[0]=e,t[r]=lt[0],t[r+1]=lt[1],t[r+2]=lt[2],t[r+3]=lt[3],t[r+4]=lt[4],t[r+5]=lt[5],t[r+6]=lt[6],t[r+7]=lt[7]}function Yi(e,t){return lt[0]=e[t],lt[1]=e[t+1],lt[2]=e[t+2],lt[3]=e[t+3],lt[4]=e[t+4],lt[5]=e[t+5],lt[6]=e[t+6],lt[7]=e[t+7],Zn[0]}var df=BigInt(Number.MAX_SAFE_INTEGER),hf=BigInt(Number.MIN_SAFE_INTEGER),Bt=class e{lo;hi;constructor(t,r){this.lo=t|0,this.hi=r|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return ve;if(t<df&&t>hf)return this.fromNumber(Number(t));let r=t<0n;r&&(t=-t);let n=t>>32n,o=t-(n<<32n);return r&&(n=~n|0n,o=~o|0n,++o>ji&&(o=0n,++n>ji&&(n=0n))),new e(Number(o),Number(n))}static fromNumber(t){if(t===0)return ve;let r=t<0;r&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return r&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new e(n,o)}static from(t){return typeof t=="number"?e.fromNumber(t):typeof t=="bigint"?e.fromBigInt(t):typeof t=="string"?e.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new e(t.low>>>0,t.high>>>0):ve}},ve=new Bt(0,0);ve.toBigInt=function(){return 0n};ve.zzEncode=ve.zzDecode=function(){return this};ve.length=function(){return 1};var ji=4294967296n;function Xi(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function Ji(e,t,r){if(r-t<1)return"";let o,i=[],s=0,a;for(;t<r;)a=e[t++],a<128?i[s++]=a:a>191&&a<224?i[s++]=(a&31)<<6|e[t++]&63:a>239&&a<365?(a=((a&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,i[s++]=55296+(a>>10),i[s++]=56320+(a&1023)):i[s++]=(a&15)<<12|(e[t++]&63)<<6|e[t++]&63,s>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o!=null?(s>0&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))}function Wn(e,t,r){let n=r,o,i;for(let s=0;s<e.length;++s)o=e.charCodeAt(s),o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&((i=e.charCodeAt(s+1))&64512)===56320?(o=65536+((o&1023)<<10)+(i&1023),++s,t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128);return r-n}function Ot(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function qr(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}var Yn=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Ot(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Ot(this,4);return qr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Ot(this,4);return qr(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Ot(this,4);let t=Zi(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw Ot(this,4);let t=Yi(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw Ot(this,t);return this.pos+=t,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let t=this.bytes();return Ji(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Ot(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Ot(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new Bt(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw Ot(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,t}if(this.len-this.pos>4){for(;r<5;++r)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;r<5;++r){if(this.pos>=this.len)throw Ot(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Ot(this,8);let t=qr(this.buf,this.pos+=4),r=qr(this.buf,this.pos+=4);return new Bt(t,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=$i(this.buf,this.pos);return this.pos+=cr(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function jn(e){return new Yn(e instanceof Uint8Array?e:e.subarray())}function Pe(e,t,r){let n=jn(e);return t.decode(n,void 0,r)}var Xn={};ht(Xn,{base10:()=>pf});var pf=re({prefix:"9",name:"base10",alphabet:"0123456789"});var Jn={};ht(Jn,{base16:()=>mf,base16upper:()=>yf});var mf=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),yf=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Qn={};ht(Qn,{base2:()=>gf});var gf=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var to={};ht(to,{base256emoji:()=>Sf});var ts=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),xf=ts.reduce((e,t,r)=>(e[r]=t,e),[]),bf=ts.reduce((e,t,r)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function wf(e){return e.reduce((t,r)=>(t+=xf[r],t),"")}function Ef(e){let t=[];for(let r of e){let n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);let o=bf[n];if(o==null)throw new Error(`Non-base256emoji character: ${r}`);t.push(o)}return new Uint8Array(t)}var Sf=_e({prefix:"\u{1F680}",name:"base256emoji",encode:wf,decode:Ef});var ro={};ht(ro,{base64:()=>eo,base64pad:()=>Bf,base64url:()=>Af,base64urlpad:()=>vf});var eo=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Bf=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Af=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vf=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var no={};ht(no,{base8:()=>Tf});var Tf=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var oo={};ht(oo,{identity:()=>Cf});var Cf=_e({prefix:"\0",name:"identity",encode:e=>ri(e),decode:e=>ei(e)});var Hh=new TextEncoder,zh=new TextDecoder;var co={};ht(co,{sha256:()=>ao,sha512:()=>_f});function so({name:e,code:t,encode:r}){return new io(e,t,r)}var io=class{name;code;encode;constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Rt(this.code,r):r.then(n=>Rt(this.code,n))}else throw Error("Unknown type, must be binary type")}};function rs(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}var ao=so({name:"sha2-256",code:18,encode:rs("SHA-256")}),_f=so({name:"sha2-512",code:19,encode:rs("SHA-512")});var uo={...oo,...Qn,...no,...Xn,...Jn,...Bn,...An,...Sn,...ro,...to},r0={...co,...Cn};function os(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var ns=os("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),fo=os("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=St(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Lf={utf8:ns,"utf-8":ns,hex:uo.base16,latin1:fo,ascii:fo,binary:fo,...uo},Hr=Lf;function j(e,t="utf8"){let r=Hr[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function lo(e){let t=e??8192,r=t>>>1,n,o=t;return function(s){if(s<1||s>r)return St(s);o+s>t&&(n=St(t),o=0);let a=n.subarray(o,o+=s);return(o&7)!==0&&(o=(o|7)+1),a}}var Te=class{fn;len;next;val;constructor(t,r,n){this.fn=t,this.len=r,this.next=void 0,this.val=n}};function ho(){}var mo=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},Nf=lo();function Rf(e){return globalThis.Buffer!=null?St(e):Nf(e)}var fr=class{len;head;tail;states;constructor(){this.len=0,this.head=new Te(ho,0,0),this.tail=this.head,this.states=null}_push(t,r,n){return this.tail=this.tail.next=new Te(t,r,n),this.len+=r,this}uint32(t){return this.len+=(this.tail=this.tail.next=new yo((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(zr,10,Bt.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let r=Bt.fromBigInt(t);return this._push(zr,r.length(),r)}uint64Number(t){return this._push(zi,cr(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let r=Bt.fromBigInt(t).zzEncode();return this._push(zr,r.length(),r)}sint64Number(t){let r=Bt.fromNumber(t).zzEncode();return this._push(zr,r.length(),r)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(po,1,t?1:0)}fixed32(t){return this._push(ur,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let r=Bt.fromBigInt(t);return this._push(ur,4,r.lo)._push(ur,4,r.hi)}fixed64Number(t){let r=Bt.fromNumber(t);return this._push(ur,4,r.lo)._push(ur,4,r.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(Gi,4,t)}double(t){return this._push(Wi,8,t)}bytes(t){let r=t.length>>>0;return r===0?this._push(po,1,0):this.uint32(r)._push(Df,r,t)}string(t){let r=Xi(t);return r!==0?this.uint32(r)._push(Wn,r,t):this._push(po,1,0)}fork(){return this.states=new mo(this),this.head=this.tail=new Te(ho,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Te(ho,0,0),this.len=0),this}ldelim(){let t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=r,this.len+=n),this}finish(){let t=this.head.next,r=Rf(this.len),n=0;for(;t!=null;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r}};function po(e,t,r){t[r]=e&255}function kf(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}var yo=class extends Te{next;constructor(t,r){super(kf,t,r),this.next=void 0}};function zr(e,t,r){for(;e.hi!==0;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}function ur(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Df(e,t,r){t.set(e,r)}globalThis.Buffer!=null&&(fr.prototype.bytes=function(e){let t=e.length>>>0;return this.uint32(t),t>0&&this._push(Ff,t,e),this},fr.prototype.string=function(e){let t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(Of,t,e),this});function Ff(e,t,r){t.set(e,r)}function Of(e,t,r){e.length<40?Wn(e,t,r):t.utf8Write!=null?t.utf8Write(e,r):t.set(j(e),r)}function go(){return new fr}function qe(e,t){let r=go();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var He;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(He||(He={}));function $r(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function lr(e){function t(o){if(e[o.toString()]==null)throw new Error("Invalid enum value");return e[o]}let r=function(i,s){let a=t(i);s.int32(a)},n=function(i){let s=i.int32();return t(s)};return $r("enum",He.VARINT,r,n)}function ze(e,t){return $r("message",He.LENGTH_DELIMITED,e,t)}var ct;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.secp256k1="secp256k1"})(ct||(ct={}));var xo;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.secp256k1=2]="secp256k1"})(xo||(xo={}));(function(e){e.codec=()=>lr(xo)})(ct||(ct={}));var Xt;(function(e){let t;e.codec=()=>(t==null&&(t=ze((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:{i.Type=ct.codec().decode(r);break}case 2:{i.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return i})),t),e.encode=r=>qe(r,e.codec()),e.decode=(r,n)=>Pe(r,e.codec(),n)})(Xt||(Xt={}));var bo;(function(e){let t;e.codec=()=>(t==null&&(t=ze((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ct.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:{i.Type=ct.codec().decode(r);break}case 2:{i.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return i})),t),e.encode=r=>qe(r,e.codec()),e.decode=(r,n)=>Pe(r,e.codec(),n)})(bo||(bo={}));var pr={};ht(pr,{MAX_RSA_KEY_SIZE:()=>Ao,generateRSAKeyPair:()=>bs,jwkToJWKKeyPair:()=>ws,jwkToPkcs1:()=>Yf,jwkToPkix:()=>To,jwkToRSAPrivateKey:()=>xs,pkcs1ToJwk:()=>ms,pkcs1ToRSAPrivateKey:()=>gs,pkixToJwk:()=>ys,pkixToRSAPublicKey:()=>Co});var Kf=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),he=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),pe=new Uint32Array(64),wo=class extends Ke{constructor(){super(64,32,8,!1),this.A=he[0]|0,this.B=he[1]|0,this.C=he[2]|0,this.D=he[3]|0,this.E=he[4]|0,this.F=he[5]|0,this.G=he[6]|0,this.H=he[7]|0}get(){let{A:t,B:r,C:n,D:o,E:i,F:s,G:a,H:u}=this;return[t,r,n,o,i,s,a,u]}set(t,r,n,o,i,s,a,u){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=u|0}process(t,r){for(let f=0;f<16;f++,r+=4)pe[f]=t.getUint32(r,!1);for(let f=16;f<64;f++){let h=pe[f-15],T=pe[f-2],v=kt(h,7)^kt(h,18)^h>>>3,g=kt(T,17)^kt(T,19)^T>>>10;pe[f]=g+pe[f-7]+v+pe[f-16]|0}let{A:n,B:o,C:i,D:s,E:a,F:u,G:d,H:c}=this;for(let f=0;f<64;f++){let h=kt(a,6)^kt(a,11)^kt(a,25),T=c+h+bi(a,u,d)+Kf[f]+pe[f]|0,g=(kt(n,2)^kt(n,13)^kt(n,22))+wi(n,o,i)|0;c=d,d=u,u=a,a=s+T|0,s=i,i=o,o=n,n=T+g|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,u=u+this.F|0,d=d+this.G|0,c=c+this.H|0,this.set(n,o,i,s,a,u,d,c)}roundClean(){pe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var $e=Ur(()=>new wo);function yt(e,t="utf8"){let r=Hr[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}function me(e,t){t==null&&(t=e.reduce((o,i)=>o+i.length,0));let r=St(t),n=0;for(let o of e)r.set(o,n),n+=o.length;return r}var as=Symbol.for("@achingbrain/uint8arraylist");function ss(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let o=r+n.byteLength;if(t<o)return{buf:n,index:t-r};r=o}throw new RangeError("index is out of bounds")}function Gr(e){return!!e?.[as]}var Kt=class e{bufs;length;[as]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Gr(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(Gr(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=ss(this.bufs,t);return r.buf[r.index]}set(t,r){let n=ss(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(Gr(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:o}=this._subList(t,r);return me(n,o)}subarray(t,r){let{bufs:n,length:o}=this._subList(t,r);return n.length===1?n[0]:me(n,o)}sublist(t,r){let{bufs:n,length:o}=this._subList(t,r),i=new e;return i.length=o,i.bufs=[...n],i}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let i=0;i<this.bufs.length;i++){let s=this.bufs[i],a=o,u=a+s.byteLength;if(o=u,t>=u)continue;let d=t>=a&&t<u,c=r>a&&r<=u;if(d&&c){if(t===a&&r===u){n.push(s);break}let f=t-a;n.push(s.subarray(f,f+(r-t)));break}if(d){if(t===0){n.push(s);continue}n.push(s.subarray(t-a));continue}if(c){if(r===u){n.push(s);break}n.push(s.subarray(0,r-a));break}n.push(s)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!Gr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let i=256,s=new Int32Array(i);for(let f=0;f<i;f++)s[f]=-1;for(let f=0;f<o;f++)s[n[f]]=f;let a=s,u=this.byteLength-n.byteLength,d=n.byteLength-1,c;for(let f=r;f<=u;f+=c){c=0;for(let h=d;h>=0;h--){let T=this.get(f+h);if(n[h]!==T){c=Math.max(1,h-a[T]);break}}if(c===0)return f}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=St(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let o=jt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,r,n),this.write(o,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let o=jt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,r,n),this.write(o,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let o=jt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,r,n),this.write(o,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=St(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let o=jt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,r,n),this.write(o,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let o=jt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,r,n),this.write(o,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let o=jt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,r,n),this.write(o,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let o=jt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,r,n),this.write(o,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let o=jt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,r,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Ut(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((o,i)=>o+i.byteLength,0)),n.length=r,n}};var Vf=parseInt("11111",2),So=parseInt("10000000",2),Mf=parseInt("01111111",2),cs={2:Pf,3:zf,5:Hf,6:qf,16:Eo,22:Eo,48:Eo};function dr(e,t={offset:0}){let r=e[t.offset]&Vf;if(t.offset++,cs[r]!=null)return cs[r](e,t);throw new Error("No decoder for tag "+r)}function Zr(e,t){let r=0;if((e[t.offset]&So)===So){let n=e[t.offset]&Mf,o="0x";t.offset++;for(let i=0;i<n;i++,t.offset++)o+=e[t.offset].toString(16).padStart(2,"0");r=parseInt(o,16)}else r=e[t.offset],t.offset++;return r}function Eo(e,t){Zr(e,t);let r=[];for(;!(t.offset>=e.byteLength);){let n=dr(e,t);if(n===null)break;r.push(n)}return r}function Pf(e,t){let r=Zr(e,t),n=t.offset,o=t.offset+r,i=[];for(let s=n;s<o;s++)s===n&&e[s]===0||i.push(e[s]);return t.offset+=r,Uint8Array.from(i)}function qf(e,t){let r=Zr(e,t);return t.offset+=r,["oid-unimplemented"]}function Hf(e,t){return t.offset++,null}function zf(e,t){let r=Zr(e,t),n=e[t.offset];t.offset++;let o=e.subarray(t.offset,t.offset+r);if(t.offset+=r,n!==0)throw new Error("Unused bits in bit string is unimplemented");return dr(o,{offset:0})}function $f(e){let t=e.toString(16);t.length%2===1&&(t="0"+t);let r=new Kt;for(let n=0;n<t.length;n+=2)r.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return r}function Bo(e){if(e.byteLength<128)return Uint8Array.from([e.byteLength]);let t=$f(e.byteLength);return new Kt(Uint8Array.from([t.byteLength|So]),t)}function _t(e){let t=new Kt,r=parseInt("10000000",2);return(e.subarray()[0]&r)===r&&t.append(Uint8Array.from([0])),t.append(e),new Kt(Uint8Array.from([2]),Bo(t),t)}function us(e){let t=Uint8Array.from([0]),r=new Kt(t,e);return new Kt(Uint8Array.from([3]),Bo(r),r)}function Wr(e){let t=new Kt;for(let r of e)t.append(r);return new Kt(Uint8Array.from([48]),Bo(t),t)}var hr=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},Yr=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var fs={get(e=globalThis){let t=e.crypto;if(t?.subtle==null)throw new Yr("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var ye=fs;async function ls(e){let t=await ye.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Gf(t);return{privateKey:r[0],publicKey:r[1]}}async function ds(e,t){let r=await ye.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ye.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function hs(e,t,r){let n=await ye.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ye.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r instanceof Uint8Array?r:r.subarray())}async function Gf(e){if(e.privateKey==null||e.publicKey==null)throw new xt("Private and public key are required");return Promise.all([ye.get().subtle.exportKey("jwk",e.privateKey),ye.get().subtle.exportKey("jwk",e.publicKey)])}function ps(e){if(e.kty!=="RSA")throw new xt("invalid key type");if(e.n==null)throw new xt("invalid key modulus");return j(e.n,"base64url").length*8}var Ge=class{type="RSA";_key;_raw;_multihash;constructor(t,r){this._key=t,this._multihash=r}get raw(){return this._raw==null&&(this._raw=pr.jwkToPkix(this._key)),this._raw}toMultihash(){return this._multihash}toCID(){return pt.createV1(114,this._multihash)}toString(){return ot.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:Ut(this.raw,t.raw)}verify(t,r){return hs(this._key,r,t)}},mr=class{type="RSA";_key;_raw;publicKey;constructor(t,r){this._key=t,this.publicKey=r}get raw(){return this._raw==null&&(this._raw=pr.jwkToPkcs1(this._key)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:Ut(this.raw,t.raw)}sign(t){return ds(this._key,t)}};var Ao=8192,vo=18,Zf=1062,Wf=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function ms(e){let t=dr(e);return{n:yt(t[1],"base64url"),e:yt(t[2],"base64url"),d:yt(t[3],"base64url"),p:yt(t[4],"base64url"),q:yt(t[5],"base64url"),dp:yt(t[6],"base64url"),dq:yt(t[7],"base64url"),qi:yt(t[8],"base64url"),kty:"RSA"}}function Yf(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new xt("JWK was missing components");return Wr([_t(Uint8Array.from([0])),_t(j(e.n,"base64url")),_t(j(e.e,"base64url")),_t(j(e.d,"base64url")),_t(j(e.p,"base64url")),_t(j(e.q,"base64url")),_t(j(e.dp,"base64url")),_t(j(e.dq,"base64url")),_t(j(e.qi,"base64url"))]).subarray()}function ys(e){let t=dr(e,{offset:0});return{kty:"RSA",n:yt(t[1][0],"base64url"),e:yt(t[1][1],"base64url")}}function To(e){if(e.n==null||e.e==null)throw new xt("JWK was missing components");return Wr([Wf,us(Wr([_t(j(e.n,"base64url")),_t(j(e.e,"base64url"))]))]).subarray()}function gs(e){let t=ms(e);return xs(t)}function Co(e,t){if(e.byteLength>=Zf)throw new Ue("Key size is too large");let r=ys(e);if(t==null){let n=$e(Xt.encode({Type:ct.RSA,Data:e}));t=Rt(vo,n)}return new Ge(r,t)}function xs(e){if(ps(e)>Ao)throw new xt("Key size is too large");let t=ws(e),r=$e(Xt.encode({Type:ct.RSA,Data:To(t.publicKey)})),n=Rt(vo,r);return new mr(t.privateKey,new Ge(t.publicKey,n))}async function bs(e){if(e>Ao)throw new xt("Key size is too large");let t=await ls(e),r=$e(Xt.encode({Type:ct.RSA,Data:To(t.publicKey)})),n=Rt(vo,r);return new mr(t.privateKey,new Ge(t.publicKey,n))}function ws(e){if(e==null)throw new xt("Missing key parameter");return{privateKey:e,publicKey:{kty:e.kty,n:e.n,e:e.e}}}var jr=class extends Oe{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,yi(t);let n=or(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,i=new Uint8Array(o);i.set(n.length>o?t.create().update(n).digest():n);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(t){return Fe(this),this.iHash.update(t),this}digestInto(t){Fe(this),De(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Io=(e,t,r)=>new jr(e,t).update(r).digest();Io.create=(e,t)=>new jr(e,t);function Es(e){e.lowS!==void 0&&Dt("lowS",e.lowS),e.prehash!==void 0&&Dt("prehash",e.prehash)}function jf(e){let t=ar(e);qt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:o}=t;if(r){if(!n.eql(o,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Xf,hexToBytes:Jf}=kr,Uo=class extends Error{constructor(t=""){super(t)}},Jt={Err:Uo,_tlv:{encode:(e,t)=>{let{Err:r}=Jt;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=we(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let i=n>127?we(o.length/2|128):"";return we(e)+i+o+t},decode(e,t){let{Err:r}=Jt,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],i=!!(o&128),s=0;if(!i)s=o;else{let u=o&127;if(!u)throw new r("tlv.decode(long): indefinite length not supported");if(u>4)throw new r("tlv.decode(long): byte length is too big");let d=t.subarray(n,n+u);if(d.length!==u)throw new r("tlv.decode: length bytes not complete");if(d[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let c of d)s=s<<8|c;if(n+=u,s<128)throw new r("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+s)}}},_int:{encode(e){let{Err:t}=Jt;if(e<Qt)throw new t("integer: negative integers are not allowed");let r=we(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=Jt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Xf(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=Jt,o=typeof e=="string"?Jf(e):e;Ve(o);let{v:i,l:s}=n.decode(48,o);if(s.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:u}=n.decode(2,i),{v:d,l:c}=n.decode(2,u);if(c.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(d)}},hexFromSig(e){let{_tlv:t,_int:r}=Jt,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),i=n+o;return t.encode(48,i)}},Qt=BigInt(0),it=BigInt(1),Ap=BigInt(2),Ss=BigInt(3),vp=BigInt(4);function Qf(e){let t=jf(e),{Fp:r}=t,n=fe(t.n,t.nBitLength),o=t.toBytes||((g,l,S)=>{let I=l.toAffine();return Yt(Uint8Array.from([4]),r.toBytes(I.x),r.toBytes(I.y))}),i=t.fromBytes||(g=>{let l=g.subarray(1),S=r.fromBytes(l.subarray(0,r.BYTES)),I=r.fromBytes(l.subarray(r.BYTES,2*r.BYTES));return{x:S,y:I}});function s(g){let{a:l,b:S}=t,I=r.sqr(g),x=r.mul(I,g);return r.add(r.add(x,r.mul(g,l)),S)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return ir(g,it,t.n)}function u(g){let{allowedPrivateKeyLengths:l,nByteLength:S,wrapPrivateKey:I,n:x}=t;if(l&&typeof g!="bigint"){if(ae(g)&&(g=Zt(g)),typeof g!="string"||!l.includes(g.length))throw new Error("invalid private key");g=g.padStart(S*2,"0")}let L;try{L=typeof g=="bigint"?g:Wt(Q("private key",g,S))}catch{throw new Error("invalid private key, expected hex or "+S+" bytes, got "+typeof g)}return I&&(L=W(L,x)),bt("private key",L,it,x),L}function d(g){if(!(g instanceof h))throw new Error("ProjectivePoint expected")}let c=Be((g,l)=>{let{px:S,py:I,pz:x}=g;if(r.eql(x,r.ONE))return{x:S,y:I};let L=g.is0();l==null&&(l=L?r.ONE:r.inv(x));let F=r.mul(S,l),D=r.mul(I,l),N=r.mul(x,l);if(L)return{x:r.ZERO,y:r.ZERO};if(!r.eql(N,r.ONE))throw new Error("invZ was invalid");return{x:F,y:D}}),f=Be(g=>{if(g.is0()){if(t.allowInfinityPoint&&!r.is0(g.py))return;throw new Error("bad point: ZERO")}let{x:l,y:S}=g.toAffine();if(!r.isValid(l)||!r.isValid(S))throw new Error("bad point: x or y not FE");let I=r.sqr(S),x=s(l);if(!r.eql(I,x))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class h{constructor(l,S,I){if(this.px=l,this.py=S,this.pz=I,l==null||!r.isValid(l))throw new Error("x required");if(S==null||!r.isValid(S))throw new Error("y required");if(I==null||!r.isValid(I))throw new Error("z required");Object.freeze(this)}static fromAffine(l){let{x:S,y:I}=l||{};if(!l||!r.isValid(S)||!r.isValid(I))throw new Error("invalid affine point");if(l instanceof h)throw new Error("projective point not allowed");let x=L=>r.eql(L,r.ZERO);return x(S)&&x(I)?h.ZERO:new h(S,I,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(l){let S=r.invertBatch(l.map(I=>I.pz));return l.map((I,x)=>I.toAffine(S[x])).map(h.fromAffine)}static fromHex(l){let S=h.fromAffine(i(Q("pointHex",l)));return S.assertValidity(),S}static fromPrivateKey(l){return h.BASE.multiply(u(l))}static msm(l,S){return Kr(h,n,l,S)}_setWindowSize(l){v.setWindowSize(this,l)}assertValidity(){f(this)}hasEvenY(){let{y:l}=this.toAffine();if(r.isOdd)return!r.isOdd(l);throw new Error("Field doesn't support isOdd")}equals(l){d(l);let{px:S,py:I,pz:x}=this,{px:L,py:F,pz:D}=l,N=r.eql(r.mul(S,D),r.mul(L,x)),b=r.eql(r.mul(I,D),r.mul(F,x));return N&&b}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:l,b:S}=t,I=r.mul(S,Ss),{px:x,py:L,pz:F}=this,D=r.ZERO,N=r.ZERO,b=r.ZERO,w=r.mul(x,x),O=r.mul(L,L),R=r.mul(F,F),U=r.mul(x,L);return U=r.add(U,U),b=r.mul(x,F),b=r.add(b,b),D=r.mul(l,b),N=r.mul(I,R),N=r.add(D,N),D=r.sub(O,N),N=r.add(O,N),N=r.mul(D,N),D=r.mul(U,D),b=r.mul(I,b),R=r.mul(l,R),U=r.sub(w,R),U=r.mul(l,U),U=r.add(U,b),b=r.add(w,w),w=r.add(b,w),w=r.add(w,R),w=r.mul(w,U),N=r.add(N,w),R=r.mul(L,F),R=r.add(R,R),w=r.mul(R,U),D=r.sub(D,w),b=r.mul(R,O),b=r.add(b,b),b=r.add(b,b),new h(D,N,b)}add(l){d(l);let{px:S,py:I,pz:x}=this,{px:L,py:F,pz:D}=l,N=r.ZERO,b=r.ZERO,w=r.ZERO,O=t.a,R=r.mul(t.b,Ss),U=r.mul(S,L),P=r.mul(I,F),B=r.mul(x,D),A=r.add(S,I),y=r.add(L,F);A=r.mul(A,y),y=r.add(U,P),A=r.sub(A,y),y=r.add(S,x);let p=r.add(L,D);return y=r.mul(y,p),p=r.add(U,B),y=r.sub(y,p),p=r.add(I,x),N=r.add(F,D),p=r.mul(p,N),N=r.add(P,B),p=r.sub(p,N),w=r.mul(O,y),N=r.mul(R,B),w=r.add(N,w),N=r.sub(P,w),w=r.add(P,w),b=r.mul(N,w),P=r.add(U,U),P=r.add(P,U),B=r.mul(O,B),y=r.mul(R,y),P=r.add(P,B),B=r.sub(U,B),B=r.mul(O,B),y=r.add(y,B),U=r.mul(P,y),b=r.add(b,U),U=r.mul(p,y),N=r.mul(A,N),N=r.sub(N,U),U=r.mul(A,P),w=r.mul(p,w),w=r.add(w,U),new h(N,b,w)}subtract(l){return this.add(l.negate())}is0(){return this.equals(h.ZERO)}wNAF(l){return v.wNAFCached(this,l,h.normalizeZ)}multiplyUnsafe(l){let{endo:S,n:I}=t;bt("scalar",l,Qt,I);let x=h.ZERO;if(l===Qt)return x;if(this.is0()||l===it)return this;if(!S||v.hasPrecomputes(this))return v.wNAFCachedUnsafe(this,l,h.normalizeZ);let{k1neg:L,k1:F,k2neg:D,k2:N}=S.splitScalar(l),b=x,w=x,O=this;for(;F>Qt||N>Qt;)F&it&&(b=b.add(O)),N&it&&(w=w.add(O)),O=O.double(),F>>=it,N>>=it;return L&&(b=b.negate()),D&&(w=w.negate()),w=new h(r.mul(w.px,S.beta),w.py,w.pz),b.add(w)}multiply(l){let{endo:S,n:I}=t;bt("scalar",l,it,I);let x,L;if(S){let{k1neg:F,k1:D,k2neg:N,k2:b}=S.splitScalar(l),{p:w,f:O}=this.wNAF(D),{p:R,f:U}=this.wNAF(b);w=v.constTimeNegate(F,w),R=v.constTimeNegate(N,R),R=new h(r.mul(R.px,S.beta),R.py,R.pz),x=w.add(R),L=O.add(U)}else{let{p:F,f:D}=this.wNAF(l);x=F,L=D}return h.normalizeZ([x,L])[0]}multiplyAndAddUnsafe(l,S,I){let x=h.BASE,L=(D,N)=>N===Qt||N===it||!D.equals(x)?D.multiplyUnsafe(N):D.multiply(N),F=L(this,S).add(L(l,I));return F.is0()?void 0:F}toAffine(l){return c(this,l)}isTorsionFree(){let{h:l,isTorsionFree:S}=t;if(l===it)return!0;if(S)return S(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:l,clearCofactor:S}=t;return l===it?this:S?S(h,this):this.multiplyUnsafe(t.h)}toRawBytes(l=!0){return Dt("isCompressed",l),this.assertValidity(),o(h,this,l)}toHex(l=!0){return Dt("isCompressed",l),Zt(this.toRawBytes(l))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let T=t.nBitLength,v=Or(h,t.endo?Math.ceil(T/2):T);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:u,weierstrassEquation:s,isWithinCurveOrder:a}}function tl(e){let t=ar(e);return qt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Bs(e){let t=tl(e),{Fp:r,n}=t,o=r.BYTES+1,i=2*r.BYTES+1;function s(B){return W(B,n)}function a(B){return Dr(B,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:c,isWithinCurveOrder:f}=Qf({...t,toBytes(B,A,y){let p=A.toAffine(),E=r.toBytes(p.x),_=Yt;return Dt("isCompressed",y),y?_(Uint8Array.from([A.hasEvenY()?2:3]),E):_(Uint8Array.from([4]),E,r.toBytes(p.y))},fromBytes(B){let A=B.length,y=B[0],p=B.subarray(1);if(A===o&&(y===2||y===3)){let E=Wt(p);if(!ir(E,it,r.ORDER))throw new Error("Point is not on curve");let _=c(E),K;try{K=r.sqrt(_)}catch($){let q=$ instanceof Error?": "+$.message:"";throw new Error("Point is not on curve"+q)}let V=(K&it)===it;return(y&1)===1!==V&&(K=r.neg(K)),{x:E,y:K}}else if(A===i&&y===4){let E=r.fromBytes(p.subarray(0,r.BYTES)),_=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:E,y:_}}else{let E=o,_=i;throw new Error("invalid Point, expected length of "+E+", or uncompressed "+_+", got "+A)}}}),h=B=>Zt(ue(B,t.nByteLength));function T(B){let A=n>>it;return B>A}function v(B){return T(B)?s(-B):B}let g=(B,A,y)=>Wt(B.slice(A,y));class l{constructor(A,y,p){this.r=A,this.s=y,this.recovery=p,this.assertValidity()}static fromCompact(A){let y=t.nByteLength;return A=Q("compactSignature",A,y*2),new l(g(A,0,y),g(A,y,2*y))}static fromDER(A){let{r:y,s:p}=Jt.toSig(Q("DER",A));return new l(y,p)}assertValidity(){bt("r",this.r,it,n),bt("s",this.s,it,n)}addRecoveryBit(A){return new l(this.r,this.s,A)}recoverPublicKey(A){let{r:y,s:p,recovery:E}=this,_=D(Q("msgHash",A));if(E==null||![0,1,2,3].includes(E))throw new Error("recovery id invalid");let K=E===2||E===3?y+t.n:y;if(K>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let V=(E&1)===0?"02":"03",z=u.fromHex(V+h(K)),$=a(K),q=s(-_*$),Z=s(p*$),Y=u.BASE.multiplyAndAddUnsafe(z,q,Z);if(!Y)throw new Error("point at infinify");return Y.assertValidity(),Y}hasHighS(){return T(this.s)}normalizeS(){return this.hasHighS()?new l(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return Ee(this.toDERHex())}toDERHex(){return Jt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ee(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}let S={isValidPrivateKey(B){try{return d(B),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{let B=Vn(t.n);return Ui(t.randomBytes(B),t.n)},precompute(B=8,A=u.BASE){return A._setWindowSize(B),A.multiply(BigInt(3)),A}};function I(B,A=!0){return u.fromPrivateKey(B).toRawBytes(A)}function x(B){let A=ae(B),y=typeof B=="string",p=(A||y)&&B.length;return A?p===o||p===i:y?p===2*o||p===2*i:B instanceof u}function L(B,A,y=!0){if(x(B))throw new Error("first arg must be private key");if(!x(A))throw new Error("second arg must be public key");return u.fromHex(A).multiply(d(B)).toRawBytes(y)}let F=t.bits2int||function(B){if(B.length>8192)throw new Error("input is too large");let A=Wt(B),y=B.length*8-t.nBitLength;return y>0?A>>BigInt(y):A},D=t.bits2int_modN||function(B){return s(F(B))},N=sr(t.nBitLength);function b(B){return bt("num < 2^"+t.nBitLength,B,Qt,N),ue(B,t.nByteLength)}function w(B,A,y=O){if(["recovered","canonical"].some(nt=>nt in y))throw new Error("sign() legacy options not supported");let{hash:p,randomBytes:E}=t,{lowS:_,prehash:K,extraEntropy:V}=y;_==null&&(_=!0),B=Q("msgHash",B),Es(y),K&&(B=Q("prehashed msgHash",p(B)));let z=D(B),$=d(A),q=[b($),b(z)];if(V!=null&&V!==!1){let nt=V===!0?E(r.BYTES):V;q.push(Q("extraEntropy",nt))}let Z=Yt(...q),Y=z;function rt(nt){let at=F(nt);if(!f(at))return;let ft=a(at),gt=u.BASE.multiply(at).toAffine(),dt=s(gt.x);if(dt===Qt)return;let Pt=s(ft*s(Y+dt*$));if(Pt===Qt)return;let zt=(gt.x===dt?0:2)|Number(gt.y&it),Qe=Pt;return _&&T(Pt)&&(Qe=v(Pt),zt^=1),new l(dt,Qe,zt)}return{seed:Z,k2sig:rt}}let O={lowS:t.lowS,prehash:!1},R={lowS:t.lowS,prehash:!1};function U(B,A,y=O){let{seed:p,k2sig:E}=w(B,A,y),_=t;return Dn(_.hash.outputLen,_.nByteLength,_.hmac)(p,E)}u.BASE._setWindowSize(8);function P(B,A,y,p=R){let E=B;A=Q("msgHash",A),y=Q("publicKey",y);let{lowS:_,prehash:K,format:V}=p;if(Es(p),"strict"in p)throw new Error("options.strict was renamed to lowS");if(V!==void 0&&V!=="compact"&&V!=="der")throw new Error("format must be compact or der");let z=typeof E=="string"||ae(E),$=!z&&!V&&typeof E=="object"&&E!==null&&typeof E.r=="bigint"&&typeof E.s=="bigint";if(!z&&!$)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let q,Z;try{if($&&(q=new l(E.r,E.s)),z){try{V!=="compact"&&(q=l.fromDER(E))}catch(zt){if(!(zt instanceof Jt.Err))throw zt}!q&&V!=="der"&&(q=l.fromCompact(E))}Z=u.fromHex(y)}catch{return!1}if(!q||_&&q.hasHighS())return!1;K&&(A=t.hash(A));let{r:Y,s:rt}=q,nt=D(A),at=a(rt),ft=s(nt*at),gt=s(Y*at),dt=u.BASE.multiplyAndAddUnsafe(Z,ft,gt)?.toAffine();return dt?s(dt.x)===Y:!1}return{CURVE:t,getPublicKey:I,getSharedSecret:L,sign:U,verify:P,ProjectivePoint:u,Signature:l,utils:S}}function el(e){return{hash:e,hmac:(t,...r)=>Io(e,t,In(...r)),randomBytes:_r}}function As(e,t){let r=n=>Bs({...e,...el(n)});return{...r(t),create:r}}var Cs=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),vs=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),rl=BigInt(1),_o=BigInt(2),Ts=(e,t)=>(e+t/_o)/t;function nl(e){let t=Cs,r=BigInt(3),n=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),u=BigInt(88),d=e*e*e%t,c=d*d*e%t,f=J(c,r,t)*c%t,h=J(f,r,t)*c%t,T=J(h,_o,t)*d%t,v=J(T,o,t)*T%t,g=J(v,i,t)*v%t,l=J(g,a,t)*g%t,S=J(l,u,t)*l%t,I=J(S,a,t)*g%t,x=J(I,r,t)*c%t,L=J(x,s,t)*v%t,F=J(L,n,t)*d%t,D=J(F,_o,t);if(!Lo.eql(Lo.sqr(D),e))throw new Error("Cannot find square root");return D}var Lo=fe(Cs,void 0,void 0,{sqrt:nl}),Ce=As({a:BigInt(0),b:BigInt(7),Fp:Lo,n:vs,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=vs,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-rl*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,s=BigInt("0x100000000000000000000000000000000"),a=Ts(i*e,t),u=Ts(-n*e,t),d=W(e-a*r-u*o,t),c=W(-a*n-u*i,t),f=d>s,h=c>s;if(f&&(d=t-d),h&&(c=t-c),d>s||c>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:d,k2neg:h,k2:c}}}},$e),kp=BigInt(0);var Dp=Ce.ProjectivePoint;function Is(e){return e==null?!1:typeof e.then=="function"&&typeof e.catch=="function"&&typeof e.finally=="function"}function Us(e,t,r){let n=ao.digest(r instanceof Uint8Array?r:r.subarray());if(Is(n))return n.then(({digest:o})=>Ce.verify(t,o,e)).catch(o=>{throw new hr(String(o))});try{return Ce.verify(t,n.digest,e)}catch(o){throw new hr(String(o))}}var Xr=class{type="secp256k1";raw;_key;constructor(t){this._key=Ls(t),this.raw=_s(this._key)}toMultihash(){return nr.digest(Me(this))}toCID(){return pt.createV1(114,this.toMultihash())}toString(){return ot.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:Ut(this.raw,t.raw)}verify(t,r){return Us(this._key,r,t)}};function Ns(e){return new Xr(e)}function _s(e){return Ce.ProjectivePoint.fromHex(e).toRawBytes(!0)}function Ls(e){try{return Ce.ProjectivePoint.fromHex(e),e}catch(t){throw new Ue(String(t))}}function Rs(e,t){let{Type:r,Data:n}=Xt.decode(e),o=n??new Uint8Array;switch(r){case ct.RSA:return Co(o,t);case ct.Ed25519:return Vi(o);case ct.secp256k1:return Ns(o);default:throw new vr}}function Me(e){return Xt.encode({Type:ct[e.type],Data:e.raw})}function ol(e,t){try{if(typeof e=="string"&&e.length>0)return il(e);if(typeof e=="number"&&isFinite(e))return t?.long?al(e):sl(e);throw new Error("Value is not a string or number.")}catch(r){let n=cl(r)?`${r.message}. value=${JSON.stringify(e)}`:"An unknown error has occured.";throw new Error(n)}}function il(e){if(e=String(e),e.length>100)throw new Error("Value exceeds the maximum length of 100 characters.");let t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return NaN;let r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*315576e5;case"weeks":case"week":case"w":return r*6048e5;case"days":case"day":case"d":return r*864e5;case"hours":case"hour":case"hrs":case"hr":case"h":return r*36e5;case"minutes":case"minute":case"mins":case"min":case"m":return r*6e4;case"seconds":case"second":case"secs":case"sec":case"s":return r*1e3;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:throw new Error(`The unit ${n} was matched, but no matching case exists.`)}}var Qr=ol;function sl(e){let t=Math.abs(e);return t>=864e5?`${Math.round(e/864e5)}d`:t>=36e5?`${Math.round(e/36e5)}h`:t>=6e4?`${Math.round(e/6e4)}m`:t>=1e3?`${Math.round(e/1e3)}s`:`${e}ms`}function al(e){let t=Math.abs(e);return t>=864e5?Jr(e,t,864e5,"day"):t>=36e5?Jr(e,t,36e5,"hour"):t>=6e4?Jr(e,t,6e4,"minute"):t>=1e3?Jr(e,t,1e3,"second"):`${e} ms`}function Jr(e,t,r,n){let o=t>=r*1.5;return`${Math.round(e/r)} ${n}${o?"s":""}`}function cl(e){return typeof e=="object"&&e!==null&&"message"in e}function No(e){r.debug=r,r.default=r,r.coerce=u,r.disable=i,r.enable=o,r.enabled=s,r.humanize=Qr,r.destroy=d,Object.keys(e).forEach(c=>{r[c]=e[c]}),r.names=[],r.skips=[],r.formatters={};function t(c){let f=0;for(let h=0;h<c.length;h++)f=(f<<5)-f+c.charCodeAt(h),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=t;function r(c){let f,h=null,T,v;function g(...l){if(!g.enabled)return;let S=g,I=Number(new Date),x=I-(f||I);S.diff=x,S.prev=f,S.curr=I,f=I,l[0]=r.coerce(l[0]),typeof l[0]!="string"&&l.unshift("%O");let L=0;l[0]=l[0].replace(/%([a-zA-Z%])/g,(D,N)=>{if(D==="%%")return"%";L++;let b=r.formatters[N];if(typeof b=="function"){let w=l[L];D=b.call(S,w),l.splice(L,1),L--}return D}),r.formatArgs.call(S,l),(S.log||r.log).apply(S,l)}return g.namespace=c,g.useColors=r.useColors(),g.color=r.selectColor(c),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(T!==r.namespaces&&(T=r.namespaces,v=r.enabled(c)),v),set:l=>{h=l}}),typeof r.init=="function"&&r.init(g),g}function n(c,f){let h=r(this.namespace+(typeof f>"u"?":":f)+c);return h.log=this.log,h}function o(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let f,h=(typeof c=="string"?c:"").split(/[\s,]+/),T=h.length;for(f=0;f<T;f++)h[f]&&(c=h[f].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.substr(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),c}function s(c){if(c[c.length-1]==="*")return!0;let f,h;for(f=0,h=r.skips.length;f<h;f++)if(r.skips[f].test(c))return!1;for(f=0,h=r.names.length;f<h;f++)if(r.names[f].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function u(c){return c instanceof Error?c.stack??c.message:c}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.setupFormatters(r.formatters),r.enable(r.load()),r}var tn=ml(),ul=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function fl(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/(edge|trident)\/(\d+)/)!=null?!1:typeof document<"u"&&document.documentElement?.style?.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/firefox\/(\d+)/)!=null&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/applewebkit\/(\d+)/)}function ll(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Qr(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),e.splice(n,0,t)}var dl=console.debug??console.log??(()=>{});function hl(e){try{e?tn?.setItem("debug",e):tn?.removeItem("debug")}catch{}}function pl(){let e;try{e=tn?.getItem("debug")}catch{}return!e&&typeof globalThis.process<"u"&&"env"in globalThis.process&&(e=globalThis.process.env.DEBUG),e}function ml(){try{return localStorage}catch{}}function yl(e){e.j=function(t){try{return JSON.stringify(t)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}}var ks=No({formatArgs:ll,save:hl,load:pl,useColors:fl,setupFormatters:yl,colors:ul,storage:tn,log:dl});var Et=ks;Et.formatters.b=e=>e==null?"undefined":ot.baseEncode(e);Et.formatters.t=e=>e==null?"undefined":ne.baseEncode(e);Et.formatters.m=e=>e==null?"undefined":eo.baseEncode(e);Et.formatters.p=e=>e==null?"undefined":e.toString();Et.formatters.c=e=>e==null?"undefined":e.toString();Et.formatters.k=e=>e==null?"undefined":e.toString();Et.formatters.a=e=>e==null?"undefined":e.toString();Et.formatters.e=e=>e==null?"undefined":Ds(e.stack)??Ds(e.message)??e.toString();function gl(e){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function en(e){let t=gl(`${e}:trace`);return Et.enabled(`${e}:trace`)&&Et.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=Et(`${e}:trace`)),Object.assign(Et(e),{error:Et(`${e}:error`),trace:t})}function Ds(e){if(e!=null&&(e=e.trim(),e.length!==0))return e}var xl="/",bl=new TextEncoder().encode(xl),km=bl[0];var Ho=yc(Fs(),1);var rn=class extends Error{static name="SignatureCreationError";constructor(t="Record signature creation failed"){super(t),this.name="SignatureCreationError"}},te=class extends Error{static name="SignatureVerificationError";constructor(t="Record signature verification failed"){super(t),this.name="SignatureVerificationError"}};var yr=class extends Error{static name="UnsupportedValidityError";constructor(t="The validity type is unsupported"){super(t),this.name="UnsupportedValidityError"}};var gr=class extends Error{static name="InvalidValueError";constructor(t="Value must be a valid content path starting with /"){super(t),this.name="InvalidValueError"}},nn=class extends Error{static name="InvalidRecordDataError";constructor(t="Invalid record data"){super(t),this.name="InvalidRecordDataError"}};var At;(function(e){let t;(function(o){o.EOL="EOL"})(t=e.ValidityType||(e.ValidityType={}));let r;(function(o){o[o.EOL=0]="EOL"})(r||(r={})),function(o){o.codec=()=>lr(r)}(t=e.ValidityType||(e.ValidityType={}));let n;e.codec=()=>(n==null&&(n=ze((o,i,s={})=>{s.lengthDelimited!==!1&&i.fork(),o.value!=null&&(i.uint32(10),i.bytes(o.value)),o.signatureV1!=null&&(i.uint32(18),i.bytes(o.signatureV1)),o.validityType!=null&&(i.uint32(24),e.ValidityType.codec().encode(o.validityType,i)),o.validity!=null&&(i.uint32(34),i.bytes(o.validity)),o.sequence!=null&&(i.uint32(40),i.uint64(o.sequence)),o.ttl!=null&&(i.uint32(48),i.uint64(o.ttl)),o.pubKey!=null&&(i.uint32(58),i.bytes(o.pubKey)),o.signatureV2!=null&&(i.uint32(66),i.bytes(o.signatureV2)),o.data!=null&&(i.uint32(74),i.bytes(o.data)),s.lengthDelimited!==!1&&i.ldelim()},(o,i,s={})=>{let a={},u=i==null?o.len:o.pos+i;for(;o.pos<u;){let d=o.uint32();switch(d>>>3){case 1:{a.value=o.bytes();break}case 2:{a.signatureV1=o.bytes();break}case 3:{a.validityType=e.ValidityType.codec().decode(o);break}case 4:{a.validity=o.bytes();break}case 5:{a.sequence=o.uint64();break}case 6:{a.ttl=o.uint64();break}case 7:{a.pubKey=o.bytes();break}case 8:{a.signatureV2=o.bytes();break}case 9:{a.data=o.bytes();break}default:{o.skipType(d&7);break}}}return a})),n),e.encode=o=>qe(o,e.codec()),e.decode=(o,i)=>Pe(o,e.codec(),i)})(At||(At={}));var wl=["string","number","bigint","symbol"],El=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Os(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;if(wl.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(Sl(e))return"Buffer";let r=Bl(e);return r||"Object"}function Sl(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Bl(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(El.includes(t))return t}var m=class{constructor(t,r,n){this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}};m.uint=new m(0,"uint",!0);m.negint=new m(1,"negint",!0);m.bytes=new m(2,"bytes",!0);m.string=new m(3,"string",!0);m.array=new m(4,"array",!1);m.map=new m(5,"map",!1);m.tag=new m(6,"tag",!1);m.float=new m(7,"float",!0);m.false=new m(7,"false",!0);m.true=new m(7,"true",!0);m.null=new m(7,"null",!0);m.undefined=new m(7,"undefined",!0);m.break=new m(7,"break",!0);var k=class{constructor(t,r,n){this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var Ze=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Al=new TextDecoder,vl=new TextEncoder;function on(e){return Ze&&globalThis.Buffer.isBuffer(e)}function ko(e){return e instanceof Uint8Array?on(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var Ps=Ze?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):Vs(e,t,r):(e,t,r)=>r-t>64?Al.decode(e.subarray(t,r)):Vs(e,t,r),qs=Ze?e=>e.length>64?globalThis.Buffer.from(e):Ks(e):e=>e.length>64?vl.encode(e):Ks(e),Ht=e=>Uint8Array.from(e),We=Ze?(e,t,r)=>on(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),Hs=Ze?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),ko(globalThis.Buffer.concat(e,t))):(e,t)=>{let r=new Uint8Array(t),n=0;for(let o of e)n+o.length>r.length&&(o=o.subarray(0,r.length-n)),r.set(o,n),n+=o.length;return r},zs=Ze?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function $s(e,t){if(on(e)&&on(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function Ks(e){let t=[],r=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128)}return t}function Vs(e,t,r){let n=[];for(;t<r;){let o=e[t],i=null,s=o>239?4:o>223?3:o>191?2:1;if(t+s<=r){let a,u,d,c;switch(s){case 1:o<128&&(i=o);break;case 2:a=e[t+1],(a&192)===128&&(c=(o&31)<<6|a&63,c>127&&(i=c));break;case 3:a=e[t+1],u=e[t+2],(a&192)===128&&(u&192)===128&&(c=(o&15)<<12|(a&63)<<6|u&63,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:a=e[t+1],u=e[t+2],d=e[t+3],(a&192)===128&&(u&192)===128&&(d&192)===128&&(c=(o&15)<<18|(a&63)<<12|(u&63)<<6|d&63,c>65535&&c<1114112&&(i=c))}}i===null?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|i&1023),n.push(i),t+=s}return Tl(n)}var Ms=4096;function Tl(e){let t=e.length;if(t<=Ms)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Ms));return r}var Cl=256,xr=class{constructor(t=Cl){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let r=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){let o=r.length-(this.maxCursor-this.cursor)-1;r.set(t,o)}else{if(r){let o=r.length-(this.maxCursor-this.cursor)-1;o<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(r=zs(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];t&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=We(n,0,this.cursor)}else r=Hs(this.chunks,this.cursor);return t&&this.reset(),r}};var M="CBOR decode error:",Do="CBOR encode error:",br=[];br[23]=1;br[24]=2;br[25]=3;br[26]=5;br[27]=9;function ee(e,t,r){if(e.length-t<r)throw new Error(`${M} not enough data for type`)}var st=[24,256,65536,4294967296,BigInt("18446744073709551616")];function vt(e,t,r){ee(e,t,1);let n=e[t];if(r.strict===!0&&n<st[0])throw new Error(`${M} integer encoded in more bytes than necessary (strict decode)`);return n}function Tt(e,t,r){ee(e,t,2);let n=e[t]<<8|e[t+1];if(r.strict===!0&&n<st[1])throw new Error(`${M} integer encoded in more bytes than necessary (strict decode)`);return n}function Ct(e,t,r){ee(e,t,4);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<st[2])throw new Error(`${M} integer encoded in more bytes than necessary (strict decode)`);return n}function It(e,t,r){ee(e,t,8);let n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(r.strict===!0&&i<st[3])throw new Error(`${M} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(r.allowBigInt===!0)return i;throw new Error(`${M} integers outside of the safe integer range are not supported`)}function Gs(e,t,r,n){return new k(m.uint,vt(e,t+1,n),2)}function Zs(e,t,r,n){return new k(m.uint,Tt(e,t+1,n),3)}function Ws(e,t,r,n){return new k(m.uint,Ct(e,t+1,n),5)}function Ys(e,t,r,n){return new k(m.uint,It(e,t+1,n),9)}function Lt(e,t){return ut(e,0,t.value)}function ut(e,t,r){if(r<st[0]){let n=Number(r);e.push([t|n])}else if(r<st[1]){let n=Number(r);e.push([t|24,n])}else if(r<st[2]){let n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<st[3]){let n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<st[4]){let o=[t|27,0,0,0,0,0,0,0],i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=s&255,s=s>>8,o[3]=s&255,s=s>>8,o[2]=s&255,s=s>>8,o[1]=s&255,e.push(o)}else throw new Error(`${M} encountered BigInt larger than allowable range`)}}Lt.encodedSize=function(t){return ut.encodedSize(t.value)};ut.encodedSize=function(t){return t<st[0]?1:t<st[1]?2:t<st[2]?3:t<st[3]?5:9};Lt.compareTokens=function(t,r){return t.value<r.value?-1:t.value>r.value?1:0};function js(e,t,r,n){return new k(m.negint,-1-vt(e,t+1,n),2)}function Xs(e,t,r,n){return new k(m.negint,-1-Tt(e,t+1,n),3)}function Js(e,t,r,n){return new k(m.negint,-1-Ct(e,t+1,n),5)}var Fo=BigInt(-1),Qs=BigInt(1);function ta(e,t,r,n){let o=It(e,t+1,n);if(typeof o!="bigint"){let i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new k(m.negint,i,9)}if(n.allowBigInt!==!0)throw new Error(`${M} integers outside of the safe integer range are not supported`);return new k(m.negint,Fo-BigInt(o),9)}function sn(e,t){let r=t.value,n=typeof r=="bigint"?r*Fo-Qs:r*-1-1;ut(e,t.type.majorEncoded,n)}sn.encodedSize=function(t){let r=t.value,n=typeof r=="bigint"?r*Fo-Qs:r*-1-1;return n<st[0]?1:n<st[1]?2:n<st[2]?3:n<st[3]?5:9};sn.compareTokens=function(t,r){return t.value<r.value?1:t.value>r.value?-1:0};function wr(e,t,r,n){ee(e,t,r+n);let o=We(e,t+r,t+r+n);return new k(m.bytes,o,r+n)}function ea(e,t,r,n){return wr(e,t,1,r)}function ra(e,t,r,n){return wr(e,t,2,vt(e,t+1,n))}function na(e,t,r,n){return wr(e,t,3,Tt(e,t+1,n))}function oa(e,t,r,n){return wr(e,t,5,Ct(e,t+1,n))}function ia(e,t,r,n){let o=It(e,t+1,n);if(typeof o=="bigint")throw new Error(`${M} 64-bit integer bytes lengths not supported`);return wr(e,t,9,o)}function an(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===m.string?qs(e.value):e.value),e.encodedBytes}function Ye(e,t){let r=an(t);ut(e,t.type.majorEncoded,r.length),e.push(r)}Ye.encodedSize=function(t){let r=an(t);return ut.encodedSize(r.length)+r.length};Ye.compareTokens=function(t,r){return Ul(an(t),an(r))};function Ul(e,t){return e.length<t.length?-1:e.length>t.length?1:$s(e,t)}function Er(e,t,r,n,o){let i=r+n;ee(e,t,i);let s=new k(m.string,Ps(e,t+r,t+i),i);return o.retainStringBytes===!0&&(s.byteValue=We(e,t+r,t+i)),s}function sa(e,t,r,n){return Er(e,t,1,r,n)}function aa(e,t,r,n){return Er(e,t,2,vt(e,t+1,n),n)}function ca(e,t,r,n){return Er(e,t,3,Tt(e,t+1,n),n)}function ua(e,t,r,n){return Er(e,t,5,Ct(e,t+1,n),n)}function fa(e,t,r,n){let o=It(e,t+1,n);if(typeof o=="bigint")throw new Error(`${M} 64-bit integer string lengths not supported`);return Er(e,t,9,o,n)}var la=Ye;function je(e,t,r,n){return new k(m.array,n,r)}function da(e,t,r,n){return je(e,t,1,r)}function ha(e,t,r,n){return je(e,t,2,vt(e,t+1,n))}function pa(e,t,r,n){return je(e,t,3,Tt(e,t+1,n))}function ma(e,t,r,n){return je(e,t,5,Ct(e,t+1,n))}function ya(e,t,r,n){let o=It(e,t+1,n);if(typeof o=="bigint")throw new Error(`${M} 64-bit integer array lengths not supported`);return je(e,t,9,o)}function ga(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${M} indefinite length items not allowed`);return je(e,t,1,1/0)}function cn(e,t){ut(e,m.array.majorEncoded,t.value)}cn.compareTokens=Lt.compareTokens;cn.encodedSize=function(t){return ut.encodedSize(t.value)};function Xe(e,t,r,n){return new k(m.map,n,r)}function xa(e,t,r,n){return Xe(e,t,1,r)}function ba(e,t,r,n){return Xe(e,t,2,vt(e,t+1,n))}function wa(e,t,r,n){return Xe(e,t,3,Tt(e,t+1,n))}function Ea(e,t,r,n){return Xe(e,t,5,Ct(e,t+1,n))}function Sa(e,t,r,n){let o=It(e,t+1,n);if(typeof o=="bigint")throw new Error(`${M} 64-bit integer map lengths not supported`);return Xe(e,t,9,o)}function Ba(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${M} indefinite length items not allowed`);return Xe(e,t,1,1/0)}function un(e,t){ut(e,m.map.majorEncoded,t.value)}un.compareTokens=Lt.compareTokens;un.encodedSize=function(t){return ut.encodedSize(t.value)};function Aa(e,t,r,n){return new k(m.tag,r,1)}function va(e,t,r,n){return new k(m.tag,vt(e,t+1,n),2)}function Ta(e,t,r,n){return new k(m.tag,Tt(e,t+1,n),3)}function Ca(e,t,r,n){return new k(m.tag,Ct(e,t+1,n),5)}function Ia(e,t,r,n){return new k(m.tag,It(e,t+1,n),9)}function fn(e,t){ut(e,m.tag.majorEncoded,t.value)}fn.compareTokens=Lt.compareTokens;fn.encodedSize=function(t){return ut.encodedSize(t.value)};var Dl=20,Fl=21,Ol=22,Kl=23;function Ua(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${M} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new k(m.null,null,1):new k(m.undefined,void 0,1)}function _a(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${M} indefinite length items not allowed`);return new k(m.break,void 0,1)}function Oo(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${M} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${M} Infinity values are not supported`)}return new k(m.float,e,t)}function La(e,t,r,n){return Oo(Ko(e,t+1),3,n)}function Na(e,t,r,n){return Oo(Vo(e,t+1),5,n)}function Ra(e,t,r,n){return Oo(Oa(e,t+1),9,n)}function ln(e,t,r){let n=t.value;if(n===!1)e.push([m.float.majorEncoded|Dl]);else if(n===!0)e.push([m.float.majorEncoded|Fl]);else if(n===null)e.push([m.float.majorEncoded|Ol]);else if(n===void 0)e.push([m.float.majorEncoded|Kl]);else{let o,i=!1;(!r||r.float64!==!0)&&(Da(n),o=Ko(Vt,1),n===o||Number.isNaN(n)?(Vt[0]=249,e.push(Vt.slice(0,3)),i=!0):(Fa(n),o=Vo(Vt,1),n===o&&(Vt[0]=250,e.push(Vt.slice(0,5)),i=!0))),i||(Vl(n),o=Oa(Vt,1),Vt[0]=251,e.push(Vt.slice(0,9)))}}ln.encodedSize=function(t,r){let n=t.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){Da(n);let o=Ko(Vt,1);if(n===o||Number.isNaN(n))return 3;if(Fa(n),o=Vo(Vt,1),n===o)return 5}return 9};var ka=new ArrayBuffer(9),Nt=new DataView(ka,1),Vt=new Uint8Array(ka,0);function Da(e){if(e===1/0)Nt.setUint16(0,31744,!1);else if(e===-1/0)Nt.setUint16(0,64512,!1);else if(Number.isNaN(e))Nt.setUint16(0,32256,!1);else{Nt.setFloat32(0,e);let t=Nt.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)Nt.setUint16(0,31744,!1);else if(r===0)Nt.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let o=r-127;o<-24?Nt.setUint16(0,0):o<-14?Nt.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):Nt.setUint16(0,(t&2147483648)>>16|o+15<<10|n>>13,!1)}}}function Ko(e,t){if(e.length-t<2)throw new Error(`${M} not enough data for float16`);let r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,o=r&1023,i;return n===0?i=o*2**-24:n!==31?i=(o+1024)*2**(n-25):i=o===0?1/0:NaN,r&32768?-i:i}function Fa(e){Nt.setFloat32(0,e,!1)}function Vo(e,t){if(e.length-t<4)throw new Error(`${M} not enough data for float32`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function Vl(e){Nt.setFloat64(0,e,!1)}function Oa(e,t){if(e.length-t<8)throw new Error(`${M} not enough data for float64`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}ln.compareTokens=Lt.compareTokens;function G(e,t,r){throw new Error(`${M} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function dn(e){return()=>{throw new Error(`${M} ${e}`)}}var C=[];for(let e=0;e<=23;e++)C[e]=G;C[24]=Gs;C[25]=Zs;C[26]=Ws;C[27]=Ys;C[28]=G;C[29]=G;C[30]=G;C[31]=G;for(let e=32;e<=55;e++)C[e]=G;C[56]=js;C[57]=Xs;C[58]=Js;C[59]=ta;C[60]=G;C[61]=G;C[62]=G;C[63]=G;for(let e=64;e<=87;e++)C[e]=ea;C[88]=ra;C[89]=na;C[90]=oa;C[91]=ia;C[92]=G;C[93]=G;C[94]=G;C[95]=dn("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)C[e]=sa;C[120]=aa;C[121]=ca;C[122]=ua;C[123]=fa;C[124]=G;C[125]=G;C[126]=G;C[127]=dn("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)C[e]=da;C[152]=ha;C[153]=pa;C[154]=ma;C[155]=ya;C[156]=G;C[157]=G;C[158]=G;C[159]=ga;for(let e=160;e<=183;e++)C[e]=xa;C[184]=ba;C[185]=wa;C[186]=Ea;C[187]=Sa;C[188]=G;C[189]=G;C[190]=G;C[191]=Ba;for(let e=192;e<=215;e++)C[e]=Aa;C[216]=va;C[217]=Ta;C[218]=Ca;C[219]=Ia;C[220]=G;C[221]=G;C[222]=G;C[223]=G;for(let e=224;e<=243;e++)C[e]=dn("simple values are not supported");C[244]=G;C[245]=G;C[246]=G;C[247]=Ua;C[248]=dn("simple values are not supported");C[249]=La;C[250]=Na;C[251]=Ra;C[252]=G;C[253]=G;C[254]=G;C[255]=_a;var Mt=[];for(let e=0;e<24;e++)Mt[e]=new k(m.uint,e,1);for(let e=-1;e>=-24;e--)Mt[31-e]=new k(m.negint,e,1);Mt[64]=new k(m.bytes,new Uint8Array(0),1);Mt[96]=new k(m.string,"",1);Mt[128]=new k(m.array,0,1);Mt[160]=new k(m.map,0,1);Mt[244]=new k(m.false,!1,1);Mt[245]=new k(m.true,!0,1);Mt[246]=new k(m.null,null,1);function Ka(e){switch(e.type){case m.false:return Ht([244]);case m.true:return Ht([245]);case m.null:return Ht([246]);case m.bytes:return e.value.length?void 0:Ht([64]);case m.string:return e.value===""?Ht([96]):void 0;case m.array:return e.value===0?Ht([128]):void 0;case m.map:return e.value===0?Ht([160]):void 0;case m.uint:return e.value<24?Ht([Number(e.value)]):void 0;case m.negint:if(e.value>=-24)return Ht([31-Number(e.value)])}}var Pl={float64:!1,mapSorter:zl,quickEncodeToken:Ka};function ql(){let e=[];return e[m.uint.major]=Lt,e[m.negint.major]=sn,e[m.bytes.major]=Ye,e[m.string.major]=la,e[m.array.major]=cn,e[m.map.major]=un,e[m.tag.major]=fn,e[m.float.major]=ln,e}var Va=ql(),Mo=new xr,pn=class e{constructor(t,r){this.obj=t,this.parent=r}includes(t){let r=this;do if(r.obj===t)return!0;while(r=r.parent);return!1}static createCheck(t,r){if(t&&t.includes(r))throw new Error(`${Do} object contains circular references`);return new e(r,t)}},ge={null:new k(m.null,null),undefined:new k(m.undefined,void 0),true:new k(m.true,!0),false:new k(m.false,!1),emptyArray:new k(m.array,0),emptyMap:new k(m.map,0)},xe={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new k(m.float,e):e>=0?new k(m.uint,e):new k(m.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new k(m.uint,e):new k(m.negint,e)},Uint8Array(e,t,r,n){return new k(m.bytes,e)},string(e,t,r,n){return new k(m.string,e)},boolean(e,t,r,n){return e?ge.true:ge.false},null(e,t,r,n){return ge.null},undefined(e,t,r,n){return ge.undefined},ArrayBuffer(e,t,r,n){return new k(m.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new k(m.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[ge.emptyArray,new k(m.break)]:ge.emptyArray;n=pn.createCheck(n,e);let o=[],i=0;for(let s of e)o[i++]=hn(s,r,n);return r.addBreakTokens?[new k(m.array,e.length),o,new k(m.break)]:[new k(m.array,e.length),o]},Object(e,t,r,n){let o=t!=="Object",i=o?e.keys():Object.keys(e),s=o?e.size:i.length;if(!s)return r.addBreakTokens===!0?[ge.emptyMap,new k(m.break)]:ge.emptyMap;n=pn.createCheck(n,e);let a=[],u=0;for(let d of i)a[u++]=[hn(d,r,n),hn(o?e.get(d):e[d],r,n)];return Hl(a,r),r.addBreakTokens?[new k(m.map,s),a,new k(m.break)]:[new k(m.map,s),a]}};xe.Map=xe.Object;xe.Buffer=xe.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))xe[`${e}Array`]=xe.DataView;function hn(e,t={},r){let n=Os(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||xe[n];if(typeof o=="function"){let s=o(e,n,t,r);if(s!=null)return s}let i=xe[n];if(!i)throw new Error(`${Do} unsupported type: ${n}`);return i(e,n,t,r)}function Hl(e,t){t.mapSorter&&e.sort(t.mapSorter)}function zl(e,t){let r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);let o=r.type.major,i=Va[o].compareTokens(r,n);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function Ma(e,t,r,n){if(Array.isArray(t))for(let o of t)Ma(e,o,r,n);else r[t.type.major](e,t,n)}function $l(e,t,r){let n=hn(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){let o=r.quickEncodeToken(n);if(o)return o;let i=t[n.type.major];if(i.encodedSize){let s=i.encodedSize(n,r),a=new xr(s);if(i(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return ko(a.chunks[0])}}return Mo.reset(),Ma(Mo,n,t,r),Mo.toBytes(!0)}function Po(e,t){return t=Object.assign({},Pl,t),$l(e,Va,t)}var Gl={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},mn=class{constructor(t,r={}){this._pos=0,this.data=t,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){let t=this.data[this._pos],r=Mt[t];if(r===void 0){let n=C[t];if(!n)throw new Error(`${M} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);let o=t&31;r=n(this.data,this._pos,o,this.options)}return this._pos+=r.encodedLength,r}},Sr=Symbol.for("DONE"),yn=Symbol.for("BREAK");function Zl(e,t,r){let n=[];for(let o=0;o<e.value;o++){let i=Je(t,r);if(i===yn){if(e.value===1/0)break;throw new Error(`${M} got unexpected break to lengthed array`)}if(i===Sr)throw new Error(`${M} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=i}return n}function Wl(e,t,r){let n=r.useMaps===!0,o=n?void 0:{},i=n?new Map:void 0;for(let s=0;s<e.value;s++){let a=Je(t,r);if(a===yn){if(e.value===1/0)break;throw new Error(`${M} got unexpected break to lengthed map`)}if(a===Sr)throw new Error(`${M} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${M} non-string keys not supported (got ${typeof a})`);if(r.rejectDuplicateMapKeys===!0&&(n&&i.has(a)||!n&&a in o))throw new Error(`${M} found repeat map key "${a}"`);let u=Je(t,r);if(u===Sr)throw new Error(`${M} found map but not enough entries (got ${s} [no value], expected ${e.value})`);n?i.set(a,u):o[a]=u}return n?i:o}function Je(e,t){if(e.done())return Sr;let r=e.next();if(r.type===m.break)return yn;if(r.type.terminal)return r.value;if(r.type===m.array)return Zl(r,e,t);if(r.type===m.map)return Wl(r,e,t);if(r.type===m.tag){if(t.tags&&typeof t.tags[r.value]=="function"){let n=Je(e,t);return t.tags[r.value](n)}throw new Error(`${M} tag not supported (${r.value})`)}throw new Error("unsupported")}function Pa(e,t){if(!(e instanceof Uint8Array))throw new Error(`${M} data to decode must be a Uint8Array`);t=Object.assign({},Gl,t);let r=t.tokenizer||new mn(e,t),n=Je(r,t);if(n===Sr)throw new Error(`${M} did not find any content to decode`);if(n===yn)throw new Error(`${M} got unexpected break`);return[n,e.subarray(r.pos())]}function qo(e,t){let[r,n]=Pa(e,t);if(n.length>0)throw new Error(`${M} too many terminals, data makes no sense`);return r}var jl=en("ipns:utils"),Ha=j("/ipns/"),Xl=114,Jl=0,Ql=18;function za(e){let t;if(e.pubKey!=null)try{t=Rs(e.pubKey)}catch(r){throw jl.error(r),r}if(t!=null)return t}function $a(e,t,r){let n=j(t);return me([e,r,n])}function Ga(e){let t=j("ipns-signature:");return me([t,e])}function Za(e){return"signatureV1"in e?At.encode({value:j(e.value),signatureV1:e.signatureV1,validityType:e.validityType,validity:j(e.validity),sequence:e.sequence,ttl:e.ttl,pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data}):At.encode({pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data})}function Wa(e){let t=At.decode(e);if(t.sequence!=null&&(t.sequence=BigInt(t.sequence)),t.ttl!=null&&(t.ttl=BigInt(t.ttl)),t.signatureV2==null||t.data==null)throw new te("Missing data or signatureV2");let r=Ja(t.data),n=td(r.Value),o=yt(r.Validity);if(t.value!=null&&t.signatureV1!=null)return ed(t),{value:n,validityType:At.ValidityType.EOL,validity:o,sequence:r.Sequence,ttl:r.TTL,pubKey:t.pubKey,signatureV1:t.signatureV1,signatureV2:t.signatureV2,data:t.data};if(t.signatureV2!=null)return{value:n,validityType:At.ValidityType.EOL,validity:o,sequence:r.Sequence,ttl:r.TTL,pubKey:t.pubKey,signatureV2:t.signatureV2,data:t.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}function Ya(e){return me([Ha,e.bytes])}function ja(e){let t=Cr(e.slice(Ha.length));if(!qa(t,Jl)&&!qa(t,Ql))throw new Ar("Multihash in IPNS key was not identity or sha2-256");return t}function Xa(e,t,r,n,o){let i;if(t===At.ValidityType.EOL)i=0;else throw new yr("The validity type is unsupported");return Po({Value:e,Validity:r,ValidityType:i,Sequence:n,TTL:o})}function Ja(e){let t=qo(e);if(t.ValidityType===0)t.ValidityType=At.ValidityType.EOL;else throw new yr("The validity type is unsupported");return Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t}function td(e){let t=yt(e).trim();if(t.startsWith("/"))return t;try{return`/ipfs/${pt.decode(e).toV1().toString()}`}catch{}try{return`/ipfs/${pt.parse(t).toV1().toString()}`}catch{}throw new gr("Value must be a valid content path starting with /")}function Qa(e){if(e!=null){let t=od(e);if(t!=null)return t.code===Xl?`/ipns/${t.toString(oe)}`:`/ipfs/${t.toV1().toString()}`;if(rd(e))return`/ipns/${oe.encode(e.bytes)}`;let r=e.toString().trim();if(r.startsWith("/")&&r.length>1)return r}throw new gr("Value must be a valid content path starting with /")}function ed(e){if(e.data==null)throw new nn("Record data is missing");let t=Ja(e.data);if(!Ut(t.Value,e.value??new Uint8Array(0)))throw new te('Field "value" did not match between protobuf and CBOR');if(!Ut(t.Validity,e.validity??new Uint8Array(0)))throw new te('Field "validity" did not match between protobuf and CBOR');if(t.ValidityType!==e.validityType)throw new te('Field "validityType" did not match between protobuf and CBOR');if(t.Sequence!==e.sequence)throw new te('Field "sequence" did not match between protobuf and CBOR');if(t.TTL!==e.ttl)throw new te('Field "ttl" did not match between protobuf and CBOR')}function rd(e){return e.bytes instanceof Uint8Array}function nd(e){return typeof e?.toCID=="function"}function od(e){if(nd(e))return e.toCID();try{return pt.parse(e)}catch{}return pt.asCID(e)}function qa(e,t){return e.code===t}var id=en("ipns"),zo=5*60*1e9,tc="/ipns/",sd=tc.length,$o={v1Compatible:!0,ttlNs:zo};async function ad(e,t,r,n,o=$o){let i=new Ho.default(Date.now()+Number(n)),s=At.ValidityType.EOL,a=BigInt(o.ttlNs??zo);return ec(e,t,r,s,i.toString(),a,o)}async function cd(e,t,r,n,o=$o){let i=Ho.default.fromString(n),s=At.ValidityType.EOL,a=BigInt(o.ttlNs??zo);return ec(e,t,r,s,i.toString(),a,o)}var ec=async(e,t,r,n,o,i,s=$o)=>{r=BigInt(r);let a=j(o),u=Qa(t),d=j(u),c=Xa(d,n,a,r,i),f=Ga(c),h=await e.sign(f),T;if(e.type==="RSA"&&(T=Me(e.publicKey)),s.v1Compatible===!0){let v=await ud(e,d,n,a),g={value:u,signatureV1:v,validity:o,validityType:n,sequence:r,ttl:i,signatureV2:h,data:c};return T!=null&&(g.pubKey=T),g}else{let v={value:u,validity:o,validityType:n,sequence:r,ttl:i,signatureV2:h,data:c};return T!=null&&(v.pubKey=T),v}},ud=async(e,t,r,n)=>{try{let o=$a(t,r,n);return await e.sign(o)}catch(o){throw id.error("record signature creation failed",o),new rn("Record signature creation failed")}};return gc(fd);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Ipns}));
